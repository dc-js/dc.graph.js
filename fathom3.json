{"Physical Plan": {"1": {"label": "Physical Plan", "notes": "", "children": [2], "parent": [], "node_id": -1, "lineno": 4638, "full_label": "Physical Plan", "ancestors": [], "size": 613, "equiv": "0"}, "2": {"label": "AdaptiveSparkPlan", "notes": "", "children": [3], "parent": [1], "node_id": "(580) AdaptiveSparkPlan", "lineno": 4639, "detail": {"note": "AdaptiveSparkPlan", "lineno": 5461, "Output": " [150]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2197098, cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2197103, 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2197105, 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2197107, 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2197109, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2197110, cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2197112, 50th_timedelta_15m#2197113, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2197114, cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2197116, 50th_timedelta_60m#2197117, stddev_timedelta_60m#2194169, 5m_success_count#2197118, 5m_failed_count#2197119, 5m_suc_dist_usr#2197120, 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2197122, 15m_failed_count#2197123, 15m_suc_dist_usr#2197124, 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, 60m_success_count#2197126, 60m_failed_count#2197127, 60m_suc_dist_usr#2197128, 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, heavy_hitters_flag#2194662, day_of_week#2196709, dow#2196710, distance_DOW#2196711, isWkend_flag#2196712, long_start_time#2196713L, year#2196714, month#2196715, day#2196716, hour#2196717, minute#2196718, second#2196719, timeofday#2196720, timeofday_cos#2196721, ip_start_iploc#2174784, ip_end_iploc#2174785, country_name_iploc#2174786, region_iploc#2174787, city_iploc#2174788, latitude_iploc#2174789, longitude_iploc#2174790, zip_code_iploc#2174791, time_zone_iploc#2174792, ISP_or_company_name_iploc#2174793, domain_name_iploc#2174794, net_speed_iploc#2174795, idd_code_iploc#2174796, area_code_iploc#2174797, weather_station_code_iploc#2174798, weather_station_name_iploc#2174799, mobile_country_codes_iploc#2174800, mobile_network_code_iploc#2174801, mobile_brand_iploc#2174802, elevation_iploc#2174803, usage_type_iploc#2174804, exploded_ip_iploc#2174805L, dotted_num_ip_iploc#2174806, country_code_iploc#2174807, alpha3code#2174808, country_blk_list_iploc#2174809, source_inetnum#2174810, nic_inetnum#2174811, originas_inetnum#2174812, netname_inetnum#2174813, nethandle_inetnum#2174814, startip_inetnum#2174815, endip_inetnum#2174816, bits_inetnum#2174817, ipversion_inetnum#2174818, org_inetnum#2174819, holder_inetnum#2174820, maintainer_inetnum#2174821, admincontact_inetnum#2174822, techcontact_inetnum#2174823, abusecontact_inetnum#2174824, parent_inetnum#2174825, nameserver_inetnum#2174826, city_inetnum#2174827, country_code_inetnum#2174828, rdate_inetnum#2174829, adate_inetnum#2174830, status_inetnum#2174831, mntlower_inetnum#2174832, mntdomains_inetnum#2174833, mntroutes_inetnum#2174834, inetnumup_inetnum#2174835, rev_inetnum#2174836, remarks_inetnum#2174837, exploded_ip_inetnum#2174838L, dotted_num_ip_inetnum#2174839, country_name_inetnum#2174840, startip_ddos#2174841, bits_ddos#2174842, asn_ddos#2174843, country_code_ddos#2174844, holder_ddos#2174845, date_ddos#2174846, asName_ddos#2174847, asBlock_ddos#2174848, asBits_ddos#2174849, asnClass_ddos#2174850, source_ddos#2174851, ipbestguessclass_ddos#2174852, startip_dotnum_ddos#2174853, startblock_ip_ddos#2174854, endblock_ip_ddos#2174855, startip_num_ddos#2174856, startblock_num_ddos#2174857L, endblock_num_ddos#2174858L, exploded_ip_ddos#2174859L, country_name_ddos#2174860, att_ctry_blacklist_iploc_flg#2196486]", "Arguments:": " isFinalPlan=false"}, "full_label": "AdaptiveSparkPlan", "ancestors": ["1"], "size": 612, "equiv": "0"}, "3": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [4, 609], "parent": [2], "node_id": "(579) SortMergeJoin", "lineno": 4640, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2192570L]", "Right": " keys [1]: [exploded_ip_iploc#2174805L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2"], "size": 611, "equiv": "0"}, "4": {"label": "Sort", "notes": "", "children": [5], "parent": [3], "node_id": "(573) Sort", "lineno": 4641, "detail": {"note": "Sort", "lineno": 5461, "Input": " [72]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2197098, cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2197103, 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2197105, 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2197107, 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2197109, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2197110, cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2197112, 50th_timedelta_15m#2197113, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2197114, cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2197116, 50th_timedelta_60m#2197117, stddev_timedelta_60m#2194169, 5m_success_count#2197118, 5m_failed_count#2197119, 5m_suc_dist_usr#2197120, 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2197122, 15m_failed_count#2197123, 15m_suc_dist_usr#2197124, 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, 60m_success_count#2197126, 60m_failed_count#2197127, 60m_suc_dist_usr#2197128, 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, heavy_hitters_flag#2194662, day_of_week#2196709, dow#2196710, distance_DOW#2196711, isWkend_flag#2196712, long_start_time#2196713L, year#2196714, month#2196715, day#2196716, hour#2196717, minute#2196718, second#2196719, timeofday#2196720, timeofday_cos#2196721]", "Arguments:": " [long_ip#2192570L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3"], "size": 605, "equiv": "0"}, "5": {"label": "Exchange", "notes": "", "children": [6], "parent": [4], "node_id": "(572) Exchange", "lineno": 4642, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [72]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2197098, cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2197103, 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2197105, 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2197107, 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2197109, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2197110, cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2197112, 50th_timedelta_15m#2197113, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2197114, cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2197116, 50th_timedelta_60m#2197117, stddev_timedelta_60m#2194169, 5m_success_count#2197118, 5m_failed_count#2197119, 5m_suc_dist_usr#2197120, 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2197122, 15m_failed_count#2197123, 15m_suc_dist_usr#2197124, 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, 60m_success_count#2197126, 60m_failed_count#2197127, 60m_suc_dist_usr#2197128, 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, heavy_hitters_flag#2194662, day_of_week#2196709, dow#2196710, distance_DOW#2196711, isWkend_flag#2196712, long_start_time#2196713L, year#2196714, month#2196715, day#2196716, hour#2196717, minute#2196718, second#2196719, timeofday#2196720, timeofday_cos#2196721]", "Arguments:": " hashpartitioning(long_ip#2192570L, 1000), ENSURE_REQUIREMENTS, [id=#1669388]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4"], "size": 604, "equiv": "0"}, "6": {"label": "HashAggregate", "notes": "", "children": [7], "parent": [5], "node_id": "(571) HashAggregate", "lineno": 4643, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [59]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2197098, cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2197103, 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2197105, 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2197107, 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2197109, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2197110, cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2197112, 50th_timedelta_15m#2197113, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2197114, cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2197116, 50th_timedelta_60m#2197117, stddev_timedelta_60m#2194169, 5m_success_count#2197118, 5m_failed_count#2197119, 5m_suc_dist_usr#2197120, 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2197122, 15m_failed_count#2197123, 15m_suc_dist_usr#2197124, 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, 60m_success_count#2197126, 60m_failed_count#2197127, 60m_suc_dist_usr#2197128, 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, heavy_hitters_flag#2194662]", "Keys": " [59]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2197098, cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2197103, 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2197105, 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2197107, 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2197109, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2197110, cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2197112, 50th_timedelta_15m#2197113, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2197114, cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2197116, 50th_timedelta_60m#2197117, stddev_timedelta_60m#2194169, 5m_success_count#2197118, 5m_failed_count#2197119, 5m_suc_dist_usr#2197120, 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2197122, 15m_failed_count#2197123, 15m_suc_dist_usr#2197124, 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, 60m_success_count#2197126, 60m_failed_count#2197127, 60m_suc_dist_usr#2197128, 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, heavy_hitters_flag#2194662]", "Functions:": " []", "Aggregate": " Attributes: []", "Results": " [72]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2197098, cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2197103, 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2197105, 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2197107, 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2197109, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2197110, cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2197112, 50th_timedelta_15m#2197113, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2197114, cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2197116, 50th_timedelta_60m#2197117, stddev_timedelta_60m#2194169, 5m_success_count#2197118, 5m_failed_count#2197119, 5m_suc_dist_usr#2197120, 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2197122, 15m_failed_count#2197123, 15m_suc_dist_usr#2197124, 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, 60m_success_count#2197126, 60m_failed_count#2197127, 60m_suc_dist_usr#2197128, 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, heavy_hitters_flag#2194662, date_format(window#2193915.start, EEEE, Some(Etc/UTC)) AS day_of_week#2196709, CASE WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = SUNDAY) THEN -1.3887282 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = MONDAY) THEN -0.9258188 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = TUESDAY) THEN -0.4629094 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = WEDNESDAY) THEN 0E-7 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = THURSDAY) THEN 0.4629094 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = FRIDAY) THEN 0.9258188 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = SATURDAY) THEN 1.3887282 ELSE 0E-7 END AS dow#2196710, COS(cast(CheckOverflow((promote_precision(cast(cast(CASE WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = SUNDAY) THEN -3 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = MONDAY) THEN -2 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = TUESDAY) THEN -1 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = WEDNESDAY) THEN 0 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = THURSDAY) THEN 1 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = FRIDAY) THEN 2 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = SATURDAY) THEN 3 ELSE 0 END as decimal(10,0)) as decimal(15,5))) / 2.16025), DecimalType(22,7), true) as double)) AS distance_DOW#2196711, CASE WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = SUNDAY) THEN 1 WHEN (upper(date_format(window#2193915.start, EEEE, Some(Etc/UTC))) = SATURDAY) THEN 1 ELSE 0 END AS isWkend_flag#2196712, cast(window#2193915.start as bigint) AS long_start_time#2196713L, cast(ephemeralsubstring(cast(window#2193915.start as string), 1, 4) as float) AS year#2196714, cast(ephemeralsubstring(cast(window#2193915.start as string), 6, 2) as float) AS month#2196715, cast(ephemeralsubstring(cast(window#2193915.start as string), 9, 2) as float) AS day#2196716, cast(ephemeralsubstring(cast(window#2193915.start as string), 12, 2) as float) AS hour#2196717, cast(ephemeralsubstring(cast(window#2193915.start as string), 15, 2) as float) AS minute#2196718, cast(ephemeralsubstring(cast(window#2193915.start as string), 18, 2) as float) AS second#2196719, ((((cast(cast(ephemeralsubstring(cast(window#2193915.start as string), 12, 2) as float) as double) + (cast(cast(ephemeralsubstring(cast(window#2193915.start as string), 15, 2) as float) as double) / 60.0)) + (cast(cast(ephemeralsubstring(cast(window#2193915.start as string), 18, 2) as float) as double) / 3600.0)) - 12.0) / 8.65) AS timeofday#2196720, COS(((((cast(cast(ephemeralsubstring(cast(window#2193915.start as string), 12, 2) as float) as double) + (cast(cast(ephemeralsubstring(cast(window#2193915.start as string), 15, 2) as float) as double) / 60.0)) + (cast(cast(ephemeralsubstring(cast(window#2193915.start as string), 18, 2) as float) as double) / 3600.0)) - 12.0) / 8.65)) AS timeofday_cos#2196721]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5"], "size": 603, "equiv": "0"}, "7": {"label": "Exchange", "notes": "", "children": [8], "parent": [6], "node_id": "(570) Exchange", "lineno": 4644, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [59]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2197098, cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2197103, 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2197105, 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2197107, 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2197109, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2197110, cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2197112, 50th_timedelta_15m#2197113, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2197114, cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2197116, 50th_timedelta_60m#2197117, stddev_timedelta_60m#2194169, 5m_success_count#2197118, 5m_failed_count#2197119, 5m_suc_dist_usr#2197120, 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2197122, 15m_failed_count#2197123, 15m_suc_dist_usr#2197124, 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, 60m_success_count#2197126, 60m_failed_count#2197127, 60m_suc_dist_usr#2197128, 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, heavy_hitters_flag#2194662]", "Arguments:": " hashpartitioning(long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2197098, cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2197103, 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2197105, 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2197107, 50th_cntDistUser_60m#2197108, ... 36 more fields), ENSURE_REQUIREMENTS, [id=#1669384]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6"], "size": 602, "equiv": "0"}, "8": {"label": "HashAggregate", "notes": "", "children": [9], "parent": [7], "node_id": "(569) HashAggregate", "lineno": 4645, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [59]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2197098, cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2197103, 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2197105, 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2197107, 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2197109, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2197110, cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2197112, 50th_timedelta_15m#2197113, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2197114, cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2197116, 50th_timedelta_60m#2197117, stddev_timedelta_60m#2194169, 5m_success_count#2197118, 5m_failed_count#2197119, 5m_suc_dist_usr#2197120, 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2197122, 15m_failed_count#2197123, 15m_suc_dist_usr#2197124, 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, 60m_success_count#2197126, 60m_failed_count#2197127, 60m_suc_dist_usr#2197128, 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, heavy_hitters_flag#2194662]", "Keys": " [59]: [long_ip#2192570L, window#2193915, knownfloatingpointnormalized(normalizenanandzero(cnt_attempts_ip_5m#2197098)) AS cnt_attempts_ip_5m#2197098, knownfloatingpointnormalized(normalizenanandzero(cnt_dist_usr_5m#2197099)) AS cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, knownfloatingpointnormalized(normalizenanandzero(50th_cnt_5m#2197103)) AS 50th_cnt_5m#2197103, knownfloatingpointnormalized(normalizenanandzero(50th_cntDistUser_5m#2197104)) AS 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, knownfloatingpointnormalized(normalizenanandzero(50th_cnt_15m#2197105)) AS 50th_cnt_15m#2197105, knownfloatingpointnormalized(normalizenanandzero(50th_cntDistUser_15m#2197106)) AS 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, knownfloatingpointnormalized(normalizenanandzero(50th_cnt_60m#2197107)) AS 50th_cnt_60m#2197107, knownfloatingpointnormalized(normalizenanandzero(50th_cntDistUser_60m#2197108)) AS 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, knownfloatingpointnormalized(normalizenanandzero(50th_timedelta_5m#2197109)) AS 50th_timedelta_5m#2197109, knownfloatingpointnormalized(normalizenanandzero(stddev_timedelta_5m#2193992)) AS stddev_timedelta_5m#2193992, tguard_data_dt#2193994, knownfloatingpointnormalized(normalizenanandzero(cnt_attempts_ip_15m#2197110)) AS cnt_attempts_ip_15m#2197110, knownfloatingpointnormalized(normalizenanandzero(cnt_dist_usr_15m#2197111)) AS cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2197112, knownfloatingpointnormalized(normalizenanandzero(50th_timedelta_15m#2197113)) AS 50th_timedelta_15m#2197113, knownfloatingpointnormalized(normalizenanandzero(stddev_timedelta_15m#2194091)) AS stddev_timedelta_15m#2194091, knownfloatingpointnormalized(normalizenanandzero(cnt_attempts_ip_60m#2197114)) AS cnt_attempts_ip_60m#2197114, knownfloatingpointnormalized(normalizenanandzero(cnt_dist_usr_60m#2197115)) AS cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2197116, knownfloatingpointnormalized(normalizenanandzero(50th_timedelta_60m#2197117)) AS 50th_timedelta_60m#2197117, knownfloatingpointnormalized(normalizenanandzero(stddev_timedelta_60m#2194169)) AS stddev_timedelta_60m#2194169, knownfloatingpointnormalized(normalizenanandzero(5m_success_count#2197118)) AS 5m_success_count#2197118, knownfloatingpointnormalized(normalizenanandzero(5m_failed_count#2197119)) AS 5m_failed_count#2197119, knownfloatingpointnormalized(normalizenanandzero(5m_suc_dist_usr#2197120)) AS 5m_suc_dist_usr#2197120, knownfloatingpointnormalized(normalizenanandzero(5m_fail_dist_usr#2197121)) AS 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, knownfloatingpointnormalized(normalizenanandzero(15m_success_count#2197122)) AS 15m_success_count#2197122, knownfloatingpointnormalized(normalizenanandzero(15m_failed_count#2197123)) AS 15m_failed_count#2197123, knownfloatingpointnormalized(normalizenanandzero(15m_suc_dist_usr#2197124)) AS 15m_suc_dist_usr#2197124, knownfloatingpointnormalized(normalizenanandzero(15m_fail_dist_usr#2197125)) AS 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, knownfloatingpointnormalized(normalizenanandzero(60m_success_count#2197126)) AS 60m_success_count#2197126, knownfloatingpointnormalized(normalizenanandzero(60m_failed_count#2197127)) AS 60m_failed_count#2197127, knownfloatingpointnormalized(normalizenanandzero(60m_suc_dist_usr#2197128)) AS 60m_suc_dist_usr#2197128, knownfloatingpointnormalized(normalizenanandzero(60m_fail_dist_usr#2197129)) AS 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, heavy_hitters_flag#2194662]", "Functions:": " []", "Aggregate": " Attributes: []", "Results": " [59]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2197098, cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2197100, username_set_5m#2197101, userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2197103, 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2197105, 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2197107, 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2197109, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2197110, cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2197112, 50th_timedelta_15m#2197113, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2197114, cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2197116, 50th_timedelta_60m#2197117, stddev_timedelta_60m#2194169, 5m_success_count#2197118, 5m_failed_count#2197119, 5m_suc_dist_usr#2197120, 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2197122, 15m_failed_count#2197123, 15m_suc_dist_usr#2197124, 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, 60m_success_count#2197126, 60m_failed_count#2197127, 60m_suc_dist_usr#2197128, 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, heavy_hitters_flag#2194662]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7"], "size": 601, "equiv": "0"}, "9": {"label": "Union", "notes": "", "children": [10, 535], "parent": [8], "node_id": "(568) Union", "lineno": 4646, "detail": {"note": "Union", "lineno": 5461}, "full_label": "Union", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8"], "size": 600, "equiv": "0"}, "10": {"label": "Project", "notes": "", "children": [11], "parent": [9], "node_id": "(497) Project", "lineno": 4647, "detail": {"note": "Project", "lineno": 5461, "Output": " [59]: [long_ip#2192570L, window#2193915, cast(cnt_attempts_ip_5m#2193938L as double) AS cnt_attempts_ip_5m#2197098, cast(cnt_dist_usr_5m#2193939L as double) AS cnt_dist_usr_5m#2197099, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942 AS app_id_set_5m#2197100, username_set_5m#2193944 AS username_set_5m#2197101, userAgent_5m#2193946 AS userAgent_5m#2197102, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, cast(50th_cnt_5m#2193964L as double) AS 50th_cnt_5m#2197103, cast(50th_cntDistUser_5m#2193966L as double) AS 50th_cntDistUser_5m#2197104, 50th_cntDistApp_5m#2193968L, cast(50th_cnt_15m#2193970L as double) AS 50th_cnt_15m#2197105, cast(50th_cntDistUser_15m#2193972L as double) AS 50th_cntDistUser_15m#2197106, 50th_cntDistApp_15m#2193974L, cast(50th_cnt_60m#2193976L as double) AS 50th_cnt_60m#2197107, cast(50th_cntDistUser_60m#2193978L as double) AS 50th_cntDistUser_60m#2197108, 50th_cntDistApp_60m#2193980L, cast(50th_timedelta_5m#2193982L as double) AS 50th_timedelta_5m#2197109, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cast(cnt_attempts_ip_15m#2194073L as double) AS cnt_attempts_ip_15m#2197110, cast(cnt_dist_usr_15m#2194074L as double) AS cnt_dist_usr_15m#2197111, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077 AS app_id_set_15m#2197112, cast(50th_timedelta_15m#2194081L as double) AS 50th_timedelta_15m#2197113, stddev_timedelta_15m#2194091, cast(cnt_attempts_ip_60m#2194151L as double) AS cnt_attempts_ip_60m#2197114, cast(cnt_dist_usr_60m#2194152L as double) AS cnt_dist_usr_60m#2197115, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155 AS app_id_set_60m#2197116, cast(50th_timedelta_60m#2194159L as double) AS 50th_timedelta_60m#2197117, stddev_timedelta_60m#2194169, cast(5m_success_count#2194445L as double) AS 5m_success_count#2197118, cast(5m_failed_count#2194446L as double) AS 5m_failed_count#2197119, cast(5m_suc_dist_usr#2194447L as double) AS 5m_suc_dist_usr#2197120, cast(5m_fail_dist_usr#2194448L as double) AS 5m_fail_dist_usr#2197121, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, cast(15m_success_count#2194484L as double) AS 15m_success_count#2197122, cast(15m_failed_count#2194485L as double) AS 15m_failed_count#2197123, cast(15m_suc_dist_usr#2194486L as double) AS 15m_suc_dist_usr#2197124, cast(15m_fail_dist_usr#2194487L as double) AS 15m_fail_dist_usr#2197125, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, cast(60m_success_count#2194523L as double) AS 60m_success_count#2197126, cast(60m_failed_count#2194524L as double) AS 60m_failed_count#2197127, cast(60m_suc_dist_usr#2194525L as double) AS 60m_suc_dist_usr#2197128, cast(60m_fail_dist_usr#2194526L as double) AS 60m_fail_dist_usr#2197129, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L, 0 AS heavy_hitters_flag#2194662]", "Input": " [60]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169, 5m_success_count#2194445L, 5m_failed_count#2194446L, 5m_suc_dist_usr#2194447L, 5m_fail_dist_usr#2194448L, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2194484L, 15m_failed_count#2194485L, 15m_suc_dist_usr#2194486L, 15m_fail_dist_usr#2194487L, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L, long_ip#2194521L, _gen_alias_2581293#2581293, 60m_success_count#2194523L, 60m_failed_count#2194524L, 60m_suc_dist_usr#2194525L, 60m_fail_dist_usr#2194526L, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9"], "size": 525, "equiv": "0"}, "11": {"label": "SortMergeJoin Inner", "notes": "", "children": [12, 422], "parent": [10], "node_id": "(496) SortMergeJoin", "lineno": 4648, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [2]: [long_ip#2192570L, window#2193915.end]", "Right": " keys [2]: [long_ip#2194521L, _gen_alias_2581293#2581293]", "Join": " condition: None"}, "full_label": "SortMergeJoin Inner", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10"], "size": 524, "equiv": "0"}, "12": {"label": "Project", "notes": "", "children": [13], "parent": [11], "node_id": "(386) Project", "lineno": 4649, "detail": {"note": "Project", "lineno": 5461, "Output": " [52]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169, 5m_success_count#2194445L, 5m_failed_count#2194446L, 5m_suc_dist_usr#2194447L, 5m_fail_dist_usr#2194448L, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, 15m_success_count#2194484L, 15m_failed_count#2194485L, 15m_suc_dist_usr#2194486L, 15m_fail_dist_usr#2194487L, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L]", "Input": " [54]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169, 5m_success_count#2194445L, 5m_failed_count#2194446L, 5m_suc_dist_usr#2194447L, 5m_fail_dist_usr#2194448L, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L, long_ip#2194482L, _gen_alias_2581294#2581294, 15m_success_count#2194484L, 15m_failed_count#2194485L, 15m_suc_dist_usr#2194486L, 15m_fail_dist_usr#2194487L, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11"], "size": 410, "equiv": "0"}, "13": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [14, 309], "parent": [12], "node_id": "(385) SortMergeJoin", "lineno": 4650, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [2]: [long_ip#2192570L, window#2193915.end]", "Right": " keys [2]: [long_ip#2194482L, _gen_alias_2581294#2581294]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12"], "size": 409, "equiv": "0"}, "14": {"label": "Project", "notes": "", "children": [15], "parent": [13], "node_id": "(275) Project", "lineno": 4651, "detail": {"note": "Project", "lineno": 5461, "Output": " [46]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169, 5m_success_count#2194445L, 5m_failed_count#2194446L, 5m_suc_dist_usr#2194447L, 5m_fail_dist_usr#2194448L, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L]", "Input": " [48]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169, long_ip#2194443L, _gen_alias_2581295#2581295, 5m_success_count#2194445L, 5m_failed_count#2194446L, 5m_suc_dist_usr#2194447L, 5m_fail_dist_usr#2194448L, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13"], "size": 295, "equiv": "0"}, "15": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [16, 202], "parent": [14], "node_id": "(274) SortMergeJoin", "lineno": 4652, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [2]: [long_ip#2192570L, window#2193915.end]", "Right": " keys [2]: [long_ip#2194443L, _gen_alias_2581295#2581295]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14"], "size": 294, "equiv": "0"}, "16": {"label": "Project", "notes": "", "children": [17], "parent": [15], "node_id": "(170) Project", "lineno": 4653, "detail": {"note": "Project", "lineno": 5461, "Output": " [40]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169]", "Input": " [42]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091, long_ip#2172242L, _gen_alias_2581296#2581296, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15"], "size": 186, "equiv": "0"}, "17": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [18, 144], "parent": [16], "node_id": "(169) SortMergeJoin", "lineno": 4654, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [2]: [long_ip#2192570L, window#2193915.end]", "Right": " keys [2]: [long_ip#2172242L, _gen_alias_2581296#2581296]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16"], "size": 185, "equiv": "0"}, "18": {"label": "Project", "notes": "", "children": [19], "parent": [17], "node_id": "(112) Project", "lineno": 4655, "detail": {"note": "Project", "lineno": 5461, "Output": " [34]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091]", "Input": " [36]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994, long_ip#2192590L, _gen_alias_2581297#2581297, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17"], "size": 126, "equiv": "0"}, "19": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [20, 86], "parent": [18], "node_id": "(111) SortMergeJoin", "lineno": 4656, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [2]: [long_ip#2192570L, window#2193915.end]", "Right": " keys [2]: [long_ip#2192590L, _gen_alias_2581297#2581297]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18"], "size": 125, "equiv": "0"}, "20": {"label": "Sort", "notes": "", "children": [21], "parent": [19], "node_id": "(54) Sort", "lineno": 4657, "detail": {"note": "Sort", "lineno": 5461, "Input": " [28]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994]", "Arguments:": " [long_ip#2192570L ASC NULLS FIRST, window#2193915.end ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"], "size": 66, "equiv": "0"}, "21": {"label": "Exchange", "notes": "", "children": [22], "parent": [20], "node_id": "(53) Exchange", "lineno": 4658, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [28]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994]", "Arguments:": " hashpartitioning(long_ip#2192570L, window#2193915.end, 1000), ENSURE_REQUIREMENTS, [id=#1668929]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20"], "size": 65, "equiv": "0"}, "22": {"label": "Filter", "notes": "", "children": [23], "parent": [21], "node_id": "(52) Filter", "lineno": 4659, "detail": {"note": "Filter", "lineno": 5461, "Input": " [28]: [long_ip#2192570L, window#2193915, cnt_attempts_ip_5m#2193938L, cnt_dist_usr_5m#2193939L, cnt_dist_app_5m#2193940L, app_id_set_5m#2193942, username_set_5m#2193944, userAgent_5m#2193946, ip_address#2193948, attsdk_flag#2193950, sum_attsdk_flag_5m_cnt#2193952L, max_targeted_user_score#2193954, min_targeted_user_score#2193956, 50th_targeted_user_score#2193958, 75th_targeted_user_score#2193960, 90th_targeted_user_score#2193962, 50th_cnt_5m#2193964L, 50th_cntDistUser_5m#2193966L, 50th_cntDistApp_5m#2193968L, 50th_cnt_15m#2193970L, 50th_cntDistUser_15m#2193972L, 50th_cntDistApp_15m#2193974L, 50th_cnt_60m#2193976L, 50th_cntDistUser_60m#2193978L, 50th_cntDistApp_60m#2193980L, 50th_timedelta_5m#2193982L, stddev_timedelta_5m#2193992, tguard_data_dt#2193994]", "Condition": " : isnotnull(long_ip#2192570L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21"], "size": 64, "equiv": "0"}, "23": {"label": "SortAggregate", "notes": "", "children": [24], "parent": [22], "node_id": "(51) SortAggregate", "lineno": 4660, "detail": {"note": "SortAggregate", "lineno": 5461, "Input": " [52]: [long_ip#2192570L, window#2194005, first#2581789L, valueSet#2581790, count#2581792L, count#2581794L, first#2581797, valueSet#2581798, first#2581801, valueSet#2581802, first#2581805, valueSet#2581806, first#2581809, valueSet#2581810, first#2581813, valueSet#2581814, first#2581817L, valueSet#2581818, first#2581821, valueSet#2581822, first#2581825, valueSet#2581826, first#2581829, valueSet#2581830, first#2581833, valueSet#2581834, first#2581837, valueSet#2581838, first#2581841L, valueSet#2581842, first#2581845L, valueSet#2581846, first#2581849L, valueSet#2581850, first#2581853L, valueSet#2581854, first#2581857L, valueSet#2581858, first#2581861L, valueSet#2581862, first#2581865L, valueSet#2581866, first#2581869L, valueSet#2581870, first#2581873L, valueSet#2581874, first#2581877L, valueSet#2581878, first#2581881, valueSet#2581882, first#2581885, valueSet#2581886]", "Keys": " [2]: [long_ip#2192570L, window#2194005]", "Functions": " [26]: [finalmerge_first(merge first#2581789L, valueSet#2581790) AS first(if ((gid#2581618 = 0)) count(t.`long_ip`)#2581641L else null) ignore nulls#2581642L, finalmerge_count(merge count#2581792L) AS count(if ((gid#2581618 = 1)) __auto_generated_subquery_name.`username`#2581619 else null)#2194003L, finalmerge_count(merge count#2581794L) AS count(if ((gid#2581618 = 2)) t.`application_id`#2581620 else null)#2194004L, finalmerge_first(merge first#2581797, valueSet#2581798) AS first(if ((gid#2581618 = 0)) collect_set(t.`application_id`)#2581643 else null) ignore nulls#2581644, finalmerge_first(merge first#2581801, valueSet#2581802) AS first(if ((gid#2581618 = 0)) collect_set(__auto_generated_subquery_name.`username`)#2581645 else null) ignore nulls#2581646, finalmerge_first(merge first#2581805, valueSet#2581806) AS first(if ((gid#2581618 = 0)) collect_set(t.`userAgent`)#2581647 else null) ignore nulls#2581648, finalmerge_first(merge first#2581809, valueSet#2581810) AS first(if ((gid#2581618 = 0)) first(t.`ip_address`)#2581649 else null) ignore nulls#2581650, finalmerge_first(merge first#2581813, valueSet#2581814) AS first(if ((gid#2581618 = 0)) max(t.`attsdk_flag`)#2581651 else null) ignore nulls#2581652, finalmerge_first(merge first#2581817L, valueSet#2581818) AS first(if ((gid#2581618 = 0)) sum(CAST(t.`attsdk_flag` AS BIGINT))#2581653L else null) ignore nulls#2581654L, finalmerge_first(merge first#2581821, valueSet#2581822) AS first(if ((gid#2581618 = 0)) max(u.`targeted_user_score`)#2581655 else null) ignore nulls#2581656, finalmerge_first(merge first#2581825, valueSet#2581826) AS first(if ((gid#2581618 = 0)) min(u.`targeted_user_score`)#2581657 else null) ignore nulls#2581658, finalmerge_first(merge first#2581829, valueSet#2581830) AS first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581659 else null) ignore nulls#2581660, finalmerge_first(merge first#2581833, valueSet#2581834) AS first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581661 else null) ignore nulls#2581662, finalmerge_first(merge first#2581837, valueSet#2581838) AS first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581663 else null) ignore nulls#2581664, finalmerge_first(merge first#2581841L, valueSet#2581842) AS first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_5m`, 0.5D, 10000)#2581665L else null) ignore nulls#2581666L, finalmerge_first(merge first#2581845L, valueSet#2581846) AS first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`, 0.5D, 10000)#2581667L else null) ignore nulls#2581668L, finalmerge_first(merge first#2581849L, valueSet#2581850) AS first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`, 0.5D, 10000)#2581669L else null) ignore nulls#2581670L, finalmerge_first(merge first#2581853L, valueSet#2581854) AS first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_15m`, 0.5D, 10000)#2581671L else null) ignore nulls#2581672L, finalmerge_first(merge first#2581857L, valueSet#2581858) AS first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`, 0.5D, 10000)#2581673L else null) ignore nulls#2581674L, finalmerge_first(merge first#2581861L, valueSet#2581862) AS first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`, 0.5D, 10000)#2581675L else null) ignore nulls#2581676L, finalmerge_first(merge first#2581865L, valueSet#2581866) AS first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_60m`, 0.5D, 10000)#2581677L else null) ignore nulls#2581678L, finalmerge_first(merge first#2581869L, valueSet#2581870) AS first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`, 0.5D, 10000)#2581679L else null) ignore nulls#2581680L, finalmerge_first(merge first#2581873L, valueSet#2581874) AS first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`, 0.5D, 10000)#2581681L else null) ignore nulls#2581682L, finalmerge_first(merge first#2581877L, valueSet#2581878) AS first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`timedelta`, 0.5D, 10000)#2581683L else null) ignore nulls#2581684L, finalmerge_first(merge first#2581881, valueSet#2581882) AS first(if ((gid#2581618 = 0)) stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE))#2581693 else null) ignore nulls#2581694, finalmerge_first(merge first#2581885, valueSet#2581886) AS first(if ((gid#2581618 = 0)) max(__auto_generated_subquery_name.`tguard_data_dt`)#2581695 else null) ignore nulls#2581696]", "Aggregate": " Attributes [26]: [first(if ((gid#2581618 = 0)) count(t.`long_ip`)#2581641L else null) ignore nulls#2581642L, count(if ((gid#2581618 = 1)) __auto_generated_subquery_name.`username`#2581619 else null)#2194003L, count(if ((gid#2581618 = 2)) t.`application_id`#2581620 else null)#2194004L, first(if ((gid#2581618 = 0)) collect_set(t.`application_id`)#2581643 else null) ignore nulls#2581644, first(if ((gid#2581618 = 0)) collect_set(__auto_generated_subquery_name.`username`)#2581645 else null) ignore nulls#2581646, first(if ((gid#2581618 = 0)) collect_set(t.`userAgent`)#2581647 else null) ignore nulls#2581648, first(if ((gid#2581618 = 0)) first(t.`ip_address`)#2581649 else null) ignore nulls#2581650, first(if ((gid#2581618 = 0)) max(t.`attsdk_flag`)#2581651 else null) ignore nulls#2581652, first(if ((gid#2581618 = 0)) sum(CAST(t.`attsdk_flag` AS BIGINT))#2581653L else null) ignore nulls#2581654L, first(if ((gid#2581618 = 0)) max(u.`targeted_user_score`)#2581655 else null) ignore nulls#2581656, first(if ((gid#2581618 = 0)) min(u.`targeted_user_score`)#2581657 else null) ignore nulls#2581658, first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581659 else null) ignore nulls#2581660, first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581661 else null) ignore nulls#2581662, first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581663 else null) ignore nulls#2581664, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_5m`, 0.5D, 10000)#2581665L else null) ignore nulls#2581666L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`, 0.5D, 10000)#2581667L else null) ignore nulls#2581668L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`, 0.5D, 10000)#2581669L else null) ignore nulls#2581670L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_15m`, 0.5D, 10000)#2581671L else null) ignore nulls#2581672L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`, 0.5D, 10000)#2581673L else null) ignore nulls#2581674L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`, 0.5D, 10000)#2581675L else null) ignore nulls#2581676L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_60m`, 0.5D, 10000)#2581677L else null) ignore nulls#2581678L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`, 0.5D, 10000)#2581679L else null) ignore nulls#2581680L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`, 0.5D, 10000)#2581681L else null) ignore nulls#2581682L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`timedelta`, 0.5D, 10000)#2581683L else null) ignore nulls#2581684L, first(if ((gid#2581618 = 0)) stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE))#2581693 else null) ignore nulls#2581694, first(if ((gid#2581618 = 0)) max(__auto_generated_subquery_name.`tguard_data_dt`)#2581695 else null) ignore nulls#2581696]", "Results": " [28]: [long_ip#2192570L, window#2194005 AS window#2193915, coalesce(first(if ((gid#2581618 = 0)) count(t.`long_ip`)#2581641L else null) ignore nulls#2581642L, 0) AS cnt_attempts_ip_5m#2193938L, count(if ((gid#2581618 = 1)) __auto_generated_subquery_name.`username`#2581619 else null)#2194003L AS cnt_dist_usr_5m#2193939L, count(if ((gid#2581618 = 2)) t.`application_id`#2581620 else null)#2194004L AS cnt_dist_app_5m#2193940L, coalesce(first(if ((gid#2581618 = 0)) collect_set(t.`application_id`)#2581643 else null) ignore nulls#2581644, []) AS app_id_set_5m#2193942, coalesce(first(if ((gid#2581618 = 0)) collect_set(__auto_generated_subquery_name.`username`)#2581645 else null) ignore nulls#2581646, []) AS username_set_5m#2193944, coalesce(first(if ((gid#2581618 = 0)) collect_set(t.`userAgent`)#2581647 else null) ignore nulls#2581648, []) AS userAgent_5m#2193946, first(if ((gid#2581618 = 0)) first(t.`ip_address`)#2581649 else null) ignore nulls#2581650 AS ip_address#2193948, first(if ((gid#2581618 = 0)) max(t.`attsdk_flag`)#2581651 else null) ignore nulls#2581652 AS attsdk_flag#2193950, first(if ((gid#2581618 = 0)) sum(CAST(t.`attsdk_flag` AS BIGINT))#2581653L else null) ignore nulls#2581654L AS sum_attsdk_flag_5m_cnt#2193952L, first(if ((gid#2581618 = 0)) max(u.`targeted_user_score`)#2581655 else null) ignore nulls#2581656 AS max_targeted_user_score#2193954, first(if ((gid#2581618 = 0)) min(u.`targeted_user_score`)#2581657 else null) ignore nulls#2581658 AS min_targeted_user_score#2193956, first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581659 else null) ignore nulls#2581660[0] AS 50th_targeted_user_score#2193958, first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581661 else null) ignore nulls#2581662[1] AS 75th_targeted_user_score#2193960, first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581663 else null) ignore nulls#2581664[2] AS 90th_targeted_user_score#2193962, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_5m`, 0.5D, 10000)#2581665L else null) ignore nulls#2581666L AS 50th_cnt_5m#2193964L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`, 0.5D, 10000)#2581667L else null) ignore nulls#2581668L AS 50th_cntDistUser_5m#2193966L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`, 0.5D, 10000)#2581669L else null) ignore nulls#2581670L AS 50th_cntDistApp_5m#2193968L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_15m`, 0.5D, 10000)#2581671L else null) ignore nulls#2581672L AS 50th_cnt_15m#2193970L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`, 0.5D, 10000)#2581673L else null) ignore nulls#2581674L AS 50th_cntDistUser_15m#2193972L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`, 0.5D, 10000)#2581675L else null) ignore nulls#2581676L AS 50th_cntDistApp_15m#2193974L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_60m`, 0.5D, 10000)#2581677L else null) ignore nulls#2581678L AS 50th_cnt_60m#2193976L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`, 0.5D, 10000)#2581679L else null) ignore nulls#2581680L AS 50th_cntDistUser_60m#2193978L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`, 0.5D, 10000)#2581681L else null) ignore nulls#2581682L AS 50th_cntDistApp_60m#2193980L, first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`timedelta`, 0.5D, 10000)#2581683L else null) ignore nulls#2581684L AS 50th_timedelta_5m#2193982L, first(if ((gid#2581618 = 0)) stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE))#2581693 else null) ignore nulls#2581694 AS stddev_timedelta_5m#2193992, first(if ((gid#2581618 = 0)) max(__auto_generated_subquery_name.`tguard_data_dt`)#2581695 else null) ignore nulls#2581696 AS tguard_data_dt#2193994]"}, "full_label": "SortAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22"], "size": 63, "equiv": "0"}, "24": {"label": "Sort", "notes": "", "children": [25], "parent": [23], "node_id": "(50) Sort", "lineno": 4661, "detail": {"note": "Sort", "lineno": 5461, "Input": " [52]: [long_ip#2192570L, window#2194005, first#2581789L, valueSet#2581790, count#2581792L, count#2581794L, first#2581797, valueSet#2581798, first#2581801, valueSet#2581802, first#2581805, valueSet#2581806, first#2581809, valueSet#2581810, first#2581813, valueSet#2581814, first#2581817L, valueSet#2581818, first#2581821, valueSet#2581822, first#2581825, valueSet#2581826, first#2581829, valueSet#2581830, first#2581833, valueSet#2581834, first#2581837, valueSet#2581838, first#2581841L, valueSet#2581842, first#2581845L, valueSet#2581846, first#2581849L, valueSet#2581850, first#2581853L, valueSet#2581854, first#2581857L, valueSet#2581858, first#2581861L, valueSet#2581862, first#2581865L, valueSet#2581866, first#2581869L, valueSet#2581870, first#2581873L, valueSet#2581874, first#2581877L, valueSet#2581878, first#2581881, valueSet#2581882, first#2581885, valueSet#2581886]", "Arguments:": " [long_ip#2192570L ASC NULLS FIRST, window#2194005 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23"], "size": 62, "equiv": "0"}, "25": {"label": "Exchange", "notes": "", "children": [26], "parent": [24], "node_id": "(49) Exchange", "lineno": 4662, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [52]: [long_ip#2192570L, window#2194005, first#2581789L, valueSet#2581790, count#2581792L, count#2581794L, first#2581797, valueSet#2581798, first#2581801, valueSet#2581802, first#2581805, valueSet#2581806, first#2581809, valueSet#2581810, first#2581813, valueSet#2581814, first#2581817L, valueSet#2581818, first#2581821, valueSet#2581822, first#2581825, valueSet#2581826, first#2581829, valueSet#2581830, first#2581833, valueSet#2581834, first#2581837, valueSet#2581838, first#2581841L, valueSet#2581842, first#2581845L, valueSet#2581846, first#2581849L, valueSet#2581850, first#2581853L, valueSet#2581854, first#2581857L, valueSet#2581858, first#2581861L, valueSet#2581862, first#2581865L, valueSet#2581866, first#2581869L, valueSet#2581870, first#2581873L, valueSet#2581874, first#2581877L, valueSet#2581878, first#2581881, valueSet#2581882, first#2581885, valueSet#2581886]", "Arguments:": " hashpartitioning(long_ip#2192570L, window#2194005, 1000), ENSURE_REQUIREMENTS, [id=#1668871]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24"], "size": 61, "equiv": "0"}, "26": {"label": "SortAggregate", "notes": "", "children": [27], "parent": [25], "node_id": "(48) SortAggregate", "lineno": 4663, "detail": {"note": "SortAggregate", "lineno": 5461, "Input": " [29]: [long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618, count(t.`long_ip`)#2581641L, collect_set(t.`application_id`)#2581643, collect_set(__auto_generated_subquery_name.`username`)#2581645, collect_set(t.`userAgent`)#2581647, first(t.`ip_address`)#2581649, max(t.`attsdk_flag`)#2581651, sum(CAST(t.`attsdk_flag` AS BIGINT))#2581653L, max(u.`targeted_user_score`)#2581655, min(u.`targeted_user_score`)#2581657, percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581659, percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581661, percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581663, percentile_approx(__auto_generated_subquery_name.`cnt_5m`, 0.5D, 10000)#2581665L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`, 0.5D, 10000)#2581667L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`, 0.5D, 10000)#2581669L, percentile_approx(__auto_generated_subquery_name.`cnt_15m`, 0.5D, 10000)#2581671L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`, 0.5D, 10000)#2581673L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`, 0.5D, 10000)#2581675L, percentile_approx(__auto_generated_subquery_name.`cnt_60m`, 0.5D, 10000)#2581677L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`, 0.5D, 10000)#2581679L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`, 0.5D, 10000)#2581681L, percentile_approx(__auto_generated_subquery_name.`timedelta`, 0.5D, 10000)#2581683L, stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE))#2581693, max(__auto_generated_subquery_name.`tguard_data_dt`)#2581695]", "Keys": " [2]: [long_ip#2192570L, window#2194005]", "Functions": " [26]: [partial_first(if ((gid#2581618 = 0)) count(t.`long_ip`)#2581641L else null, true) AS (first#2581789L, valueSet#2581790), partial_count(if ((gid#2581618 = 1)) __auto_generated_subquery_name.`username`#2581619 else null) AS count#2581792L, partial_count(if ((gid#2581618 = 2)) t.`application_id`#2581620 else null) AS count#2581794L, partial_first(if ((gid#2581618 = 0)) collect_set(t.`application_id`)#2581643 else null, true) AS (first#2581797, valueSet#2581798), partial_first(if ((gid#2581618 = 0)) collect_set(__auto_generated_subquery_name.`username`)#2581645 else null, true) AS (first#2581801, valueSet#2581802), partial_first(if ((gid#2581618 = 0)) collect_set(t.`userAgent`)#2581647 else null, true) AS (first#2581805, valueSet#2581806), partial_first(if ((gid#2581618 = 0)) first(t.`ip_address`)#2581649 else null, true) AS (first#2581809, valueSet#2581810), partial_first(if ((gid#2581618 = 0)) max(t.`attsdk_flag`)#2581651 else null, true) AS (first#2581813, valueSet#2581814), partial_first(if ((gid#2581618 = 0)) sum(CAST(t.`attsdk_flag` AS BIGINT))#2581653L else null, true) AS (first#2581817L, valueSet#2581818), partial_first(if ((gid#2581618 = 0)) max(u.`targeted_user_score`)#2581655 else null, true) AS (first#2581821, valueSet#2581822), partial_first(if ((gid#2581618 = 0)) min(u.`targeted_user_score`)#2581657 else null, true) AS (first#2581825, valueSet#2581826), partial_first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581659 else null, true) AS (first#2581829, valueSet#2581830), partial_first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581661 else null, true) AS (first#2581833, valueSet#2581834), partial_first(if ((gid#2581618 = 0)) percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581663 else null, true) AS (first#2581837, valueSet#2581838), partial_first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_5m`, 0.5D, 10000)#2581665L else null, true) AS (first#2581841L, valueSet#2581842), partial_first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`, 0.5D, 10000)#2581667L else null, true) AS (first#2581845L, valueSet#2581846), partial_first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`, 0.5D, 10000)#2581669L else null, true) AS (first#2581849L, valueSet#2581850), partial_first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_15m`, 0.5D, 10000)#2581671L else null, true) AS (first#2581853L, valueSet#2581854), partial_first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`, 0.5D, 10000)#2581673L else null, true) AS (first#2581857L, valueSet#2581858), partial_first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`, 0.5D, 10000)#2581675L else null, true) AS (first#2581861L, valueSet#2581862), partial_first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cnt_60m`, 0.5D, 10000)#2581677L else null, true) AS (first#2581865L, valueSet#2581866), partial_first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`, 0.5D, 10000)#2581679L else null, true) AS (first#2581869L, valueSet#2581870), partial_first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`, 0.5D, 10000)#2581681L else null, true) AS (first#2581873L, valueSet#2581874), partial_first(if ((gid#2581618 = 0)) percentile_approx(__auto_generated_subquery_name.`timedelta`, 0.5D, 10000)#2581683L else null, true) AS (first#2581877L, valueSet#2581878), partial_first(if ((gid#2581618 = 0)) stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE))#2581693 else null, true) AS (first#2581881, valueSet#2581882), partial_first(if ((gid#2581618 = 0)) max(__auto_generated_subquery_name.`tguard_data_dt`)#2581695 else null, true) AS (first#2581885, valueSet#2581886)]", "Aggregate": " Attributes [50]: [first#2581787L, valueSet#2581788, count#2581791L, count#2581793L, first#2581795, valueSet#2581796, first#2581799, valueSet#2581800, first#2581803, valueSet#2581804, first#2581807, valueSet#2581808, first#2581811, valueSet#2581812, first#2581815L, valueSet#2581816, first#2581819, valueSet#2581820, first#2581823, valueSet#2581824, first#2581827, valueSet#2581828, first#2581831, valueSet#2581832, first#2581835, valueSet#2581836, first#2581839L, valueSet#2581840, first#2581843L, valueSet#2581844, first#2581847L, valueSet#2581848, first#2581851L, valueSet#2581852, first#2581855L, valueSet#2581856, first#2581859L, valueSet#2581860, first#2581863L, valueSet#2581864, first#2581867L, valueSet#2581868, first#2581871L, valueSet#2581872, first#2581875L, valueSet#2581876, first#2581879, valueSet#2581880, first#2581883, valueSet#2581884]", "Results": " [52]: [long_ip#2192570L, window#2194005, first#2581789L, valueSet#2581790, count#2581792L, count#2581794L, first#2581797, valueSet#2581798, first#2581801, valueSet#2581802, first#2581805, valueSet#2581806, first#2581809, valueSet#2581810, first#2581813, valueSet#2581814, first#2581817L, valueSet#2581818, first#2581821, valueSet#2581822, first#2581825, valueSet#2581826, first#2581829, valueSet#2581830, first#2581833, valueSet#2581834, first#2581837, valueSet#2581838, first#2581841L, valueSet#2581842, first#2581845L, valueSet#2581846, first#2581849L, valueSet#2581850, first#2581853L, valueSet#2581854, first#2581857L, valueSet#2581858, first#2581861L, valueSet#2581862, first#2581865L, valueSet#2581866, first#2581869L, valueSet#2581870, first#2581873L, valueSet#2581874, first#2581877L, valueSet#2581878, first#2581881, valueSet#2581882, first#2581885, valueSet#2581886]"}, "full_label": "SortAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25"], "size": 60, "equiv": "0"}, "27": {"label": "Sort", "notes": "", "children": [28], "parent": [26], "node_id": "(47) Sort", "lineno": 4664, "detail": {"note": "Sort", "lineno": 5461, "Input": " [29]: [long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618, count(t.`long_ip`)#2581641L, collect_set(t.`application_id`)#2581643, collect_set(__auto_generated_subquery_name.`username`)#2581645, collect_set(t.`userAgent`)#2581647, first(t.`ip_address`)#2581649, max(t.`attsdk_flag`)#2581651, sum(CAST(t.`attsdk_flag` AS BIGINT))#2581653L, max(u.`targeted_user_score`)#2581655, min(u.`targeted_user_score`)#2581657, percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581659, percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581661, percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581663, percentile_approx(__auto_generated_subquery_name.`cnt_5m`, 0.5D, 10000)#2581665L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`, 0.5D, 10000)#2581667L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`, 0.5D, 10000)#2581669L, percentile_approx(__auto_generated_subquery_name.`cnt_15m`, 0.5D, 10000)#2581671L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`, 0.5D, 10000)#2581673L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`, 0.5D, 10000)#2581675L, percentile_approx(__auto_generated_subquery_name.`cnt_60m`, 0.5D, 10000)#2581677L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`, 0.5D, 10000)#2581679L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`, 0.5D, 10000)#2581681L, percentile_approx(__auto_generated_subquery_name.`timedelta`, 0.5D, 10000)#2581683L, stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE))#2581693, max(__auto_generated_subquery_name.`tguard_data_dt`)#2581695]", "Arguments:": " [long_ip#2192570L ASC NULLS FIRST, window#2194005 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26"], "size": 59, "equiv": "0"}, "28": {"label": "ObjectHashAggregate", "notes": "", "children": [29], "parent": [27], "node_id": "(46) ObjectHashAggregate", "lineno": 4665, "detail": {"note": "ObjectHashAggregate", "lineno": 5461, "Input": " [30]: [long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618, count#2581896L, buf#2581898, buf#2581900, buf#2581902, first#2581905, valueSet#2581906, max#2581908, sum#2581910L, max#2581912, min#2581914, buf#2581916, buf#2581918, buf#2581920, buf#2581922, buf#2581924, buf#2581926, buf#2581928, buf#2581930, buf#2581932, buf#2581934, buf#2581936, n#2581690, avg#2581691, m2#2581692, max#2581938]", "Keys": " [5]: [long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618]", "Functions": " [22]: [finalmerge_count(merge count#2581896L) AS count(t.`long_ip`#2581621L)#2193937L, finalmerge_collect_set(merge buf#2581898) AS collect_set(t.`application_id`#2581622, 0, 0)#2193941, finalmerge_collect_set(merge buf#2581900) AS collect_set(__auto_generated_subquery_name.`username`#2581623, 0, 0)#2193943, finalmerge_collect_set(merge buf#2581902) AS collect_set(t.`userAgent`#2581624, 0, 0)#2193945, finalmerge_first(merge first#2581905, valueSet#2581906) AS first(t.`ip_address`#2581625)()#2193947, finalmerge_max(merge max#2581908) AS max(t.`attsdk_flag`#2581626)#2193949, finalmerge_sum(merge sum#2581910L) AS sum(CAST(t.`attsdk_flag` AS BIGINT)#2581627L)#2193951L, finalmerge_max(merge max#2581912) AS max(u.`targeted_user_score`#2581628)#2193953, finalmerge_min(merge min#2581914) AS min(u.`targeted_user_score`#2581628)#2193955, finalmerge_percentile_approx(merge buf#2581916) AS percentile_approx(u.`targeted_user_score`#2581628, [0.5,0.75,0.9], 10000, 0, 0)#2193957, finalmerge_percentile_approx(merge buf#2581918) AS percentile_approx(__auto_generated_subquery_name.`cnt_5m`#2581629L, 0.5, 10000, 0, 0)#2193963L, finalmerge_percentile_approx(merge buf#2581920) AS percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`#2581630L, 0.5, 10000, 0, 0)#2193965L, finalmerge_percentile_approx(merge buf#2581922) AS percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`#2581631L, 0.5, 10000, 0, 0)#2193967L, finalmerge_percentile_approx(merge buf#2581924) AS percentile_approx(__auto_generated_subquery_name.`cnt_15m`#2581632L, 0.5, 10000, 0, 0)#2193969L, finalmerge_percentile_approx(merge buf#2581926) AS percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`#2581633L, 0.5, 10000, 0, 0)#2193971L, finalmerge_percentile_approx(merge buf#2581928) AS percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`#2581634L, 0.5, 10000, 0, 0)#2193973L, finalmerge_percentile_approx(merge buf#2581930) AS percentile_approx(__auto_generated_subquery_name.`cnt_60m`#2581635L, 0.5, 10000, 0, 0)#2193975L, finalmerge_percentile_approx(merge buf#2581932) AS percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`#2581636L, 0.5, 10000, 0, 0)#2193977L, finalmerge_percentile_approx(merge buf#2581934) AS percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`#2581637L, 0.5, 10000, 0, 0)#2193979L, finalmerge_percentile_approx(merge buf#2581936) AS percentile_approx(__auto_generated_subquery_name.`timedelta`#2581638L, 0.5, 10000, 0, 0)#2193981L, finalmerge_stddev_samp(merge n#2581690, avg#2581691, m2#2581692) AS stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE)#2581639)#2193991, finalmerge_max(merge max#2581938) AS max(__auto_generated_subquery_name.`tguard_data_dt`#2581640)#2193993]", "Aggregate": " Attributes [22]: [count(t.`long_ip`#2581621L)#2193937L, collect_set(t.`application_id`#2581622, 0, 0)#2193941, collect_set(__auto_generated_subquery_name.`username`#2581623, 0, 0)#2193943, collect_set(t.`userAgent`#2581624, 0, 0)#2193945, first(t.`ip_address`#2581625)()#2193947, max(t.`attsdk_flag`#2581626)#2193949, sum(CAST(t.`attsdk_flag` AS BIGINT)#2581627L)#2193951L, max(u.`targeted_user_score`#2581628)#2193953, min(u.`targeted_user_score`#2581628)#2193955, percentile_approx(u.`targeted_user_score`#2581628, [0.5,0.75,0.9], 10000, 0, 0)#2193957, percentile_approx(__auto_generated_subquery_name.`cnt_5m`#2581629L, 0.5, 10000, 0, 0)#2193963L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`#2581630L, 0.5, 10000, 0, 0)#2193965L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`#2581631L, 0.5, 10000, 0, 0)#2193967L, percentile_approx(__auto_generated_subquery_name.`cnt_15m`#2581632L, 0.5, 10000, 0, 0)#2193969L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`#2581633L, 0.5, 10000, 0, 0)#2193971L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`#2581634L, 0.5, 10000, 0, 0)#2193973L, percentile_approx(__auto_generated_subquery_name.`cnt_60m`#2581635L, 0.5, 10000, 0, 0)#2193975L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`#2581636L, 0.5, 10000, 0, 0)#2193977L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`#2581637L, 0.5, 10000, 0, 0)#2193979L, percentile_approx(__auto_generated_subquery_name.`timedelta`#2581638L, 0.5, 10000, 0, 0)#2193981L, stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE)#2581639)#2193991, max(__auto_generated_subquery_name.`tguard_data_dt`#2581640)#2193993]", "Results": " [29]: [long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618, count(t.`long_ip`#2581621L)#2193937L AS count(t.`long_ip`)#2581641L, collect_set(t.`application_id`#2581622, 0, 0)#2193941 AS collect_set(t.`application_id`)#2581643, collect_set(__auto_generated_subquery_name.`username`#2581623, 0, 0)#2193943 AS collect_set(__auto_generated_subquery_name.`username`)#2581645, collect_set(t.`userAgent`#2581624, 0, 0)#2193945 AS collect_set(t.`userAgent`)#2581647, first(t.`ip_address`#2581625)()#2193947 AS first(t.`ip_address`)#2581649, max(t.`attsdk_flag`#2581626)#2193949 AS max(t.`attsdk_flag`)#2581651, sum(CAST(t.`attsdk_flag` AS BIGINT)#2581627L)#2193951L AS sum(CAST(t.`attsdk_flag` AS BIGINT))#2581653L, max(u.`targeted_user_score`#2581628)#2193953 AS max(u.`targeted_user_score`)#2581655, min(u.`targeted_user_score`#2581628)#2193955 AS min(u.`targeted_user_score`)#2581657, percentile_approx(u.`targeted_user_score`#2581628, [0.5,0.75,0.9], 10000, 0, 0)#2193957 AS percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581659, percentile_approx(u.`targeted_user_score`#2581628, [0.5,0.75,0.9], 10000, 0, 0)#2193957 AS percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581661, percentile_approx(u.`targeted_user_score`#2581628, [0.5,0.75,0.9], 10000, 0, 0)#2193957 AS percentile_approx(u.`targeted_user_score`, [0.5,0.75,0.9], 10000)#2581663, percentile_approx(__auto_generated_subquery_name.`cnt_5m`#2581629L, 0.5, 10000, 0, 0)#2193963L AS percentile_approx(__auto_generated_subquery_name.`cnt_5m`, 0.5D, 10000)#2581665L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`#2581630L, 0.5, 10000, 0, 0)#2193965L AS percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`, 0.5D, 10000)#2581667L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`#2581631L, 0.5, 10000, 0, 0)#2193967L AS percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`, 0.5D, 10000)#2581669L, percentile_approx(__auto_generated_subquery_name.`cnt_15m`#2581632L, 0.5, 10000, 0, 0)#2193969L AS percentile_approx(__auto_generated_subquery_name.`cnt_15m`, 0.5D, 10000)#2581671L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`#2581633L, 0.5, 10000, 0, 0)#2193971L AS percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`, 0.5D, 10000)#2581673L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`#2581634L, 0.5, 10000, 0, 0)#2193973L AS percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`, 0.5D, 10000)#2581675L, percentile_approx(__auto_generated_subquery_name.`cnt_60m`#2581635L, 0.5, 10000, 0, 0)#2193975L AS percentile_approx(__auto_generated_subquery_name.`cnt_60m`, 0.5D, 10000)#2581677L, percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`#2581636L, 0.5, 10000, 0, 0)#2193977L AS percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`, 0.5D, 10000)#2581679L, percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`#2581637L, 0.5, 10000, 0, 0)#2193979L AS percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`, 0.5D, 10000)#2581681L, percentile_approx(__auto_generated_subquery_name.`timedelta`#2581638L, 0.5, 10000, 0, 0)#2193981L AS percentile_approx(__auto_generated_subquery_name.`timedelta`, 0.5D, 10000)#2581683L, stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE)#2581639)#2193991 AS stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE))#2581693, max(__auto_generated_subquery_name.`tguard_data_dt`#2581640)#2193993 AS max(__auto_generated_subquery_name.`tguard_data_dt`)#2581695]"}, "full_label": "ObjectHashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27"], "size": 58, "equiv": "0"}, "29": {"label": "Exchange", "notes": "", "children": [30], "parent": [28], "node_id": "(45) Exchange", "lineno": 4666, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [30]: [long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618, count#2581896L, buf#2581898, buf#2581900, buf#2581902, first#2581905, valueSet#2581906, max#2581908, sum#2581910L, max#2581912, min#2581914, buf#2581916, buf#2581918, buf#2581920, buf#2581922, buf#2581924, buf#2581926, buf#2581928, buf#2581930, buf#2581932, buf#2581934, buf#2581936, n#2581690, avg#2581691, m2#2581692, max#2581938]", "Arguments:": " hashpartitioning(long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618, 1000), ENSURE_REQUIREMENTS, [id=#1668865]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28"], "size": 57, "equiv": "0"}, "30": {"label": "ObjectHashAggregate", "notes": "", "children": [31], "parent": [29], "node_id": "(44) ObjectHashAggregate", "lineno": 4667, "detail": {"note": "ObjectHashAggregate", "lineno": 5461, "Input": " [25]: [long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618, t.`long_ip`#2581621L, t.`application_id`#2581622, __auto_generated_subquery_name.`username`#2581623, t.`userAgent`#2581624, t.`ip_address`#2581625, t.`attsdk_flag`#2581626, CAST(t.`attsdk_flag` AS BIGINT)#2581627L, u.`targeted_user_score`#2581628, __auto_generated_subquery_name.`cnt_5m`#2581629L, __auto_generated_subquery_name.`cntDistUser_5m`#2581630L, __auto_generated_subquery_name.`cntDistApp_5m`#2581631L, __auto_generated_subquery_name.`cnt_15m`#2581632L, __auto_generated_subquery_name.`cntDistUser_15m`#2581633L, __auto_generated_subquery_name.`cntDistApp_15m`#2581634L, __auto_generated_subquery_name.`cnt_60m`#2581635L, __auto_generated_subquery_name.`cntDistUser_60m`#2581636L, __auto_generated_subquery_name.`cntDistApp_60m`#2581637L, __auto_generated_subquery_name.`timedelta`#2581638L, CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE)#2581639, __auto_generated_subquery_name.`tguard_data_dt`#2581640]", "Keys": " [5]: [long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618]", "Functions": " [22]: [partial_count(t.`long_ip`#2581621L) AS count#2581896L, partial_collect_set(t.`application_id`#2581622, 0, 0) AS buf#2581898, partial_collect_set(__auto_generated_subquery_name.`username`#2581623, 0, 0) AS buf#2581900, partial_collect_set(t.`userAgent`#2581624, 0, 0) AS buf#2581902, partial_first(t.`ip_address`#2581625, false) AS (first#2581905, valueSet#2581906), partial_max(t.`attsdk_flag`#2581626) AS max#2581908, partial_sum(CAST(t.`attsdk_flag` AS BIGINT)#2581627L) AS sum#2581910L, partial_max(u.`targeted_user_score`#2581628) AS max#2581912, partial_min(u.`targeted_user_score`#2581628) AS min#2581914, partial_percentile_approx(u.`targeted_user_score`#2581628, [0.5,0.75,0.9], 10000, 0, 0) AS buf#2581916, partial_percentile_approx(__auto_generated_subquery_name.`cnt_5m`#2581629L, 0.5, 10000, 0, 0) AS buf#2581918, partial_percentile_approx(__auto_generated_subquery_name.`cntDistUser_5m`#2581630L, 0.5, 10000, 0, 0) AS buf#2581920, partial_percentile_approx(__auto_generated_subquery_name.`cntDistApp_5m`#2581631L, 0.5, 10000, 0, 0) AS buf#2581922, partial_percentile_approx(__auto_generated_subquery_name.`cnt_15m`#2581632L, 0.5, 10000, 0, 0) AS buf#2581924, partial_percentile_approx(__auto_generated_subquery_name.`cntDistUser_15m`#2581633L, 0.5, 10000, 0, 0) AS buf#2581926, partial_percentile_approx(__auto_generated_subquery_name.`cntDistApp_15m`#2581634L, 0.5, 10000, 0, 0) AS buf#2581928, partial_percentile_approx(__auto_generated_subquery_name.`cnt_60m`#2581635L, 0.5, 10000, 0, 0) AS buf#2581930, partial_percentile_approx(__auto_generated_subquery_name.`cntDistUser_60m`#2581636L, 0.5, 10000, 0, 0) AS buf#2581932, partial_percentile_approx(__auto_generated_subquery_name.`cntDistApp_60m`#2581637L, 0.5, 10000, 0, 0) AS buf#2581934, partial_percentile_approx(__auto_generated_subquery_name.`timedelta`#2581638L, 0.5, 10000, 0, 0) AS buf#2581936, partial_stddev_samp(CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE)#2581639) AS (n#2581690, avg#2581691, m2#2581692), partial_max(__auto_generated_subquery_name.`tguard_data_dt`#2581640) AS max#2581938]", "Aggregate": " Attributes [25]: [count#2581895L, buf#2581897, buf#2581899, buf#2581901, first#2581903, valueSet#2581904, max#2581907, sum#2581909L, max#2581911, min#2581913, buf#2581915, buf#2581917, buf#2581919, buf#2581921, buf#2581923, buf#2581925, buf#2581927, buf#2581929, buf#2581931, buf#2581933, buf#2581935, n#2581685, avg#2581686, m2#2581687, max#2581937]", "Results": " [30]: [long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618, count#2581896L, buf#2581898, buf#2581900, buf#2581902, first#2581905, valueSet#2581906, max#2581908, sum#2581910L, max#2581912, min#2581914, buf#2581916, buf#2581918, buf#2581920, buf#2581922, buf#2581924, buf#2581926, buf#2581928, buf#2581930, buf#2581932, buf#2581934, buf#2581936, n#2581690, avg#2581691, m2#2581692, max#2581938]"}, "full_label": "ObjectHashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29"], "size": 56, "equiv": "0"}, "31": {"label": "Expand", "notes": "", "children": [32], "parent": [30], "node_id": "(43) Expand", "lineno": 4668, "detail": {"note": "Expand", "lineno": 5461, "Input": " [19]: [window#2194005, ip_address#2172241, long_ip#2192570L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, cnt_5m#2192558L, cnt_15m#2192559L, cnt_60m#2192560L, cntDistUser_5m#2192561L, cntDistUser_15m#2192562L, cntDistUser_60m#2192563L, cntDistApp_5m#2192564L, cntDistApp_15m#2192565L, cntDistApp_60m#2192566L, timedelta#2192567L, tguard_data_dt#2192568, targeted_user_score#2192555]", "Arguments:": " [ArrayBuffer(long_ip#2192570L, window#2194005, null, null, 0, long_ip#2192570L, application_id#2172243, username#2192593, userAgent#2172171, ip_address#2172241, attsdk_flag#2172246, cast(attsdk_flag#2172246 as bigint), targeted_user_score#2192555, cnt_5m#2192558L, cntDistUser_5m#2192561L, cntDistApp_5m#2192564L, cnt_15m#2192559L, cntDistUser_15m#2192562L, cntDistApp_15m#2192565L, cnt_60m#2192560L, cntDistUser_60m#2192563L, cntDistApp_60m#2192566L, timedelta#2192567L, cast(timedelta#2192567L as double), tguard_data_dt#2192568), ArrayBuffer(long_ip#2192570L, window#2194005, username#2192593, null, 1, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null), ArrayBuffer(long_ip#2192570L, window#2194005, null, application_id#2172243, 2, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null)], [long_ip#2192570L, window#2194005, __auto_generated_subquery_name.`username`#2581619, t.`application_id`#2581620, gid#2581618, t.`long_ip`#2581621L, t.`application_id`#2581622, __auto_generated_subquery_name.`username`#2581623, t.`userAgent`#2581624, t.`ip_address`#2581625, t.`attsdk_flag`#2581626, CAST(t.`attsdk_flag` AS BIGINT)#2581627L, u.`targeted_user_score`#2581628, __auto_generated_subquery_name.`cnt_5m`#2581629L, __auto_generated_subquery_name.`cntDistUser_5m`#2581630L, __auto_generated_subquery_name.`cntDistApp_5m`#2581631L, __auto_generated_subquery_name.`cnt_15m`#2581632L, __auto_generated_subquery_name.`cntDistUser_15m`#2581633L, __auto_generated_subquery_name.`cntDistApp_15m`#2581634L, __auto_generated_subquery_name.`cnt_60m`#2581635L, __auto_generated_subquery_name.`cntDistUser_60m`#2581636L, __auto_generated_subquery_name.`cntDistApp_60m`#2581637L, __auto_generated_subquery_name.`timedelta`#2581638L, CAST(__auto_generated_subquery_name.`timedelta` AS DOUBLE)#2581639, __auto_generated_subquery_name.`tguard_data_dt`#2581640]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30"], "size": 55, "equiv": "0"}, "32": {"label": "Project", "notes": "", "children": [33], "parent": [31], "node_id": "(42) Project", "lineno": 4669, "detail": {"note": "Project", "lineno": 5461, "Output": " [19]: [named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 1) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 1) * 300000000) + 300000000), LongType, TimestampType)) AS window#2194005, ip_address#2172241, long_ip#2192570L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, cnt_5m#2192558L, cnt_15m#2192559L, cnt_60m#2192560L, cntDistUser_5m#2192561L, cntDistUser_15m#2192562L, cntDistUser_60m#2192563L, cntDistApp_5m#2192564L, cntDistApp_15m#2192565L, cntDistApp_60m#2192566L, timedelta#2192567L, tguard_data_dt#2192568, targeted_user_score#2192555]", "Input": " [20]: [ip_address#2172241, long_ip#2192570L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, transaction_date_time#2172247, cnt_5m#2192558L, cnt_15m#2192559L, cnt_60m#2192560L, cntDistUser_5m#2192561L, cntDistUser_15m#2192562L, cntDistUser_60m#2192563L, cntDistApp_5m#2192564L, cntDistApp_15m#2192565L, cntDistApp_60m#2192566L, timedelta#2192567L, tguard_data_dt#2192568, targeted_user_score#2192555, un#2192556]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31"], "size": 54, "equiv": "0"}, "33": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [34, 81], "parent": [32], "node_id": "(41) SortMergeJoin", "lineno": 4670, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [username#2192593]", "Right": " keys [1]: [un#2192556]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32"], "size": 53, "equiv": "0"}, "34": {"label": "Sort", "notes": "", "children": [35], "parent": [33], "node_id": "(35) Sort", "lineno": 4671, "detail": {"note": "Sort", "lineno": 5461, "Input": " [18]: [ip_address#2172241, long_ip#2192570L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, transaction_date_time#2172247, cnt_5m#2192558L, cnt_15m#2192559L, cnt_60m#2192560L, cntDistUser_5m#2192561L, cntDistUser_15m#2192562L, cntDistUser_60m#2192563L, cntDistApp_5m#2192564L, cntDistApp_15m#2192565L, cntDistApp_60m#2192566L, timedelta#2192567L, tguard_data_dt#2192568]", "Arguments:": " [username#2192593 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33"], "size": 47, "equiv": "0"}, "35": {"label": "Exchange", "notes": "", "children": [36], "parent": [34], "node_id": "(34) Exchange", "lineno": 4672, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [18]: [ip_address#2172241, long_ip#2192570L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, transaction_date_time#2172247, cnt_5m#2192558L, cnt_15m#2192559L, cnt_60m#2192560L, cntDistUser_5m#2192561L, cntDistUser_15m#2192562L, cntDistUser_60m#2192563L, cntDistApp_5m#2192564L, cntDistApp_15m#2192565L, cntDistApp_60m#2192566L, timedelta#2192567L, tguard_data_dt#2192568]", "Arguments:": " hashpartitioning(username#2192593, 1000), ENSURE_REQUIREMENTS, [id=#1668856]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34"], "size": 46, "equiv": "0"}, "36": {"label": "Project", "notes": "", "children": [37], "parent": [35], "node_id": "(33) Project", "lineno": 4673, "detail": {"note": "Project", "lineno": 5461, "Output": " [18]: [ip_address#2172241, long_ip#2192590L AS long_ip#2192570L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, transaction_date_time#2172247, cnt_5m#2192558L, cnt_15m#2192559L, cnt_60m#2192560L, cntDistUser_5m#2192561L, cntDistUser_15m#2192562L, cntDistUser_60m#2192563L, cntDistApp_5m#2192564L, cntDistApp_15m#2192565L, cntDistApp_60m#2192566L, timedelta#2192567L, tguard_data_dt#2192568]", "Input": " [18]: [ip_address#2172241, long_ip#2192590L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, transaction_date_time#2172247, cnt_5m#2192558L, cnt_15m#2192559L, cnt_60m#2192560L, cntDistUser_5m#2192561L, cntDistUser_15m#2192562L, cntDistUser_60m#2192563L, cntDistApp_5m#2192564L, cntDistApp_15m#2192565L, cntDistApp_60m#2192566L, timedelta#2192567L, tguard_data_dt#2192568]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35"], "size": 45, "equiv": "0"}, "37": {"label": "Filter", "notes": "", "children": [38], "parent": [36], "node_id": "(32) Filter", "lineno": 4674, "detail": {"note": "Filter", "lineno": 5461, "Input": " [18]: [ip_address#2172241, long_ip#2192590L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, transaction_date_time#2172247, cnt_5m#2192558L, cnt_15m#2192559L, cnt_60m#2192560L, cntDistUser_5m#2192561L, cntDistUser_15m#2192562L, cntDistUser_60m#2192563L, cntDistApp_5m#2192564L, cntDistApp_15m#2192565L, cntDistApp_60m#2192566L, timedelta#2192567L, tguard_data_dt#2192568]", "Condition": " : isnotnull(transaction_date_time#2172247)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36"], "size": 44, "equiv": "0"}, "38": {"label": "Window", "notes": "", "children": [39], "parent": [37], "node_id": "(31) Window", "lineno": 4675, "detail": {"note": "Window", "lineno": 5461, "Input": " [9]: [ip_address#2172241, long_ip#2192590L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, transaction_date_time#2172247, timedelta#2172258L, data_dt#2172101]", "Arguments:": " [ip_address#2172241, long_ip#2192590L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, transaction_date_time#2172247, count(1) windowspecdefinition(long_ip#2192590L, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, -5 minutes, currentrow$())) AS cnt_5m#2192558L, count(1) windowspecdefinition(long_ip#2192590L, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, -15 minutes, currentrow$())) AS cnt_15m#2192559L, count(1) windowspecdefinition(long_ip#2192590L, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, -1 hours, currentrow$())) AS cnt_60m#2192560L, approx_count_distinct(username#2192593, 0.05, 0, 0) windowspecdefinition(long_ip#2192590L, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, -5 minutes, currentrow$())) AS cntDistUser_5m#2192561L, approx_count_distinct(username#2192593, 0.05, 0, 0) windowspecdefinition(long_ip#2192590L, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, -15 minutes, currentrow$())) AS cntDistUser_15m#2192562L, approx_count_distinct(username#2192593, 0.05, 0, 0) windowspecdefinition(long_ip#2192590L, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, -1 hours, currentrow$())) AS cntDistUser_60m#2192563L, approx_count_distinct(application_id#2172243, 0.05, 0, 0) windowspecdefinition(long_ip#2192590L, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, -5 minutes, currentrow$())) AS cntDistApp_5m#2192564L, approx_count_distinct(application_id#2172243, 0.05, 0, 0) windowspecdefinition(long_ip#2192590L, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, -15 minutes, currentrow$())) AS cntDistApp_15m#2192565L, approx_count_distinct(application_id#2172243, 0.05, 0, 0) windowspecdefinition(long_ip#2192590L, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RangeFrame, -1 hours, currentrow$())) AS cntDistApp_60m#2192566L, coalesce(timedelta#2172258L, 12000) AS timedelta#2192567L, data_dt#2172101 AS tguard_data_dt#2192568], [long_ip#2192590L], [transaction_date_time#2172247 ASC NULLS FIRST]"}, "full_label": "Window", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37"], "size": 43, "equiv": "0"}, "39": {"label": "Sort", "notes": "", "children": [40], "parent": [38], "node_id": "(30) Sort", "lineno": 4676, "detail": {"note": "Sort", "lineno": 5461, "Input": " [9]: [ip_address#2172241, long_ip#2192590L, attsdk_flag#2172246, username#2192593, userAgent#2172171, application_id#2172243, transaction_date_time#2172247, timedelta#2172258L, data_dt#2172101]", "Arguments:": " [long_ip#2192590L ASC NULLS FIRST, transaction_date_time#2172247 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38"], "size": 42, "equiv": "0"}, "40": {"label": "Project", "notes": "", "children": [41], "parent": [39], "node_id": "(29) Project", "lineno": 4677, "detail": {"note": "Project", "lineno": 5461, "Output": " [9]: [ip_address#2172241, long_ip#2172242L AS long_ip#2192590L, attsdk_flag#2172246, userName#2172244 AS username#2192593, userAgent#2172171, application_id#2172243, transaction_date_time#2172247, timedelta#2172258L, data_dt#2172101]", "Input": " [11]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L, exploded_ip#2174776L, ip_whitelist_flg#2192601]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39"], "size": 41, "equiv": "0"}, "41": {"label": "Filter", "notes": "", "children": [42], "parent": [40], "node_id": "(28) Filter", "lineno": 4678, "detail": {"note": "Filter", "lineno": 5461, "Input": " [11]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L, exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Condition": " : isnull(ip_whitelist_flg#2192601)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40"], "size": 40, "equiv": "0"}, "42": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [43, 76], "parent": [41], "node_id": "(27) SortMergeJoin", "lineno": 4679, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41"], "size": 39, "equiv": "0"}, "43": {"label": "Sort", "notes": "", "children": [44], "parent": [42], "node_id": "(21) Sort", "lineno": 4680, "detail": {"note": "Sort", "lineno": 5461, "Input": " [9]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42"], "size": 33, "equiv": "0"}, "44": {"label": "Exchange", "notes": "", "children": [45], "parent": [43], "node_id": "(20) Exchange", "lineno": 4681, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [9]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1668842]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43"], "size": 32, "equiv": "0"}, "45": {"label": "BroadcastHashJoin LeftAnti BuildRight", "notes": "", "children": [46, 58], "parent": [44], "node_id": "(19) BroadcastHashJoin", "lineno": 4682, "detail": {"note": "BroadcastHashJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2192616]", "Join": " condition: None"}, "full_label": "BroadcastHashJoin LeftAnti BuildRight", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44"], "size": 31, "equiv": "0"}, "46": {"label": "InMemoryTableScan", "notes": "", "children": [47], "parent": [45], "node_id": "(1) InMemoryTableScan", "lineno": 4683, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [9]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45"], "size": 12, "equiv": "0"}, "47": {"label": "InMemoryRelation", "notes": "", "children": [48], "parent": [46], "node_id": "(2) InMemoryRelation", "lineno": 4684, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46"], "size": 11, "equiv": "0"}, "48": {"label": "* Filter", "notes": "", "children": [49], "parent": [47, 70, 115, 128, 173, 186, 229, 242, 280, 293, 339, 352, 393, 406, 452, 465, 506, 519, 549, 562, 585, 598], "node_id": "(12) Filter", "lineno": 4685, "detail": {"note": "Filter [codegen id : 3]", "lineno": 5461, "Input": " [10]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L]", "Condition": " : (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))"}, "full_label": "* Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47"], "size": 10, "equiv": "0"}, "49": {"label": "Window", "notes": "", "children": [50], "parent": [48], "node_id": "(11) Window", "lineno": 4686, "detail": {"note": "Window", "lineno": 5461, "Input": " [11]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, transaction_date_time#2172247, ip_address#2172241]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]"}, "full_label": "Window", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48"], "size": 9, "equiv": "0"}, "50": {"label": "Sort", "notes": "", "children": [51], "parent": [49], "node_id": "(10) Sort", "lineno": 4687, "detail": {"note": "Sort", "lineno": 5461, "Input": " [11]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, transaction_date_time#2172247, ip_address#2172241]", "Arguments:": " [ip_address#2172241 ASC NULLS FIRST, transaction_date_time#2172247 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49"], "size": 8, "equiv": "0"}, "51": {"label": "Exchange", "notes": "", "children": [52], "parent": [50], "node_id": "(9) Exchange", "lineno": 4688, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [11]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, transaction_date_time#2172247, ip_address#2172241]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1562062]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50"], "size": 7, "equiv": "0"}, "52": {"label": "* Project", "notes": "", "children": [53], "parent": [51], "node_id": "(8) Project", "lineno": 4689, "detail": {"note": "Project [codegen id : 2]", "lineno": 5461, "Output": " [11]: [jsonData#2172113.sourceIp AS ip_address#2172241, pythonUDF0#2172608L AS long_ip#2172242L, jsonData#2172113.appName AS application_id#2172243, jsonData#2172113.userAgent AS userAgent#2172171, jsonData#2172113.userName AS userName#2172244, CASE WHEN (trim(upper(jsonData#2172113.finalAuthStateCategory), None) = SUCCESSFUL) THEN SUCCESS WHEN (trim(upper(jsonData#2172113.finalAuthStateCategory), None) = UNCATEGORIZED) THEN FAILED ELSE FAILED END AS status#2172245, CASE WHEN (NOT StartsWith(upper(jsonData#2172113.userAgent), MYATTTHIN) AND (jsonData#2172113.appName = O5FoY1UsNnqOAb4ShkIIlZbfqkU=)) THEN 1 ELSE 0 END AS attsdk_flag#2172246, cast(jsonData#2172113.startTime as timestamp) AS transaction_date_time#2172247, data_dt#2172101, cast(jsonData#2172113.startTime as timestamp) AS transaction_date_time#2172247, jsonData#2172113.sourceIp AS ip_address#2172241]", "Input": " [3]: [data_dt#2172101, jsonData#2172113, pythonUDF0#2172608L]"}, "full_label": "* Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51"], "size": 6, "equiv": "0"}, "53": {"label": "BatchEvalPython", "notes": "", "children": [54], "parent": [52], "node_id": "(7) BatchEvalPython", "lineno": 4690, "detail": {"note": "BatchEvalPython", "lineno": 5461, "Input": " [2]: [data_dt#2172101, jsonData#2172113]", "Arguments:": " [Convert_To_Long(jsonData#2172113.sourceIp)], [pythonUDF0#2172608L]"}, "full_label": "BatchEvalPython", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52"], "size": 5, "equiv": "0"}, "54": {"label": "Project", "notes": "", "children": [55], "parent": [53], "node_id": "(6) Project", "lineno": 4691, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [data_dt#2172101, from_json(StructField(amr,StringType,true), StructField(amrs,ArrayType(StringType,true),true), StructField(appName,StringType,true), StructField(appsInTrxn,ArrayType(StringType,true),true), StructField(ctnAttempt,BooleanType,true), StructField(distinctUserCount,LongType,true), StructField(duration,LongType,true), StructField(eap,BooleanType,true), StructField(eapEventId,StringType,true), StructField(endTime,StringType,true), StructField(finalAuthStateCategory,StringType,true), StructField(finalAuthStateReason,StructType(StructField(sourceType,StringType,true), StructField(plugin,StringType,true), StructField(eventId,StringType,true), StructField(category,StringType,true), StructField(errCode,StringType,true)),true), StructField(fraudBlocked,BooleanType,true), StructField(fraudBlockedAttempts,LongType,true), StructField(fraudBlockedCategory,StringType,true), StructField(fraudBlockedReason,StringType,true), StructField(hasPlugin,BooleanType,true), StructField(hasTomcat,BooleanType,true), StructField(host,StringType,true), StructField(isTest,BooleanType,true), StructField(namesInTrxn,ArrayType(StringType,true),true), StructField(numEvents,LongType,true), StructField(otp,LongType,true), StructField(otpReason,StringType,true), ... 35 more fields) AS jsonData#2172113]", "Input": " [2]: [body_str#2172100, data_dt#2172101]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53"], "size": 4, "equiv": "0"}, "55": {"label": "Filter", "notes": "", "children": [56], "parent": [54], "node_id": "(5) Filter", "lineno": 4692, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [body_str#2172100, data_dt#2172101]", "Condition": " : (((((isnotnull(body_str#2172100) AND isnotnull(from_json(StructField(sourceIp,StringType,true), body_str#2172100, Some(Etc/UTC)).sourceIp)) AND (length(from_json(StructField(sourceIp,StringType,true), body_str#2172100, Some(Etc/UTC)).sourceIp) >= 7)) AND (length(from_json(StructField(sourceIp,StringType,true), body_str#2172100, Some(Etc/UTC)).sourceIp) <= 15)) AND (size(split(from_json(StructField(sourceIp,StringType,true), body_str#2172100, Some(Etc/UTC)).sourceIp, [.], -1), true) = 4)) AND NOT (length(split(from_json(StructField(sourceIp,StringType,true), body_str#2172100, Some(Etc/UTC)).sourceIp, [.], -1)[3]) = 0))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", "54"], "size": 3, "equiv": "0"}, "56": {"label": "* ColumnarToRow", "notes": "", "children": [57], "parent": [55], "node_id": "(4) ColumnarToRow", "lineno": 4693, "detail": {"note": "ColumnarToRow [codegen id : 1]", "lineno": 5461, "Input": " [2]: [body_str#2172100, data_dt#2172101]"}, "full_label": "* ColumnarToRow", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", "54", "55"], "size": 2, "equiv": "0"}, "57": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [56], "node_id": "(3) Scan", "lineno": 4694, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [2]: [body_str#2172100, data_dt#2172101]", "Batched:": " true", "Location:": " PreparedDeltaFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_stream_1min_flink/data]", "PartitionFilters:": " [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)]", "PushedFilters:": " [IsNotNull(body_str)]", "ReadSchema:": " struct<body_str:string>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "46", "47", "48", "49", "50", "51", "52", "53", "54", "55", "56"], "size": 1, "equiv": "0"}, "58": {"label": "BroadcastExchange", "notes": "", "children": [59], "parent": [45], "node_id": "(18) BroadcastExchange", "lineno": 4695, "detail": {"note": "BroadcastExchange", "lineno": 5461, "Input": " [1]: [ip_address#2192616]", "Arguments:": " HashedRelationBroadcastMode(List(input[0, string, true]),true), [id=#1668838]"}, "full_label": "BroadcastExchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45"], "size": 18, "equiv": "1"}, "59": {"label": "Project", "notes": "", "children": [60], "parent": [58], "node_id": "(17) Project", "lineno": 4696, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2192616]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58"], "size": 17, "equiv": "2"}, "60": {"label": "Filter", "notes": "", "children": [61], "parent": [59], "node_id": "(16) Filter", "lineno": 4697, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]", "Condition": " : (ip_trans_cnt#2192615L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59"], "size": 16, "equiv": "0"}, "61": {"label": "HashAggregate", "notes": "", "children": [62], "parent": [60], "node_id": "(15) HashAggregate", "lineno": 4698, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210409L) AS count(1)#2192632L]", "Aggregate": " Attributes [1]: [count(1)#2192632L]", "Results": " [2]: [ip_address#2172241, count(1)#2192632L AS ip_trans_cnt#2192615L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60"], "size": 15, "equiv": "0"}, "62": {"label": "Exchange", "notes": "", "children": [63], "parent": [61], "node_id": "(14) Exchange", "lineno": 4699, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1668833]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61"], "size": 14, "equiv": "0"}, "63": {"label": "HashAggregate", "notes": "", "children": [64], "parent": [62], "node_id": "(13) HashAggregate", "lineno": 4700, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210409L]", "Aggregate": " Attributes [1]: [count#2210408L]", "Results": " [2]: [ip_address#2172241, count#2210409L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62"], "size": 13, "equiv": "0"}, "64": {"label": "Project", "notes": "", "children": [65], "parent": [63], "node_id": "(12) Project", "lineno": 4701, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63"], "size": 12, "equiv": "0"}, "65": {"label": "Filter", "notes": "", "children": [66], "parent": [64], "node_id": "(11) Filter", "lineno": 4702, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Condition": " : isnull(ip_whitelist_flg#2192618)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64"], "size": 11, "equiv": "0"}, "66": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [67, 71], "parent": [65], "node_id": "(10) SortMergeJoin", "lineno": 4703, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64", "65"], "size": 10, "equiv": "0"}, "67": {"label": "Sort", "notes": "", "children": [68], "parent": [66], "node_id": "(4) Sort", "lineno": 4704, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64", "65", "66"], "size": 4, "equiv": "0"}, "68": {"label": "Exchange", "notes": "", "children": [69], "parent": [67], "node_id": "(3) Exchange", "lineno": 4705, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1668824]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64", "65", "66", "67"], "size": 3, "equiv": "0"}, "69": {"label": "InMemoryTableScan", "notes": "", "children": [70], "parent": [68], "node_id": "(2) InMemoryTableScan", "lineno": 4706, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64", "65", "66", "67", "68"], "size": 2, "equiv": "3"}, "70": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [69], "node_id": "(3) InMemoryRelation", "lineno": 4707, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64", "65", "66", "67", "68", "69"], "size": 1, "equiv": "0"}, "71": {"label": "Sort", "notes": "", "children": [72], "parent": [66], "node_id": "(9) Sort", "lineno": 4718, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64", "65", "66"], "size": 5, "equiv": "4"}, "72": {"label": "Exchange", "notes": "", "children": [73], "parent": [71], "node_id": "(8) Exchange", "lineno": 4719, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1668825]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64", "65", "66", "71"], "size": 4, "equiv": "0"}, "73": {"label": "Project", "notes": "", "children": [74], "parent": [72], "node_id": "(7) Project", "lineno": 4720, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192618]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64", "65", "66", "71", "72"], "size": 3, "equiv": "0"}, "74": {"label": "Filter", "notes": "", "children": [75], "parent": [73], "node_id": "(6) Filter", "lineno": 4721, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64", "65", "66", "71", "72", "73"], "size": 2, "equiv": "0"}, "75": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [74], "node_id": "(5) Scan", "lineno": 4722, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "43", "44", "45", "58", "59", "60", "61", "62", "63", "64", "65", "66", "71", "72", "73", "74"], "size": 1, "equiv": "0"}, "76": {"label": "Sort", "notes": "", "children": [77], "parent": [42], "node_id": "(26) Sort", "lineno": 4723, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42"], "size": 5, "equiv": "4"}, "77": {"label": "Exchange", "notes": "", "children": [78], "parent": [76], "node_id": "(25) Exchange", "lineno": 4724, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1668843]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "76"], "size": 4, "equiv": "0"}, "78": {"label": "Project", "notes": "", "children": [79], "parent": [77], "node_id": "(24) Project", "lineno": 4725, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192601]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "76", "77"], "size": 3, "equiv": "0"}, "79": {"label": "Filter", "notes": "", "children": [80], "parent": [78], "node_id": "(23) Filter", "lineno": 4726, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "76", "77", "78"], "size": 2, "equiv": "0"}, "80": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [79], "node_id": "(22) Scan", "lineno": 4727, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40", "41", "42", "76", "77", "78", "79"], "size": 1, "equiv": "0"}, "81": {"label": "Sort", "notes": "", "children": [82], "parent": [33], "node_id": "(40) Sort", "lineno": 4728, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [targeted_user_score#2192555, un#2192556]", "Arguments:": " [un#2192556 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33"], "size": 5, "equiv": "4"}, "82": {"label": "Exchange", "notes": "", "children": [83], "parent": [81], "node_id": "(39) Exchange", "lineno": 4729, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [targeted_user_score#2192555, un#2192556]", "Arguments:": " hashpartitioning(un#2192556, 1000), ENSURE_REQUIREMENTS, [id=#1668857]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "81"], "size": 4, "equiv": "0"}, "83": {"label": "Project", "notes": "", "children": [84], "parent": [82], "node_id": "(38) Project", "lineno": 4730, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [userName_dist_flag#2175090 AS targeted_user_score#2192555, userName#2175089 AS un#2192556]", "Input": " [3]: [userName#2175089, userName_dist_flag#2175090, data_dt#2175091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "81", "82"], "size": 3, "equiv": "0"}, "84": {"label": "Filter", "notes": "", "children": [85], "parent": [83], "node_id": "(37) Filter", "lineno": 4731, "detail": {"note": "Filter", "lineno": 5461, "Input": " [3]: [userName#2175089, userName_dist_flag#2175090, data_dt#2175091]", "Condition": " : isnotnull(userName#2175089)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "81", "82", "83"], "size": 2, "equiv": "0"}, "85": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [84], "node_id": "(36) Scan", "lineno": 4732, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [3]: [userName#2175089, userName_dist_flag#2175090, data_dt#2175091]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/usr_distip_cnt_map]", "PartitionFilters:": " [isnotnull(data_dt#2175091), (data_dt#2175091 = 2022080317)]", "PushedFilters:": " [IsNotNull(userName)]", "ReadSchema:": " struct<userName:string,userName_dist_flag:int>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "81", "82", "83", "84"], "size": 1, "equiv": "0"}, "86": {"label": "Sort", "notes": "", "children": [87], "parent": [19], "node_id": "(110) Sort", "lineno": 4733, "detail": {"note": "Sort", "lineno": 5461, "Input": " [8]: [long_ip#2192590L, _gen_alias_2581297#2581297, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091]", "Arguments:": " [long_ip#2192590L ASC NULLS FIRST, _gen_alias_2581297#2581297 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19"], "size": 58, "equiv": "5"}, "87": {"label": "Exchange", "notes": "", "children": [88], "parent": [86], "node_id": "(109) Exchange", "lineno": 4734, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [8]: [long_ip#2192590L, _gen_alias_2581297#2581297, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091]", "Arguments:": " hashpartitioning(long_ip#2192590L, _gen_alias_2581297#2581297, 1000), ENSURE_REQUIREMENTS, [id=#1668930]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86"], "size": 57, "equiv": "0"}, "88": {"label": "Project", "notes": "", "children": [89], "parent": [87], "node_id": "(108) Project", "lineno": 4735, "detail": {"note": "Project", "lineno": 5461, "Output": " [8]: [long_ip#2192590L, window#2194102.end AS _gen_alias_2581297#2581297, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091]", "Input": " [8]: [long_ip#2192590L, window#2194102, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87"], "size": 56, "equiv": "0"}, "89": {"label": "Filter", "notes": "", "children": [90], "parent": [88], "node_id": "(107) Filter", "lineno": 4736, "detail": {"note": "Filter", "lineno": 5461, "Input": " [8]: [long_ip#2192590L, window#2194102, cnt_attempts_ip_15m#2194073L, cnt_dist_usr_15m#2194074L, cnt_dist_app_15m#2194075L, app_id_set_15m#2194077, 50th_timedelta_15m#2194081L, stddev_timedelta_15m#2194091]", "Condition": " : (isnotnull(long_ip#2192590L) AND isnotnull(window#2194102.end))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88"], "size": 55, "equiv": "0"}, "90": {"label": "SortAggregate", "notes": "", "children": [91], "parent": [89], "node_id": "(106) SortAggregate", "lineno": 4737, "detail": {"note": "SortAggregate", "lineno": 5461, "Input": " [12]: [long_ip#2192590L, window#2194102, first#2581941L, valueSet#2581942, count#2581944L, count#2581946L, first#2581949, valueSet#2581950, first#2581953L, valueSet#2581954, first#2581957, valueSet#2581958]", "Keys": " [2]: [long_ip#2192590L, window#2194102]", "Functions": " [6]: [finalmerge_first(merge first#2581941L, valueSet#2581942) AS first(if ((gid#2581705 = 0)) count(__auto_generated_subquery_name.`long_ip`)#2581712L else null) ignore nulls#2581713L, finalmerge_count(merge count#2581944L) AS count(if ((gid#2581705 = 1)) __auto_generated_subquery_name.`username`#2581706 else null)#2194100L, finalmerge_count(merge count#2581946L) AS count(if ((gid#2581705 = 2)) t.`application_id`#2581707 else null)#2194101L, finalmerge_first(merge first#2581949, valueSet#2581950) AS first(if ((gid#2581705 = 0)) collect_set(t.`application_id`)#2581714 else null) ignore nulls#2581715, finalmerge_first(merge first#2581953L, valueSet#2581954) AS first(if ((gid#2581705 = 0)) percentile_approx(t.`timedelta`, 0.5D, 10000)#2581716L else null) ignore nulls#2581717L, finalmerge_first(merge first#2581957, valueSet#2581958) AS first(if ((gid#2581705 = 0)) stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581726 else null) ignore nulls#2581727]", "Aggregate": " Attributes [6]: [first(if ((gid#2581705 = 0)) count(__auto_generated_subquery_name.`long_ip`)#2581712L else null) ignore nulls#2581713L, count(if ((gid#2581705 = 1)) __auto_generated_subquery_name.`username`#2581706 else null)#2194100L, count(if ((gid#2581705 = 2)) t.`application_id`#2581707 else null)#2194101L, first(if ((gid#2581705 = 0)) collect_set(t.`application_id`)#2581714 else null) ignore nulls#2581715, first(if ((gid#2581705 = 0)) percentile_approx(t.`timedelta`, 0.5D, 10000)#2581716L else null) ignore nulls#2581717L, first(if ((gid#2581705 = 0)) stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581726 else null) ignore nulls#2581727]", "Results": " [8]: [long_ip#2192590L, window#2194102, coalesce(first(if ((gid#2581705 = 0)) count(__auto_generated_subquery_name.`long_ip`)#2581712L else null) ignore nulls#2581713L, 0) AS cnt_attempts_ip_15m#2194073L, count(if ((gid#2581705 = 1)) __auto_generated_subquery_name.`username`#2581706 else null)#2194100L AS cnt_dist_usr_15m#2194074L, count(if ((gid#2581705 = 2)) t.`application_id`#2581707 else null)#2194101L AS cnt_dist_app_15m#2194075L, coalesce(first(if ((gid#2581705 = 0)) collect_set(t.`application_id`)#2581714 else null) ignore nulls#2581715, []) AS app_id_set_15m#2194077, first(if ((gid#2581705 = 0)) percentile_approx(t.`timedelta`, 0.5D, 10000)#2581716L else null) ignore nulls#2581717L AS 50th_timedelta_15m#2194081L, first(if ((gid#2581705 = 0)) stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581726 else null) ignore nulls#2581727 AS stddev_timedelta_15m#2194091]"}, "full_label": "SortAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89"], "size": 54, "equiv": "0"}, "91": {"label": "Sort", "notes": "", "children": [92], "parent": [90], "node_id": "(105) Sort", "lineno": 4738, "detail": {"note": "Sort", "lineno": 5461, "Input": " [12]: [long_ip#2192590L, window#2194102, first#2581941L, valueSet#2581942, count#2581944L, count#2581946L, first#2581949, valueSet#2581950, first#2581953L, valueSet#2581954, first#2581957, valueSet#2581958]", "Arguments:": " [long_ip#2192590L ASC NULLS FIRST, window#2194102 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90"], "size": 53, "equiv": "0"}, "92": {"label": "Exchange", "notes": "", "children": [93], "parent": [91], "node_id": "(104) Exchange", "lineno": 4739, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [12]: [long_ip#2192590L, window#2194102, first#2581941L, valueSet#2581942, count#2581944L, count#2581946L, first#2581949, valueSet#2581950, first#2581953L, valueSet#2581954, first#2581957, valueSet#2581958]", "Arguments:": " hashpartitioning(long_ip#2192590L, window#2194102, 1000), ENSURE_REQUIREMENTS, [id=#1668922]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91"], "size": 52, "equiv": "0"}, "93": {"label": "SortAggregate", "notes": "", "children": [94], "parent": [92], "node_id": "(103) SortAggregate", "lineno": 4740, "detail": {"note": "SortAggregate", "lineno": 5461, "Input": " [9]: [long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705, count(__auto_generated_subquery_name.`long_ip`)#2581712L, collect_set(t.`application_id`)#2581714, percentile_approx(t.`timedelta`, 0.5D, 10000)#2581716L, stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581726]", "Keys": " [2]: [long_ip#2192590L, window#2194102]", "Functions": " [6]: [partial_first(if ((gid#2581705 = 0)) count(__auto_generated_subquery_name.`long_ip`)#2581712L else null, true) AS (first#2581941L, valueSet#2581942), partial_count(if ((gid#2581705 = 1)) __auto_generated_subquery_name.`username`#2581706 else null) AS count#2581944L, partial_count(if ((gid#2581705 = 2)) t.`application_id`#2581707 else null) AS count#2581946L, partial_first(if ((gid#2581705 = 0)) collect_set(t.`application_id`)#2581714 else null, true) AS (first#2581949, valueSet#2581950), partial_first(if ((gid#2581705 = 0)) percentile_approx(t.`timedelta`, 0.5D, 10000)#2581716L else null, true) AS (first#2581953L, valueSet#2581954), partial_first(if ((gid#2581705 = 0)) stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581726 else null, true) AS (first#2581957, valueSet#2581958)]", "Aggregate": " Attributes [10]: [first#2581939L, valueSet#2581940, count#2581943L, count#2581945L, first#2581947, valueSet#2581948, first#2581951L, valueSet#2581952, first#2581955, valueSet#2581956]", "Results": " [12]: [long_ip#2192590L, window#2194102, first#2581941L, valueSet#2581942, count#2581944L, count#2581946L, first#2581949, valueSet#2581950, first#2581953L, valueSet#2581954, first#2581957, valueSet#2581958]"}, "full_label": "SortAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92"], "size": 51, "equiv": "0"}, "94": {"label": "Sort", "notes": "", "children": [95], "parent": [93], "node_id": "(102) Sort", "lineno": 4741, "detail": {"note": "Sort", "lineno": 5461, "Input": " [9]: [long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705, count(__auto_generated_subquery_name.`long_ip`)#2581712L, collect_set(t.`application_id`)#2581714, percentile_approx(t.`timedelta`, 0.5D, 10000)#2581716L, stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581726]", "Arguments:": " [long_ip#2192590L ASC NULLS FIRST, window#2194102 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93"], "size": 50, "equiv": "0"}, "95": {"label": "ObjectHashAggregate", "notes": "", "children": [96], "parent": [94], "node_id": "(101) ObjectHashAggregate", "lineno": 4742, "detail": {"note": "ObjectHashAggregate", "lineno": 5461, "Input": " [11]: [long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705, count#2581968L, buf#2581970, buf#2581972, n#2581723, avg#2581724, m2#2581725]", "Keys": " [5]: [long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705]", "Functions": " [4]: [finalmerge_count(merge count#2581968L) AS count(__auto_generated_subquery_name.`long_ip`#2581708L)#2194072L, finalmerge_collect_set(merge buf#2581970) AS collect_set(t.`application_id`#2581709, 0, 0)#2194076, finalmerge_percentile_approx(merge buf#2581972) AS percentile_approx(t.`timedelta`#2581710L, 0.5, 10000, 0, 0)#2194080L, finalmerge_stddev_samp(merge n#2581723, avg#2581724, m2#2581725) AS stddev_samp(CAST(t.`timedelta` AS DOUBLE)#2581711)#2194090]", "Aggregate": " Attributes [4]: [count(__auto_generated_subquery_name.`long_ip`#2581708L)#2194072L, collect_set(t.`application_id`#2581709, 0, 0)#2194076, percentile_approx(t.`timedelta`#2581710L, 0.5, 10000, 0, 0)#2194080L, stddev_samp(CAST(t.`timedelta` AS DOUBLE)#2581711)#2194090]", "Results": " [9]: [long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705, count(__auto_generated_subquery_name.`long_ip`#2581708L)#2194072L AS count(__auto_generated_subquery_name.`long_ip`)#2581712L, collect_set(t.`application_id`#2581709, 0, 0)#2194076 AS collect_set(t.`application_id`)#2581714, percentile_approx(t.`timedelta`#2581710L, 0.5, 10000, 0, 0)#2194080L AS percentile_approx(t.`timedelta`, 0.5D, 10000)#2581716L, stddev_samp(CAST(t.`timedelta` AS DOUBLE)#2581711)#2194090 AS stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581726]"}, "full_label": "ObjectHashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94"], "size": 49, "equiv": "0"}, "96": {"label": "Exchange", "notes": "", "children": [97], "parent": [95], "node_id": "(100) Exchange", "lineno": 4743, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [11]: [long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705, count#2581968L, buf#2581970, buf#2581972, n#2581723, avg#2581724, m2#2581725]", "Arguments:": " hashpartitioning(long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705, 1000), ENSURE_REQUIREMENTS, [id=#1668916]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95"], "size": 48, "equiv": "0"}, "97": {"label": "ObjectHashAggregate", "notes": "", "children": [98], "parent": [96], "node_id": "(99) ObjectHashAggregate", "lineno": 4744, "detail": {"note": "ObjectHashAggregate", "lineno": 5461, "Input": " [9]: [long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705, __auto_generated_subquery_name.`long_ip`#2581708L, t.`application_id`#2581709, t.`timedelta`#2581710L, CAST(t.`timedelta` AS DOUBLE)#2581711]", "Keys": " [5]: [long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705]", "Functions": " [4]: [partial_count(__auto_generated_subquery_name.`long_ip`#2581708L) AS count#2581968L, partial_collect_set(t.`application_id`#2581709, 0, 0) AS buf#2581970, partial_percentile_approx(t.`timedelta`#2581710L, 0.5, 10000, 0, 0) AS buf#2581972, partial_stddev_samp(CAST(t.`timedelta` AS DOUBLE)#2581711) AS (n#2581723, avg#2581724, m2#2581725)]", "Aggregate": " Attributes [6]: [count#2581967L, buf#2581969, buf#2581971, n#2581718, avg#2581719, m2#2581720]", "Results": " [11]: [long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705, count#2581968L, buf#2581970, buf#2581972, n#2581723, avg#2581724, m2#2581725]"}, "full_label": "ObjectHashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96"], "size": 47, "equiv": "0"}, "98": {"label": "Expand", "notes": "", "children": [99], "parent": [97], "node_id": "(98) Expand", "lineno": 4745, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [window#2194102, long_ip#2192590L, username#2192593, application_id#2172243, timedelta#2194223L]", "Arguments:": " [ArrayBuffer(long_ip#2192590L, window#2194102, null, null, 0, long_ip#2192590L, application_id#2172243, timedelta#2194223L, cast(timedelta#2194223L as double)), ArrayBuffer(long_ip#2192590L, window#2194102, username#2192593, null, 1, null, null, null, null), ArrayBuffer(long_ip#2192590L, window#2194102, null, application_id#2172243, 2, null, null, null, null)], [long_ip#2192590L, window#2194102, __auto_generated_subquery_name.`username`#2581706, t.`application_id`#2581707, gid#2581705, __auto_generated_subquery_name.`long_ip`#2581708L, t.`application_id`#2581709, t.`timedelta`#2581710L, CAST(t.`timedelta` AS DOUBLE)#2581711]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97"], "size": 46, "equiv": "6"}, "99": {"label": "Project", "notes": "", "children": [100], "parent": [98], "node_id": "(97) Project", "lineno": 4746, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [window#2194102, long_ip#2192590L, username#2192593, application_id#2172243, timedelta#2194223L]", "Input": " [6]: [window#2194102, long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98"], "size": 45, "equiv": "0"}, "100": {"label": "Filter", "notes": "", "children": [101], "parent": [99], "node_id": "(96) Filter", "lineno": 4747, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [window#2194102, long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L]", "Condition": " : ((isnotnull(window#2194102) AND (transaction_date_time#2172247 >= window#2194102.start)) AND (transaction_date_time#2172247 < window#2194102.end))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99"], "size": 44, "equiv": "0"}, "101": {"label": "Expand", "notes": "", "children": [102], "parent": [100], "node_id": "(95) Expand", "lineno": 4748, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L]", "Arguments:": " [List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 3) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 3) * 300000000) + 900000000), LongType, TimestampType)), long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 3) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 3) * 300000000) + 900000000), LongType, TimestampType)), long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 3) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 3) * 300000000) + 900000000), LongType, TimestampType)), long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L)], [window#2194102, long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100"], "size": 43, "equiv": "7"}, "102": {"label": "Project", "notes": "", "children": [103], "parent": [101], "node_id": "(94) Project", "lineno": 4749, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L]", "Input": " [6]: [long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L, un#2192556]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101"], "size": 42, "equiv": "0"}, "103": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [104, 139], "parent": [102], "node_id": "(93) SortMergeJoin", "lineno": 4750, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [username#2192593]", "Right": " keys [1]: [un#2192556]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102"], "size": 41, "equiv": "0"}, "104": {"label": "Sort", "notes": "", "children": [105], "parent": [103], "node_id": "(87) Sort", "lineno": 4751, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L]", "Arguments:": " [username#2192593 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103"], "size": 35, "equiv": "0"}, "105": {"label": "Exchange", "notes": "", "children": [106], "parent": [104], "node_id": "(86) Exchange", "lineno": 4752, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2192590L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194223L]", "Arguments:": " hashpartitioning(username#2192593, 1000), ENSURE_REQUIREMENTS, [id=#1668904]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104"], "size": 34, "equiv": "0"}, "106": {"label": "Project", "notes": "", "children": [107], "parent": [105], "node_id": "(85) Project", "lineno": 4753, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L AS long_ip#2192590L, userName#2172244 AS username#2192593, application_id#2172243, transaction_date_time#2172247, coalesce(timedelta#2172258L, 12000) AS timedelta#2194223L]", "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L, exploded_ip#2174776L, ip_whitelist_flg#2192601]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105"], "size": 33, "equiv": "0"}, "107": {"label": "Filter", "notes": "", "children": [108], "parent": [106], "node_id": "(84) Filter", "lineno": 4754, "detail": {"note": "Filter", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L, exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Condition": " : isnull(ip_whitelist_flg#2192601)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106"], "size": 32, "equiv": "0"}, "108": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [109, 134], "parent": [107], "node_id": "(83) SortMergeJoin", "lineno": 4755, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107"], "size": 31, "equiv": "0"}, "109": {"label": "Sort", "notes": "", "children": [110], "parent": [108], "node_id": "(77) Sort", "lineno": 4756, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108"], "size": 25, "equiv": "0"}, "110": {"label": "Exchange", "notes": "", "children": [111], "parent": [109], "node_id": "(76) Exchange", "lineno": 4757, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1668895]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109"], "size": 24, "equiv": "0"}, "111": {"label": "Project", "notes": "", "children": [112], "parent": [110], "node_id": "(75) Project", "lineno": 4758, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]", "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110"], "size": 23, "equiv": "0"}, "112": {"label": "BroadcastHashJoin LeftAnti BuildRight", "notes": "", "children": [113, 116], "parent": [111], "node_id": "(74) BroadcastHashJoin", "lineno": 4759, "detail": {"note": "BroadcastHashJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2192616]", "Join": " condition: None"}, "full_label": "BroadcastHashJoin LeftAnti BuildRight", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111"], "size": 22, "equiv": "0"}, "113": {"label": "Filter", "notes": "", "children": [114], "parent": [112], "node_id": "(56) Filter", "lineno": 4760, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]", "Condition": " : isnotnull(transaction_date_time#2172247)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112"], "size": 3, "equiv": "8"}, "114": {"label": "InMemoryTableScan", "notes": "", "children": [115], "parent": [113], "node_id": "(55) InMemoryTableScan", "lineno": 4761, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L], [isnotnull(transaction_date_time#2172247)]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113"], "size": 2, "equiv": "3"}, "115": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [114], "node_id": "(56) InMemoryRelation", "lineno": 4762, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "113", "114"], "size": 1, "equiv": "0"}, "116": {"label": "BroadcastExchange", "notes": "", "children": [117], "parent": [112], "node_id": "(73) BroadcastExchange", "lineno": 4773, "detail": {"note": "BroadcastExchange", "lineno": 5461, "Input": " [1]: [ip_address#2192616]", "Arguments:": " HashedRelationBroadcastMode(List(input[0, string, true]),true), [id=#1668890]"}, "full_label": "BroadcastExchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112"], "size": 18, "equiv": "1"}, "117": {"label": "Project", "notes": "", "children": [118], "parent": [116], "node_id": "(72) Project", "lineno": 4774, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2192616]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116"], "size": 17, "equiv": "2"}, "118": {"label": "Filter", "notes": "", "children": [119], "parent": [117], "node_id": "(71) Filter", "lineno": 4775, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]", "Condition": " : (ip_trans_cnt#2192615L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117"], "size": 16, "equiv": "0"}, "119": {"label": "HashAggregate", "notes": "", "children": [120], "parent": [118], "node_id": "(70) HashAggregate", "lineno": 4776, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210409L) AS count(1)#2192632L]", "Aggregate": " Attributes [1]: [count(1)#2192632L]", "Results": " [2]: [ip_address#2172241, count(1)#2192632L AS ip_trans_cnt#2192615L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118"], "size": 15, "equiv": "0"}, "120": {"label": "Exchange", "notes": "", "children": [121], "parent": [119], "node_id": "(69) Exchange", "lineno": 4777, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1668885]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119"], "size": 14, "equiv": "0"}, "121": {"label": "HashAggregate", "notes": "", "children": [122], "parent": [120], "node_id": "(68) HashAggregate", "lineno": 4778, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210409L]", "Aggregate": " Attributes [1]: [count#2210408L]", "Results": " [2]: [ip_address#2172241, count#2210409L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120"], "size": 13, "equiv": "0"}, "122": {"label": "Project", "notes": "", "children": [123], "parent": [121], "node_id": "(67) Project", "lineno": 4779, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121"], "size": 12, "equiv": "0"}, "123": {"label": "Filter", "notes": "", "children": [124], "parent": [122], "node_id": "(66) Filter", "lineno": 4780, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Condition": " : isnull(ip_whitelist_flg#2192618)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122"], "size": 11, "equiv": "0"}, "124": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [125, 129], "parent": [123], "node_id": "(65) SortMergeJoin", "lineno": 4781, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122", "123"], "size": 10, "equiv": "0"}, "125": {"label": "Sort", "notes": "", "children": [126], "parent": [124], "node_id": "(59) Sort", "lineno": 4782, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122", "123", "124"], "size": 4, "equiv": "0"}, "126": {"label": "Exchange", "notes": "", "children": [127], "parent": [125], "node_id": "(58) Exchange", "lineno": 4783, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1668876]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125"], "size": 3, "equiv": "0"}, "127": {"label": "InMemoryTableScan", "notes": "", "children": [128], "parent": [126], "node_id": "(57) InMemoryTableScan", "lineno": 4784, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126"], "size": 2, "equiv": "3"}, "128": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [127], "node_id": "(58) InMemoryRelation", "lineno": 4785, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122", "123", "124", "125", "126", "127"], "size": 1, "equiv": "0"}, "129": {"label": "Sort", "notes": "", "children": [130], "parent": [124], "node_id": "(64) Sort", "lineno": 4796, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122", "123", "124"], "size": 5, "equiv": "4"}, "130": {"label": "Exchange", "notes": "", "children": [131], "parent": [129], "node_id": "(63) Exchange", "lineno": 4797, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1668877]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122", "123", "124", "129"], "size": 4, "equiv": "0"}, "131": {"label": "Project", "notes": "", "children": [132], "parent": [130], "node_id": "(62) Project", "lineno": 4798, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192618]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122", "123", "124", "129", "130"], "size": 3, "equiv": "0"}, "132": {"label": "Filter", "notes": "", "children": [133], "parent": [131], "node_id": "(61) Filter", "lineno": 4799, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122", "123", "124", "129", "130", "131"], "size": 2, "equiv": "0"}, "133": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [132], "node_id": "(60) Scan", "lineno": 4800, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "109", "110", "111", "112", "116", "117", "118", "119", "120", "121", "122", "123", "124", "129", "130", "131", "132"], "size": 1, "equiv": "0"}, "134": {"label": "Sort", "notes": "", "children": [135], "parent": [108], "node_id": "(82) Sort", "lineno": 4801, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108"], "size": 5, "equiv": "4"}, "135": {"label": "Exchange", "notes": "", "children": [136], "parent": [134], "node_id": "(81) Exchange", "lineno": 4802, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1668896]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "134"], "size": 4, "equiv": "0"}, "136": {"label": "Project", "notes": "", "children": [137], "parent": [135], "node_id": "(80) Project", "lineno": 4803, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192601]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "134", "135"], "size": 3, "equiv": "0"}, "137": {"label": "Filter", "notes": "", "children": [138], "parent": [136], "node_id": "(79) Filter", "lineno": 4804, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "134", "135", "136"], "size": 2, "equiv": "0"}, "138": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [137], "node_id": "(78) Scan", "lineno": 4805, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "104", "105", "106", "107", "108", "134", "135", "136", "137"], "size": 1, "equiv": "0"}, "139": {"label": "Sort", "notes": "", "children": [140], "parent": [103], "node_id": "(92) Sort", "lineno": 4806, "detail": {"note": "Sort", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " [un#2192556 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103"], "size": 5, "equiv": "4"}, "140": {"label": "Exchange", "notes": "", "children": [141], "parent": [139], "node_id": "(91) Exchange", "lineno": 4807, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " hashpartitioning(un#2192556, 1000), ENSURE_REQUIREMENTS, [id=#1668905]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "139"], "size": 4, "equiv": "0"}, "141": {"label": "Project", "notes": "", "children": [142], "parent": [140], "node_id": "(90) Project", "lineno": 4808, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [userName#2175089 AS un#2192556]", "Input": " [2]: [userName#2175089, data_dt#2175091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "139", "140"], "size": 3, "equiv": "0"}, "142": {"label": "Filter", "notes": "", "children": [143], "parent": [141], "node_id": "(89) Filter", "lineno": 4809, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [userName#2175089, data_dt#2175091]", "Condition": " : isnotnull(userName#2175089)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "139", "140", "141"], "size": 2, "equiv": "0"}, "143": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [142], "node_id": "(88) Scan", "lineno": 4810, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [2]: [userName#2175089, data_dt#2175091]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/usr_distip_cnt_map]", "PartitionFilters:": " [isnotnull(data_dt#2175091), (data_dt#2175091 = 2022080317)]", "PushedFilters:": " [IsNotNull(userName)]", "ReadSchema:": " struct<userName:string>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "86", "87", "88", "89", "90", "91", "92", "93", "94", "95", "96", "97", "98", "99", "100", "101", "102", "103", "139", "140", "141", "142"], "size": 1, "equiv": "0"}, "144": {"label": "Sort", "notes": "", "children": [145], "parent": [17], "node_id": "(168) Sort", "lineno": 4811, "detail": {"note": "Sort", "lineno": 5461, "Input": " [8]: [long_ip#2172242L, _gen_alias_2581296#2581296, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST, _gen_alias_2581296#2581296 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17"], "size": 58, "equiv": "5"}, "145": {"label": "Exchange", "notes": "", "children": [146], "parent": [144], "node_id": "(167) Exchange", "lineno": 4812, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [8]: [long_ip#2172242L, _gen_alias_2581296#2581296, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169]", "Arguments:": " hashpartitioning(long_ip#2172242L, _gen_alias_2581296#2581296, 1000), ENSURE_REQUIREMENTS, [id=#1668989]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144"], "size": 57, "equiv": "0"}, "146": {"label": "Project", "notes": "", "children": [147], "parent": [145], "node_id": "(166) Project", "lineno": 4813, "detail": {"note": "Project", "lineno": 5461, "Output": " [8]: [long_ip#2172242L, window#2194180.end AS _gen_alias_2581296#2581296, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169]", "Input": " [8]: [long_ip#2172242L, window#2194180, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145"], "size": 56, "equiv": "0"}, "147": {"label": "Filter", "notes": "", "children": [148], "parent": [146], "node_id": "(165) Filter", "lineno": 4814, "detail": {"note": "Filter", "lineno": 5461, "Input": " [8]: [long_ip#2172242L, window#2194180, cnt_attempts_ip_60m#2194151L, cnt_dist_usr_60m#2194152L, cnt_dist_app_60m#2194153L, app_id_set_60m#2194155, 50th_timedelta_60m#2194159L, stddev_timedelta_60m#2194169]", "Condition": " : (isnotnull(long_ip#2172242L) AND isnotnull(window#2194180.end))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146"], "size": 55, "equiv": "0"}, "148": {"label": "SortAggregate", "notes": "", "children": [149], "parent": [147], "node_id": "(164) SortAggregate", "lineno": 4815, "detail": {"note": "SortAggregate", "lineno": 5461, "Input": " [12]: [long_ip#2172242L, window#2194180, first#2581975L, valueSet#2581976, count#2581978L, count#2581980L, first#2581983, valueSet#2581984, first#2581987L, valueSet#2581988, first#2581991, valueSet#2581992]", "Keys": " [2]: [long_ip#2172242L, window#2194180]", "Functions": " [6]: [finalmerge_first(merge first#2581975L, valueSet#2581976) AS first(if ((gid#2581728 = 0)) count(t.`long_ip`)#2581735L else null) ignore nulls#2581736L, finalmerge_count(merge count#2581978L) AS count(if ((gid#2581728 = 1)) __auto_generated_subquery_name.`username`#2581729 else null)#2194178L, finalmerge_count(merge count#2581980L) AS count(if ((gid#2581728 = 2)) t.`application_id`#2581730 else null)#2194179L, finalmerge_first(merge first#2581983, valueSet#2581984) AS first(if ((gid#2581728 = 0)) collect_set(t.`application_id`)#2581737 else null) ignore nulls#2581738, finalmerge_first(merge first#2581987L, valueSet#2581988) AS first(if ((gid#2581728 = 0)) percentile_approx(t.`timedelta`, 0.5D, 10000)#2581739L else null) ignore nulls#2581740L, finalmerge_first(merge first#2581991, valueSet#2581992) AS first(if ((gid#2581728 = 0)) stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581749 else null) ignore nulls#2581750]", "Aggregate": " Attributes [6]: [first(if ((gid#2581728 = 0)) count(t.`long_ip`)#2581735L else null) ignore nulls#2581736L, count(if ((gid#2581728 = 1)) __auto_generated_subquery_name.`username`#2581729 else null)#2194178L, count(if ((gid#2581728 = 2)) t.`application_id`#2581730 else null)#2194179L, first(if ((gid#2581728 = 0)) collect_set(t.`application_id`)#2581737 else null) ignore nulls#2581738, first(if ((gid#2581728 = 0)) percentile_approx(t.`timedelta`, 0.5D, 10000)#2581739L else null) ignore nulls#2581740L, first(if ((gid#2581728 = 0)) stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581749 else null) ignore nulls#2581750]", "Results": " [8]: [long_ip#2172242L, window#2194180, coalesce(first(if ((gid#2581728 = 0)) count(t.`long_ip`)#2581735L else null) ignore nulls#2581736L, 0) AS cnt_attempts_ip_60m#2194151L, count(if ((gid#2581728 = 1)) __auto_generated_subquery_name.`username`#2581729 else null)#2194178L AS cnt_dist_usr_60m#2194152L, count(if ((gid#2581728 = 2)) t.`application_id`#2581730 else null)#2194179L AS cnt_dist_app_60m#2194153L, coalesce(first(if ((gid#2581728 = 0)) collect_set(t.`application_id`)#2581737 else null) ignore nulls#2581738, []) AS app_id_set_60m#2194155, first(if ((gid#2581728 = 0)) percentile_approx(t.`timedelta`, 0.5D, 10000)#2581739L else null) ignore nulls#2581740L AS 50th_timedelta_60m#2194159L, first(if ((gid#2581728 = 0)) stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581749 else null) ignore nulls#2581750 AS stddev_timedelta_60m#2194169]"}, "full_label": "SortAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147"], "size": 54, "equiv": "0"}, "149": {"label": "Sort", "notes": "", "children": [150], "parent": [148], "node_id": "(163) Sort", "lineno": 4816, "detail": {"note": "Sort", "lineno": 5461, "Input": " [12]: [long_ip#2172242L, window#2194180, first#2581975L, valueSet#2581976, count#2581978L, count#2581980L, first#2581983, valueSet#2581984, first#2581987L, valueSet#2581988, first#2581991, valueSet#2581992]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST, window#2194180 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148"], "size": 53, "equiv": "0"}, "150": {"label": "Exchange", "notes": "", "children": [151], "parent": [149], "node_id": "(162) Exchange", "lineno": 4817, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [12]: [long_ip#2172242L, window#2194180, first#2581975L, valueSet#2581976, count#2581978L, count#2581980L, first#2581983, valueSet#2581984, first#2581987L, valueSet#2581988, first#2581991, valueSet#2581992]", "Arguments:": " hashpartitioning(long_ip#2172242L, window#2194180, 1000), ENSURE_REQUIREMENTS, [id=#1668982]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149"], "size": 52, "equiv": "0"}, "151": {"label": "SortAggregate", "notes": "", "children": [152], "parent": [150], "node_id": "(161) SortAggregate", "lineno": 4818, "detail": {"note": "SortAggregate", "lineno": 5461, "Input": " [9]: [long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728, count(t.`long_ip`)#2581735L, collect_set(t.`application_id`)#2581737, percentile_approx(t.`timedelta`, 0.5D, 10000)#2581739L, stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581749]", "Keys": " [2]: [long_ip#2172242L, window#2194180]", "Functions": " [6]: [partial_first(if ((gid#2581728 = 0)) count(t.`long_ip`)#2581735L else null, true) AS (first#2581975L, valueSet#2581976), partial_count(if ((gid#2581728 = 1)) __auto_generated_subquery_name.`username`#2581729 else null) AS count#2581978L, partial_count(if ((gid#2581728 = 2)) t.`application_id`#2581730 else null) AS count#2581980L, partial_first(if ((gid#2581728 = 0)) collect_set(t.`application_id`)#2581737 else null, true) AS (first#2581983, valueSet#2581984), partial_first(if ((gid#2581728 = 0)) percentile_approx(t.`timedelta`, 0.5D, 10000)#2581739L else null, true) AS (first#2581987L, valueSet#2581988), partial_first(if ((gid#2581728 = 0)) stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581749 else null, true) AS (first#2581991, valueSet#2581992)]", "Aggregate": " Attributes [10]: [first#2581973L, valueSet#2581974, count#2581977L, count#2581979L, first#2581981, valueSet#2581982, first#2581985L, valueSet#2581986, first#2581989, valueSet#2581990]", "Results": " [12]: [long_ip#2172242L, window#2194180, first#2581975L, valueSet#2581976, count#2581978L, count#2581980L, first#2581983, valueSet#2581984, first#2581987L, valueSet#2581988, first#2581991, valueSet#2581992]"}, "full_label": "SortAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150"], "size": 51, "equiv": "0"}, "152": {"label": "Sort", "notes": "", "children": [153], "parent": [151], "node_id": "(160) Sort", "lineno": 4819, "detail": {"note": "Sort", "lineno": 5461, "Input": " [9]: [long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728, count(t.`long_ip`)#2581735L, collect_set(t.`application_id`)#2581737, percentile_approx(t.`timedelta`, 0.5D, 10000)#2581739L, stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581749]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST, window#2194180 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151"], "size": 50, "equiv": "0"}, "153": {"label": "ObjectHashAggregate", "notes": "", "children": [154], "parent": [152], "node_id": "(159) ObjectHashAggregate", "lineno": 4820, "detail": {"note": "ObjectHashAggregate", "lineno": 5461, "Input": " [11]: [long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728, count#2582002L, buf#2582004, buf#2582006, n#2581746, avg#2581747, m2#2581748]", "Keys": " [5]: [long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728]", "Functions": " [4]: [finalmerge_count(merge count#2582002L) AS count(t.`long_ip`#2581731L)#2194150L, finalmerge_collect_set(merge buf#2582004) AS collect_set(t.`application_id`#2581732, 0, 0)#2194154, finalmerge_percentile_approx(merge buf#2582006) AS percentile_approx(t.`timedelta`#2581733L, 0.5, 10000, 0, 0)#2194158L, finalmerge_stddev_samp(merge n#2581746, avg#2581747, m2#2581748) AS stddev_samp(CAST(t.`timedelta` AS DOUBLE)#2581734)#2194168]", "Aggregate": " Attributes [4]: [count(t.`long_ip`#2581731L)#2194150L, collect_set(t.`application_id`#2581732, 0, 0)#2194154, percentile_approx(t.`timedelta`#2581733L, 0.5, 10000, 0, 0)#2194158L, stddev_samp(CAST(t.`timedelta` AS DOUBLE)#2581734)#2194168]", "Results": " [9]: [long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728, count(t.`long_ip`#2581731L)#2194150L AS count(t.`long_ip`)#2581735L, collect_set(t.`application_id`#2581732, 0, 0)#2194154 AS collect_set(t.`application_id`)#2581737, percentile_approx(t.`timedelta`#2581733L, 0.5, 10000, 0, 0)#2194158L AS percentile_approx(t.`timedelta`, 0.5D, 10000)#2581739L, stddev_samp(CAST(t.`timedelta` AS DOUBLE)#2581734)#2194168 AS stddev_samp(CAST(t.`timedelta` AS DOUBLE))#2581749]"}, "full_label": "ObjectHashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152"], "size": 49, "equiv": "0"}, "154": {"label": "Exchange", "notes": "", "children": [155], "parent": [153], "node_id": "(158) Exchange", "lineno": 4821, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [11]: [long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728, count#2582002L, buf#2582004, buf#2582006, n#2581746, avg#2581747, m2#2581748]", "Arguments:": " hashpartitioning(long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728, 1000), ENSURE_REQUIREMENTS, [id=#1668976]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153"], "size": 48, "equiv": "0"}, "155": {"label": "ObjectHashAggregate", "notes": "", "children": [156], "parent": [154], "node_id": "(157) ObjectHashAggregate", "lineno": 4822, "detail": {"note": "ObjectHashAggregate", "lineno": 5461, "Input": " [9]: [long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728, t.`long_ip`#2581731L, t.`application_id`#2581732, t.`timedelta`#2581733L, CAST(t.`timedelta` AS DOUBLE)#2581734]", "Keys": " [5]: [long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728]", "Functions": " [4]: [partial_count(t.`long_ip`#2581731L) AS count#2582002L, partial_collect_set(t.`application_id`#2581732, 0, 0) AS buf#2582004, partial_percentile_approx(t.`timedelta`#2581733L, 0.5, 10000, 0, 0) AS buf#2582006, partial_stddev_samp(CAST(t.`timedelta` AS DOUBLE)#2581734) AS (n#2581746, avg#2581747, m2#2581748)]", "Aggregate": " Attributes [6]: [count#2582001L, buf#2582003, buf#2582005, n#2581741, avg#2581742, m2#2581743]", "Results": " [11]: [long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728, count#2582002L, buf#2582004, buf#2582006, n#2581746, avg#2581747, m2#2581748]"}, "full_label": "ObjectHashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154"], "size": 47, "equiv": "0"}, "156": {"label": "Expand", "notes": "", "children": [157], "parent": [155], "node_id": "(156) Expand", "lineno": 4823, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [window#2194180, long_ip#2172242L, username#2192593, application_id#2172243, timedelta#2194286L]", "Arguments:": " [ArrayBuffer(long_ip#2172242L, window#2194180, null, null, 0, long_ip#2172242L, application_id#2172243, timedelta#2194286L, cast(timedelta#2194286L as double)), ArrayBuffer(long_ip#2172242L, window#2194180, username#2192593, null, 1, null, null, null, null), ArrayBuffer(long_ip#2172242L, window#2194180, null, application_id#2172243, 2, null, null, null, null)], [long_ip#2172242L, window#2194180, __auto_generated_subquery_name.`username`#2581729, t.`application_id`#2581730, gid#2581728, t.`long_ip`#2581731L, t.`application_id`#2581732, t.`timedelta`#2581733L, CAST(t.`timedelta` AS DOUBLE)#2581734]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155"], "size": 46, "equiv": "6"}, "157": {"label": "Project", "notes": "", "children": [158], "parent": [156], "node_id": "(155) Project", "lineno": 4824, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [window#2194180, long_ip#2172242L, username#2192593, application_id#2172243, timedelta#2194286L]", "Input": " [6]: [window#2194180, long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156"], "size": 45, "equiv": "0"}, "158": {"label": "Filter", "notes": "", "children": [159], "parent": [157], "node_id": "(154) Filter", "lineno": 4825, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [window#2194180, long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L]", "Condition": " : ((isnotnull(window#2194180) AND (transaction_date_time#2172247 >= window#2194180.start)) AND (transaction_date_time#2172247 < window#2194180.end))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157"], "size": 44, "equiv": "0"}, "159": {"label": "Expand", "notes": "", "children": [160], "parent": [158], "node_id": "(153) Expand", "lineno": 4826, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L]", "Arguments:": " [List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 3) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 3) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 4) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 4) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 5) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 5) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 6) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 6) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 7) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 7) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 8) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 8) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 9) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 9) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 10) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 10) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 11) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 11) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L)], [window#2194180, long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158"], "size": 43, "equiv": "7"}, "160": {"label": "Project", "notes": "", "children": [161], "parent": [159], "node_id": "(152) Project", "lineno": 4827, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L]", "Input": " [6]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L, un#2192556]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159"], "size": 42, "equiv": "0"}, "161": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [162, 197], "parent": [160], "node_id": "(151) SortMergeJoin", "lineno": 4828, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [username#2192593]", "Right": " keys [1]: [un#2192556]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160"], "size": 41, "equiv": "0"}, "162": {"label": "Sort", "notes": "", "children": [163], "parent": [161], "node_id": "(145) Sort", "lineno": 4829, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L]", "Arguments:": " [username#2192593 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161"], "size": 35, "equiv": "0"}, "163": {"label": "Exchange", "notes": "", "children": [164], "parent": [162], "node_id": "(144) Exchange", "lineno": 4830, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, timedelta#2194286L]", "Arguments:": " hashpartitioning(username#2192593, 1000), ENSURE_REQUIREMENTS, [id=#1668964]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162"], "size": 34, "equiv": "0"}, "164": {"label": "Project", "notes": "", "children": [165], "parent": [163], "node_id": "(143) Project", "lineno": 4831, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, userName#2172244 AS username#2192593, application_id#2172243, transaction_date_time#2172247, coalesce(timedelta#2172258L, 12000) AS timedelta#2194286L]", "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L, exploded_ip#2174776L, ip_whitelist_flg#2192601]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163"], "size": 33, "equiv": "0"}, "165": {"label": "Filter", "notes": "", "children": [166], "parent": [164], "node_id": "(142) Filter", "lineno": 4832, "detail": {"note": "Filter", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L, exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Condition": " : isnull(ip_whitelist_flg#2192601)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164"], "size": 32, "equiv": "0"}, "166": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [167, 192], "parent": [165], "node_id": "(141) SortMergeJoin", "lineno": 4833, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165"], "size": 31, "equiv": "0"}, "167": {"label": "Sort", "notes": "", "children": [168], "parent": [166], "node_id": "(135) Sort", "lineno": 4834, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166"], "size": 25, "equiv": "0"}, "168": {"label": "Exchange", "notes": "", "children": [169], "parent": [167], "node_id": "(134) Exchange", "lineno": 4835, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1668955]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167"], "size": 24, "equiv": "0"}, "169": {"label": "Project", "notes": "", "children": [170], "parent": [168], "node_id": "(133) Project", "lineno": 4836, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]", "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168"], "size": 23, "equiv": "0"}, "170": {"label": "BroadcastHashJoin LeftAnti BuildRight", "notes": "", "children": [171, 174], "parent": [169], "node_id": "(132) BroadcastHashJoin", "lineno": 4837, "detail": {"note": "BroadcastHashJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2192616]", "Join": " condition: None"}, "full_label": "BroadcastHashJoin LeftAnti BuildRight", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169"], "size": 22, "equiv": "0"}, "171": {"label": "Filter", "notes": "", "children": [172], "parent": [170], "node_id": "(114) Filter", "lineno": 4838, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]", "Condition": " : isnotnull(transaction_date_time#2172247)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170"], "size": 3, "equiv": "8"}, "172": {"label": "InMemoryTableScan", "notes": "", "children": [173], "parent": [171], "node_id": "(113) InMemoryTableScan", "lineno": 4839, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, transaction_date_time#2172247, timedelta#2172258L], [isnotnull(transaction_date_time#2172247)]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171"], "size": 2, "equiv": "3"}, "173": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [172], "node_id": "(114) InMemoryRelation", "lineno": 4840, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "171", "172"], "size": 1, "equiv": "0"}, "174": {"label": "BroadcastExchange", "notes": "", "children": [175], "parent": [170], "node_id": "(131) BroadcastExchange", "lineno": 4851, "detail": {"note": "BroadcastExchange", "lineno": 5461, "Input": " [1]: [ip_address#2192616]", "Arguments:": " HashedRelationBroadcastMode(List(input[0, string, true]),true), [id=#1668950]"}, "full_label": "BroadcastExchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170"], "size": 18, "equiv": "1"}, "175": {"label": "Project", "notes": "", "children": [176], "parent": [174], "node_id": "(130) Project", "lineno": 4852, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2192616]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174"], "size": 17, "equiv": "2"}, "176": {"label": "Filter", "notes": "", "children": [177], "parent": [175], "node_id": "(129) Filter", "lineno": 4853, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]", "Condition": " : (ip_trans_cnt#2192615L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175"], "size": 16, "equiv": "0"}, "177": {"label": "HashAggregate", "notes": "", "children": [178], "parent": [176], "node_id": "(128) HashAggregate", "lineno": 4854, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210409L) AS count(1)#2192632L]", "Aggregate": " Attributes [1]: [count(1)#2192632L]", "Results": " [2]: [ip_address#2172241, count(1)#2192632L AS ip_trans_cnt#2192615L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176"], "size": 15, "equiv": "0"}, "178": {"label": "Exchange", "notes": "", "children": [179], "parent": [177], "node_id": "(127) Exchange", "lineno": 4855, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1668945]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177"], "size": 14, "equiv": "0"}, "179": {"label": "HashAggregate", "notes": "", "children": [180], "parent": [178], "node_id": "(126) HashAggregate", "lineno": 4856, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210409L]", "Aggregate": " Attributes [1]: [count#2210408L]", "Results": " [2]: [ip_address#2172241, count#2210409L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178"], "size": 13, "equiv": "0"}, "180": {"label": "Project", "notes": "", "children": [181], "parent": [179], "node_id": "(125) Project", "lineno": 4857, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179"], "size": 12, "equiv": "0"}, "181": {"label": "Filter", "notes": "", "children": [182], "parent": [180], "node_id": "(124) Filter", "lineno": 4858, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Condition": " : isnull(ip_whitelist_flg#2192618)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180"], "size": 11, "equiv": "0"}, "182": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [183, 187], "parent": [181], "node_id": "(123) SortMergeJoin", "lineno": 4859, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180", "181"], "size": 10, "equiv": "0"}, "183": {"label": "Sort", "notes": "", "children": [184], "parent": [182], "node_id": "(117) Sort", "lineno": 4860, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180", "181", "182"], "size": 4, "equiv": "0"}, "184": {"label": "Exchange", "notes": "", "children": [185], "parent": [183], "node_id": "(116) Exchange", "lineno": 4861, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1668936]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183"], "size": 3, "equiv": "0"}, "185": {"label": "InMemoryTableScan", "notes": "", "children": [186], "parent": [184], "node_id": "(115) InMemoryTableScan", "lineno": 4862, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184"], "size": 2, "equiv": "3"}, "186": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [185], "node_id": "(116) InMemoryRelation", "lineno": 4863, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180", "181", "182", "183", "184", "185"], "size": 1, "equiv": "0"}, "187": {"label": "Sort", "notes": "", "children": [188], "parent": [182], "node_id": "(122) Sort", "lineno": 4874, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180", "181", "182"], "size": 5, "equiv": "4"}, "188": {"label": "Exchange", "notes": "", "children": [189], "parent": [187], "node_id": "(121) Exchange", "lineno": 4875, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1668937]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180", "181", "182", "187"], "size": 4, "equiv": "0"}, "189": {"label": "Project", "notes": "", "children": [190], "parent": [188], "node_id": "(120) Project", "lineno": 4876, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192618]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180", "181", "182", "187", "188"], "size": 3, "equiv": "0"}, "190": {"label": "Filter", "notes": "", "children": [191], "parent": [189], "node_id": "(119) Filter", "lineno": 4877, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180", "181", "182", "187", "188", "189"], "size": 2, "equiv": "0"}, "191": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [190], "node_id": "(118) Scan", "lineno": 4878, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "167", "168", "169", "170", "174", "175", "176", "177", "178", "179", "180", "181", "182", "187", "188", "189", "190"], "size": 1, "equiv": "0"}, "192": {"label": "Sort", "notes": "", "children": [193], "parent": [166], "node_id": "(140) Sort", "lineno": 4879, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166"], "size": 5, "equiv": "4"}, "193": {"label": "Exchange", "notes": "", "children": [194], "parent": [192], "node_id": "(139) Exchange", "lineno": 4880, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1668956]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "192"], "size": 4, "equiv": "0"}, "194": {"label": "Project", "notes": "", "children": [195], "parent": [193], "node_id": "(138) Project", "lineno": 4881, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192601]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "192", "193"], "size": 3, "equiv": "0"}, "195": {"label": "Filter", "notes": "", "children": [196], "parent": [194], "node_id": "(137) Filter", "lineno": 4882, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "192", "193", "194"], "size": 2, "equiv": "0"}, "196": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [195], "node_id": "(136) Scan", "lineno": 4883, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "162", "163", "164", "165", "166", "192", "193", "194", "195"], "size": 1, "equiv": "0"}, "197": {"label": "Sort", "notes": "", "children": [198], "parent": [161], "node_id": "(150) Sort", "lineno": 4884, "detail": {"note": "Sort", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " [un#2192556 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161"], "size": 5, "equiv": "4"}, "198": {"label": "Exchange", "notes": "", "children": [199], "parent": [197], "node_id": "(149) Exchange", "lineno": 4885, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " hashpartitioning(un#2192556, 1000), ENSURE_REQUIREMENTS, [id=#1668965]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "197"], "size": 4, "equiv": "0"}, "199": {"label": "Project", "notes": "", "children": [200], "parent": [198], "node_id": "(148) Project", "lineno": 4886, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [userName#2175089 AS un#2192556]", "Input": " [2]: [userName#2175089, data_dt#2175091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "197", "198"], "size": 3, "equiv": "0"}, "200": {"label": "Filter", "notes": "", "children": [201], "parent": [199], "node_id": "(147) Filter", "lineno": 4887, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [userName#2175089, data_dt#2175091]", "Condition": " : isnotnull(userName#2175089)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "197", "198", "199"], "size": 2, "equiv": "0"}, "201": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [200], "node_id": "(146) Scan", "lineno": 4888, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [2]: [userName#2175089, data_dt#2175091]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/usr_distip_cnt_map]", "PartitionFilters:": " [isnotnull(data_dt#2175091), (data_dt#2175091 = 2022080317)]", "PushedFilters:": " [IsNotNull(userName)]", "ReadSchema:": " struct<userName:string>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "144", "145", "146", "147", "148", "149", "150", "151", "152", "153", "154", "155", "156", "157", "158", "159", "160", "161", "197", "198", "199", "200"], "size": 1, "equiv": "0"}, "202": {"label": "Sort", "notes": "", "children": [203], "parent": [15], "node_id": "(273) Sort", "lineno": 4889, "detail": {"note": "Sort", "lineno": 5461, "Input": " [8]: [long_ip#2194443L, _gen_alias_2581295#2581295, 5m_success_count#2194445L, 5m_failed_count#2194446L, 5m_suc_dist_usr#2194447L, 5m_fail_dist_usr#2194448L, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L]", "Arguments:": " [long_ip#2194443L ASC NULLS FIRST, _gen_alias_2581295#2581295 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15"], "size": 107, "equiv": "0"}, "203": {"label": "Exchange", "notes": "", "children": [204], "parent": [202], "node_id": "(272) Exchange", "lineno": 4890, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [8]: [long_ip#2194443L, _gen_alias_2581295#2581295, 5m_success_count#2194445L, 5m_failed_count#2194446L, 5m_suc_dist_usr#2194447L, 5m_fail_dist_usr#2194448L, 5m_suc_dist_app#2194449L, 5m_fail_dist_app#2194450L]", "Arguments:": " hashpartitioning(long_ip#2194443L, _gen_alias_2581295#2581295, 1000), ENSURE_REQUIREMENTS, [id=#1669092]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202"], "size": 106, "equiv": "0"}, "204": {"label": "Project", "notes": "", "children": [205], "parent": [203], "node_id": "(271) Project", "lineno": 4891, "detail": {"note": "Project", "lineno": 5461, "Output": " [8]: [coalesce(long_ip#2192570L, long_ip#2172242L) AS long_ip#2194443L, coalesce(window#2194366, window#2194451).end AS _gen_alias_2581295#2581295, coalesce(attempts_per_ip_5m_status#2194452L, 0) AS 5m_success_count#2194445L, coalesce(attempts_per_ip_5m_status#2194361L, 0) AS 5m_failed_count#2194446L, coalesce(dist_usr_5m_status#2194453L, 0) AS 5m_suc_dist_usr#2194447L, coalesce(dist_usr_5m_status#2194362L, 0) AS 5m_fail_dist_usr#2194448L, coalesce(dist_app_5m_status#2194454L, 0) AS 5m_suc_dist_app#2194449L, coalesce(dist_app_5m_status#2194363L, 0) AS 5m_fail_dist_app#2194450L]", "Input": " [10]: [long_ip#2192570L, window#2194366, attempts_per_ip_5m_status#2194361L, dist_usr_5m_status#2194362L, dist_app_5m_status#2194363L, long_ip#2172242L, window#2194451, attempts_per_ip_5m_status#2194452L, dist_usr_5m_status#2194453L, dist_app_5m_status#2194454L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203"], "size": 105, "equiv": "0"}, "205": {"label": "Filter", "notes": "", "children": [206], "parent": [204], "node_id": "(270) Filter", "lineno": 4892, "detail": {"note": "Filter", "lineno": 5461, "Input": " [10]: [long_ip#2192570L, window#2194366, attempts_per_ip_5m_status#2194361L, dist_usr_5m_status#2194362L, dist_app_5m_status#2194363L, long_ip#2172242L, window#2194451, attempts_per_ip_5m_status#2194452L, dist_usr_5m_status#2194453L, dist_app_5m_status#2194454L]", "Condition": " : (isnotnull(coalesce(long_ip#2192570L, long_ip#2172242L)) AND isnotnull(coalesce(window#2194366, window#2194451).end))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204"], "size": 104, "equiv": "0"}, "206": {"label": "SortMergeJoin FullOuter", "notes": "", "children": [207, 258], "parent": [205], "node_id": "(269) SortMergeJoin", "lineno": 4893, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [2]: [long_ip#2192570L, window#2194366]", "Right": " keys [2]: [long_ip#2172242L, window#2194451]", "Join": " condition: None"}, "full_label": "SortMergeJoin FullOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205"], "size": 103, "equiv": "0"}, "207": {"label": "Sort", "notes": "", "children": [208], "parent": [206], "node_id": "(219) Sort", "lineno": 4894, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, window#2194366, attempts_per_ip_5m_status#2194361L, dist_usr_5m_status#2194362L, dist_app_5m_status#2194363L]", "Arguments:": " [long_ip#2192570L ASC NULLS FIRST, window#2194366 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206"], "size": 51, "equiv": "9"}, "208": {"label": "Exchange", "notes": "", "children": [209], "parent": [207], "node_id": "(218) Exchange", "lineno": 4895, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, window#2194366, attempts_per_ip_5m_status#2194361L, dist_usr_5m_status#2194362L, dist_app_5m_status#2194363L]", "Arguments:": " hashpartitioning(long_ip#2192570L, window#2194366, 1000), ENSURE_REQUIREMENTS, [id=#1669083]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207"], "size": 50, "equiv": "0"}, "209": {"label": "HashAggregate", "notes": "", "children": [210], "parent": [208], "node_id": "(217) HashAggregate", "lineno": 4896, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194366, first#2582009L, valueSet#2582010, count#2582012L, count#2582014L]", "Keys": " [3]: [long_ip#2192570L, tguard_status#2192576, window#2194366]", "Functions": " [3]: [finalmerge_first(merge first#2582009L, valueSet#2582010) AS first(if ((gid#2581751 = 0)) count(t.`long_ip`)#2581755L else null) ignore nulls#2581756L, finalmerge_count(merge count#2582012L) AS count(if ((gid#2581751 = 1)) __auto_generated_subquery_name.`username`#2581752 else null)#2194364L, finalmerge_count(merge count#2582014L) AS count(if ((gid#2581751 = 2)) t.`application_id`#2581753 else null)#2194365L]", "Aggregate": " Attributes [3]: [first(if ((gid#2581751 = 0)) count(t.`long_ip`)#2581755L else null) ignore nulls#2581756L, count(if ((gid#2581751 = 1)) __auto_generated_subquery_name.`username`#2581752 else null)#2194364L, count(if ((gid#2581751 = 2)) t.`application_id`#2581753 else null)#2194365L]", "Results": " [5]: [long_ip#2192570L, window#2194366, coalesce(first(if ((gid#2581751 = 0)) count(t.`long_ip`)#2581755L else null) ignore nulls#2581756L, 0) AS attempts_per_ip_5m_status#2194361L, count(if ((gid#2581751 = 1)) __auto_generated_subquery_name.`username`#2581752 else null)#2194364L AS dist_usr_5m_status#2194362L, count(if ((gid#2581751 = 2)) t.`application_id`#2581753 else null)#2194365L AS dist_app_5m_status#2194363L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208"], "size": 49, "equiv": "0"}, "210": {"label": "Exchange", "notes": "", "children": [211], "parent": [209], "node_id": "(216) Exchange", "lineno": 4897, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194366, first#2582009L, valueSet#2582010, count#2582012L, count#2582014L]", "Arguments:": " hashpartitioning(long_ip#2192570L, tguard_status#2192576, window#2194366, 1000), ENSURE_REQUIREMENTS, [id=#1669035]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209"], "size": 48, "equiv": "0"}, "211": {"label": "HashAggregate", "notes": "", "children": [212], "parent": [210], "node_id": "(215) HashAggregate", "lineno": 4898, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194366, __auto_generated_subquery_name.`username`#2581752, t.`application_id`#2581753, gid#2581751, count(t.`long_ip`)#2581755L]", "Keys": " [3]: [long_ip#2192570L, tguard_status#2192576, window#2194366]", "Functions": " [3]: [partial_first(if ((gid#2581751 = 0)) count(t.`long_ip`)#2581755L else null, true) AS (first#2582009L, valueSet#2582010), partial_count(if ((gid#2581751 = 1)) __auto_generated_subquery_name.`username`#2581752 else null) AS count#2582012L, partial_count(if ((gid#2581751 = 2)) t.`application_id`#2581753 else null) AS count#2582014L]", "Aggregate": " Attributes [4]: [first#2582007L, valueSet#2582008, count#2582011L, count#2582013L]", "Results": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194366, first#2582009L, valueSet#2582010, count#2582012L, count#2582014L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210"], "size": 47, "equiv": "0"}, "212": {"label": "HashAggregate", "notes": "", "children": [213], "parent": [211], "node_id": "(214) HashAggregate", "lineno": 4899, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194366, __auto_generated_subquery_name.`username`#2581752, t.`application_id`#2581753, gid#2581751, count#2582016L]", "Keys": " [6]: [long_ip#2192570L, tguard_status#2192576, window#2194366, __auto_generated_subquery_name.`username`#2581752, t.`application_id`#2581753, gid#2581751]", "Functions": " [1]: [finalmerge_count(merge count#2582016L) AS count(t.`long_ip`#2581754L)#2194360L]", "Aggregate": " Attributes [1]: [count(t.`long_ip`#2581754L)#2194360L]", "Results": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194366, __auto_generated_subquery_name.`username`#2581752, t.`application_id`#2581753, gid#2581751, count(t.`long_ip`#2581754L)#2194360L AS count(t.`long_ip`)#2581755L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211"], "size": 46, "equiv": "0"}, "213": {"label": "Exchange", "notes": "", "children": [214], "parent": [212], "node_id": "(213) Exchange", "lineno": 4900, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194366, __auto_generated_subquery_name.`username`#2581752, t.`application_id`#2581753, gid#2581751, count#2582016L]", "Arguments:": " hashpartitioning(long_ip#2192570L, tguard_status#2192576, window#2194366, __auto_generated_subquery_name.`username`#2581752, t.`application_id`#2581753, gid#2581751, 1000), ENSURE_REQUIREMENTS, [id=#1669031]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212"], "size": 45, "equiv": "0"}, "214": {"label": "HashAggregate", "notes": "", "children": [215], "parent": [213], "node_id": "(212) HashAggregate", "lineno": 4901, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194366, __auto_generated_subquery_name.`username`#2581752, t.`application_id`#2581753, gid#2581751, t.`long_ip`#2581754L]", "Keys": " [6]: [long_ip#2192570L, tguard_status#2192576, window#2194366, __auto_generated_subquery_name.`username`#2581752, t.`application_id`#2581753, gid#2581751]", "Functions": " [1]: [partial_count(t.`long_ip`#2581754L) AS count#2582016L]", "Aggregate": " Attributes [1]: [count#2582015L]", "Results": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194366, __auto_generated_subquery_name.`username`#2581752, t.`application_id`#2581753, gid#2581751, count#2582016L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213"], "size": 44, "equiv": "0"}, "215": {"label": "Expand", "notes": "", "children": [216], "parent": [214], "node_id": "(211) Expand", "lineno": 4902, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [window#2194366, long_ip#2192570L, username#2192593, application_id#2172243, tguard_status#2192576]", "Arguments:": " [ArrayBuffer(long_ip#2192570L, tguard_status#2192576, window#2194366, null, null, 0, long_ip#2192570L), ArrayBuffer(long_ip#2192570L, tguard_status#2192576, window#2194366, username#2192593, null, 1, null), ArrayBuffer(long_ip#2192570L, tguard_status#2192576, window#2194366, null, application_id#2172243, 2, null)], [long_ip#2192570L, tguard_status#2192576, window#2194366, __auto_generated_subquery_name.`username`#2581752, t.`application_id`#2581753, gid#2581751, t.`long_ip`#2581754L]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214"], "size": 43, "equiv": "7"}, "216": {"label": "Project", "notes": "", "children": [217], "parent": [215], "node_id": "(210) Project", "lineno": 4903, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 1) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 1) * 300000000) + 300000000), LongType, TimestampType)) AS window#2194366, long_ip#2192570L, username#2192593, application_id#2172243, tguard_status#2192576]", "Input": " [6]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576, un#2192556]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215"], "size": 42, "equiv": "0"}, "217": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [218, 253], "parent": [216], "node_id": "(209) SortMergeJoin", "lineno": 4904, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [username#2192593]", "Right": " keys [1]: [un#2192556]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216"], "size": 41, "equiv": "0"}, "218": {"label": "Sort", "notes": "", "children": [219], "parent": [217], "node_id": "(203) Sort", "lineno": 4905, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Arguments:": " [username#2192593 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217"], "size": 35, "equiv": "0"}, "219": {"label": "Exchange", "notes": "", "children": [220], "parent": [218], "node_id": "(202) Exchange", "lineno": 4906, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Arguments:": " hashpartitioning(username#2192593, 1000), ENSURE_REQUIREMENTS, [id=#1669022]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218"], "size": 34, "equiv": "0"}, "220": {"label": "Project", "notes": "", "children": [221], "parent": [219], "node_id": "(201) Project", "lineno": 4907, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L AS long_ip#2192570L, userName#2172244 AS username#2192593, application_id#2172243, transaction_date_time#2172247, status#2172245 AS tguard_status#2192576]", "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219"], "size": 33, "equiv": "0"}, "221": {"label": "Filter", "notes": "", "children": [222], "parent": [220], "node_id": "(200) Filter", "lineno": 4908, "detail": {"note": "Filter", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Condition": " : isnull(ip_whitelist_flg#2192601)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220"], "size": 32, "equiv": "0"}, "222": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [223, 248], "parent": [221], "node_id": "(199) SortMergeJoin", "lineno": 4909, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221"], "size": 31, "equiv": "0"}, "223": {"label": "Sort", "notes": "", "children": [224], "parent": [222], "node_id": "(193) Sort", "lineno": 4910, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222"], "size": 25, "equiv": "0"}, "224": {"label": "Exchange", "notes": "", "children": [225], "parent": [223], "node_id": "(192) Exchange", "lineno": 4911, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669013]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223"], "size": 24, "equiv": "0"}, "225": {"label": "Project", "notes": "", "children": [226], "parent": [224], "node_id": "(191) Project", "lineno": 4912, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224"], "size": 23, "equiv": "0"}, "226": {"label": "BroadcastHashJoin LeftAnti BuildRight", "notes": "", "children": [227, 230], "parent": [225], "node_id": "(190) BroadcastHashJoin", "lineno": 4913, "detail": {"note": "BroadcastHashJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2192616]", "Join": " condition: None"}, "full_label": "BroadcastHashJoin LeftAnti BuildRight", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225"], "size": 22, "equiv": "0"}, "227": {"label": "Filter", "notes": "", "children": [228], "parent": [226], "node_id": "(172) Filter", "lineno": 4914, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Condition": " : (isnotnull(transaction_date_time#2172247) AND (status#2172245 = FAILED))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226"], "size": 3, "equiv": "8"}, "228": {"label": "InMemoryTableScan", "notes": "", "children": [229], "parent": [227], "node_id": "(171) InMemoryTableScan", "lineno": 4915, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247], [isnotnull(transaction_date_time#2172247), (status#2172245 = FAILED)]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227"], "size": 2, "equiv": "3"}, "229": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [228], "node_id": "(172) InMemoryRelation", "lineno": 4916, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "227", "228"], "size": 1, "equiv": "0"}, "230": {"label": "BroadcastExchange", "notes": "", "children": [231], "parent": [226], "node_id": "(189) BroadcastExchange", "lineno": 4927, "detail": {"note": "BroadcastExchange", "lineno": 5461, "Input": " [1]: [ip_address#2192616]", "Arguments:": " HashedRelationBroadcastMode(List(input[0, string, true]),true), [id=#1669008]"}, "full_label": "BroadcastExchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226"], "size": 18, "equiv": "1"}, "231": {"label": "Project", "notes": "", "children": [232], "parent": [230], "node_id": "(188) Project", "lineno": 4928, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2192616]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230"], "size": 17, "equiv": "2"}, "232": {"label": "Filter", "notes": "", "children": [233], "parent": [231], "node_id": "(187) Filter", "lineno": 4929, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]", "Condition": " : (ip_trans_cnt#2192615L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231"], "size": 16, "equiv": "0"}, "233": {"label": "HashAggregate", "notes": "", "children": [234], "parent": [232], "node_id": "(186) HashAggregate", "lineno": 4930, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210409L) AS count(1)#2192632L]", "Aggregate": " Attributes [1]: [count(1)#2192632L]", "Results": " [2]: [ip_address#2172241, count(1)#2192632L AS ip_trans_cnt#2192615L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232"], "size": 15, "equiv": "0"}, "234": {"label": "Exchange", "notes": "", "children": [235], "parent": [233], "node_id": "(185) Exchange", "lineno": 4931, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1669003]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233"], "size": 14, "equiv": "0"}, "235": {"label": "HashAggregate", "notes": "", "children": [236], "parent": [234], "node_id": "(184) HashAggregate", "lineno": 4932, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210409L]", "Aggregate": " Attributes [1]: [count#2210408L]", "Results": " [2]: [ip_address#2172241, count#2210409L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234"], "size": 13, "equiv": "0"}, "236": {"label": "Project", "notes": "", "children": [237], "parent": [235], "node_id": "(183) Project", "lineno": 4933, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235"], "size": 12, "equiv": "0"}, "237": {"label": "Filter", "notes": "", "children": [238], "parent": [236], "node_id": "(182) Filter", "lineno": 4934, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Condition": " : isnull(ip_whitelist_flg#2192618)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236"], "size": 11, "equiv": "0"}, "238": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [239, 243], "parent": [237], "node_id": "(181) SortMergeJoin", "lineno": 4935, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236", "237"], "size": 10, "equiv": "0"}, "239": {"label": "Sort", "notes": "", "children": [240], "parent": [238], "node_id": "(175) Sort", "lineno": 4936, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236", "237", "238"], "size": 4, "equiv": "0"}, "240": {"label": "Exchange", "notes": "", "children": [241], "parent": [239], "node_id": "(174) Exchange", "lineno": 4937, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1668994]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239"], "size": 3, "equiv": "0"}, "241": {"label": "InMemoryTableScan", "notes": "", "children": [242], "parent": [240], "node_id": "(173) InMemoryTableScan", "lineno": 4938, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239", "240"], "size": 2, "equiv": "3"}, "242": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [241], "node_id": "(174) InMemoryRelation", "lineno": 4939, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236", "237", "238", "239", "240", "241"], "size": 1, "equiv": "0"}, "243": {"label": "Sort", "notes": "", "children": [244], "parent": [238], "node_id": "(180) Sort", "lineno": 4950, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236", "237", "238"], "size": 5, "equiv": "4"}, "244": {"label": "Exchange", "notes": "", "children": [245], "parent": [243], "node_id": "(179) Exchange", "lineno": 4951, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1668995]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236", "237", "238", "243"], "size": 4, "equiv": "0"}, "245": {"label": "Project", "notes": "", "children": [246], "parent": [244], "node_id": "(178) Project", "lineno": 4952, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192618]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236", "237", "238", "243", "244"], "size": 3, "equiv": "0"}, "246": {"label": "Filter", "notes": "", "children": [247], "parent": [245], "node_id": "(177) Filter", "lineno": 4953, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236", "237", "238", "243", "244", "245"], "size": 2, "equiv": "0"}, "247": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [246], "node_id": "(176) Scan", "lineno": 4954, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "223", "224", "225", "226", "230", "231", "232", "233", "234", "235", "236", "237", "238", "243", "244", "245", "246"], "size": 1, "equiv": "0"}, "248": {"label": "Sort", "notes": "", "children": [249], "parent": [222], "node_id": "(198) Sort", "lineno": 4955, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222"], "size": 5, "equiv": "4"}, "249": {"label": "Exchange", "notes": "", "children": [250], "parent": [248], "node_id": "(197) Exchange", "lineno": 4956, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669014]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "248"], "size": 4, "equiv": "0"}, "250": {"label": "Project", "notes": "", "children": [251], "parent": [249], "node_id": "(196) Project", "lineno": 4957, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192601]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "248", "249"], "size": 3, "equiv": "0"}, "251": {"label": "Filter", "notes": "", "children": [252], "parent": [250], "node_id": "(195) Filter", "lineno": 4958, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "248", "249", "250"], "size": 2, "equiv": "0"}, "252": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [251], "node_id": "(194) Scan", "lineno": 4959, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "218", "219", "220", "221", "222", "248", "249", "250", "251"], "size": 1, "equiv": "0"}, "253": {"label": "Sort", "notes": "", "children": [254], "parent": [217], "node_id": "(208) Sort", "lineno": 4960, "detail": {"note": "Sort", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " [un#2192556 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217"], "size": 5, "equiv": "4"}, "254": {"label": "Exchange", "notes": "", "children": [255], "parent": [253], "node_id": "(207) Exchange", "lineno": 4961, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " hashpartitioning(un#2192556, 1000), ENSURE_REQUIREMENTS, [id=#1669023]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "253"], "size": 4, "equiv": "0"}, "255": {"label": "Project", "notes": "", "children": [256], "parent": [254], "node_id": "(206) Project", "lineno": 4962, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [userName#2175089 AS un#2192556]", "Input": " [2]: [userName#2175089, data_dt#2175091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "253", "254"], "size": 3, "equiv": "0"}, "256": {"label": "Filter", "notes": "", "children": [257], "parent": [255], "node_id": "(205) Filter", "lineno": 4963, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [userName#2175089, data_dt#2175091]", "Condition": " : isnotnull(userName#2175089)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "253", "254", "255"], "size": 2, "equiv": "0"}, "257": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [256], "node_id": "(204) Scan", "lineno": 4964, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [2]: [userName#2175089, data_dt#2175091]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/usr_distip_cnt_map]", "PartitionFilters:": " [isnotnull(data_dt#2175091), (data_dt#2175091 = 2022080317)]", "PushedFilters:": " [IsNotNull(userName)]", "ReadSchema:": " struct<userName:string>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "207", "208", "209", "210", "211", "212", "213", "214", "215", "216", "217", "253", "254", "255", "256"], "size": 1, "equiv": "0"}, "258": {"label": "Sort", "notes": "", "children": [259], "parent": [206], "node_id": "(268) Sort", "lineno": 4965, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, window#2194451, attempts_per_ip_5m_status#2194452L, dist_usr_5m_status#2194453L, dist_app_5m_status#2194454L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST, window#2194451 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206"], "size": 51, "equiv": "9"}, "259": {"label": "Exchange", "notes": "", "children": [260], "parent": [258], "node_id": "(267) Exchange", "lineno": 4966, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, window#2194451, attempts_per_ip_5m_status#2194452L, dist_usr_5m_status#2194453L, dist_app_5m_status#2194454L]", "Arguments:": " hashpartitioning(long_ip#2172242L, window#2194451, 1000), ENSURE_REQUIREMENTS, [id=#1669084]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258"], "size": 50, "equiv": "0"}, "260": {"label": "HashAggregate", "notes": "", "children": [261], "parent": [259], "node_id": "(266) HashAggregate", "lineno": 4967, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194462, window#2194366, first#2582019L, valueSet#2582020, count#2582022L, count#2582024L]", "Keys": " [3]: [long_ip#2172242L, tguard_status#2194462, window#2194366]", "Functions": " [3]: [finalmerge_first(merge first#2582019L, valueSet#2582020) AS first(if ((gid#2581757 = 0)) count(t.`long_ip`)#2581761L else null) ignore nulls#2581762L, finalmerge_count(merge count#2582022L) AS count(if ((gid#2581757 = 1)) __auto_generated_subquery_name.`username`#2581758 else null)#2194364L, finalmerge_count(merge count#2582024L) AS count(if ((gid#2581757 = 2)) t.`application_id`#2581759 else null)#2194365L]", "Aggregate": " Attributes [3]: [first(if ((gid#2581757 = 0)) count(t.`long_ip`)#2581761L else null) ignore nulls#2581762L, count(if ((gid#2581757 = 1)) __auto_generated_subquery_name.`username`#2581758 else null)#2194364L, count(if ((gid#2581757 = 2)) t.`application_id`#2581759 else null)#2194365L]", "Results": " [5]: [long_ip#2172242L, window#2194366 AS window#2194451, coalesce(first(if ((gid#2581757 = 0)) count(t.`long_ip`)#2581761L else null) ignore nulls#2581762L, 0) AS attempts_per_ip_5m_status#2194452L, count(if ((gid#2581757 = 1)) __auto_generated_subquery_name.`username`#2581758 else null)#2194364L AS dist_usr_5m_status#2194453L, count(if ((gid#2581757 = 2)) t.`application_id`#2581759 else null)#2194365L AS dist_app_5m_status#2194454L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259"], "size": 49, "equiv": "0"}, "261": {"label": "Exchange", "notes": "", "children": [262], "parent": [260], "node_id": "(265) Exchange", "lineno": 4968, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194462, window#2194366, first#2582019L, valueSet#2582020, count#2582022L, count#2582024L]", "Arguments:": " hashpartitioning(long_ip#2172242L, tguard_status#2194462, window#2194366, 1000), ENSURE_REQUIREMENTS, [id=#1669079]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260"], "size": 48, "equiv": "0"}, "262": {"label": "HashAggregate", "notes": "", "children": [263], "parent": [261], "node_id": "(264) HashAggregate", "lineno": 4969, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194462, window#2194366, __auto_generated_subquery_name.`username`#2581758, t.`application_id`#2581759, gid#2581757, count(t.`long_ip`)#2581761L]", "Keys": " [3]: [long_ip#2172242L, tguard_status#2194462, window#2194366]", "Functions": " [3]: [partial_first(if ((gid#2581757 = 0)) count(t.`long_ip`)#2581761L else null, true) AS (first#2582019L, valueSet#2582020), partial_count(if ((gid#2581757 = 1)) __auto_generated_subquery_name.`username`#2581758 else null) AS count#2582022L, partial_count(if ((gid#2581757 = 2)) t.`application_id`#2581759 else null) AS count#2582024L]", "Aggregate": " Attributes [4]: [first#2582017L, valueSet#2582018, count#2582021L, count#2582023L]", "Results": " [7]: [long_ip#2172242L, tguard_status#2194462, window#2194366, first#2582019L, valueSet#2582020, count#2582022L, count#2582024L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261"], "size": 47, "equiv": "0"}, "263": {"label": "HashAggregate", "notes": "", "children": [264], "parent": [262], "node_id": "(263) HashAggregate", "lineno": 4970, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194462, window#2194366, __auto_generated_subquery_name.`username`#2581758, t.`application_id`#2581759, gid#2581757, count#2582026L]", "Keys": " [6]: [long_ip#2172242L, tguard_status#2194462, window#2194366, __auto_generated_subquery_name.`username`#2581758, t.`application_id`#2581759, gid#2581757]", "Functions": " [1]: [finalmerge_count(merge count#2582026L) AS count(t.`long_ip`#2581760L)#2194360L]", "Aggregate": " Attributes [1]: [count(t.`long_ip`#2581760L)#2194360L]", "Results": " [7]: [long_ip#2172242L, tguard_status#2194462, window#2194366, __auto_generated_subquery_name.`username`#2581758, t.`application_id`#2581759, gid#2581757, count(t.`long_ip`#2581760L)#2194360L AS count(t.`long_ip`)#2581761L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262"], "size": 46, "equiv": "0"}, "264": {"label": "Exchange", "notes": "", "children": [265], "parent": [263], "node_id": "(262) Exchange", "lineno": 4971, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194462, window#2194366, __auto_generated_subquery_name.`username`#2581758, t.`application_id`#2581759, gid#2581757, count#2582026L]", "Arguments:": " hashpartitioning(long_ip#2172242L, tguard_status#2194462, window#2194366, __auto_generated_subquery_name.`username`#2581758, t.`application_id`#2581759, gid#2581757, 1000), ENSURE_REQUIREMENTS, [id=#1669075]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263"], "size": 45, "equiv": "0"}, "265": {"label": "HashAggregate", "notes": "", "children": [266], "parent": [264], "node_id": "(261) HashAggregate", "lineno": 4972, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194462, window#2194366, __auto_generated_subquery_name.`username`#2581758, t.`application_id`#2581759, gid#2581757, t.`long_ip`#2581760L]", "Keys": " [6]: [long_ip#2172242L, tguard_status#2194462, window#2194366, __auto_generated_subquery_name.`username`#2581758, t.`application_id`#2581759, gid#2581757]", "Functions": " [1]: [partial_count(t.`long_ip`#2581760L) AS count#2582026L]", "Aggregate": " Attributes [1]: [count#2582025L]", "Results": " [7]: [long_ip#2172242L, tguard_status#2194462, window#2194366, __auto_generated_subquery_name.`username`#2581758, t.`application_id`#2581759, gid#2581757, count#2582026L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264"], "size": 44, "equiv": "0"}, "266": {"label": "Expand", "notes": "", "children": [267], "parent": [265], "node_id": "(260) Expand", "lineno": 4973, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [window#2194366, long_ip#2172242L, username#2192593, application_id#2172243, tguard_status#2194462]", "Arguments:": " [ArrayBuffer(long_ip#2172242L, tguard_status#2194462, window#2194366, null, null, 0, long_ip#2172242L), ArrayBuffer(long_ip#2172242L, tguard_status#2194462, window#2194366, username#2192593, null, 1, null), ArrayBuffer(long_ip#2172242L, tguard_status#2194462, window#2194366, null, application_id#2172243, 2, null)], [long_ip#2172242L, tguard_status#2194462, window#2194366, __auto_generated_subquery_name.`username`#2581758, t.`application_id`#2581759, gid#2581757, t.`long_ip`#2581760L]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265"], "size": 43, "equiv": "7"}, "267": {"label": "Project", "notes": "", "children": [268], "parent": [266], "node_id": "(259) Project", "lineno": 4974, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 1) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 1) * 300000000) + 300000000), LongType, TimestampType)) AS window#2194366, long_ip#2172242L, username#2192593, application_id#2172243, tguard_status#2194462]", "Input": " [6]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194462, un#2192556]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266"], "size": 42, "equiv": "0"}, "268": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [269, 304], "parent": [267], "node_id": "(258) SortMergeJoin", "lineno": 4975, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [username#2192593]", "Right": " keys [1]: [un#2192556]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267"], "size": 41, "equiv": "0"}, "269": {"label": "Sort", "notes": "", "children": [270], "parent": [268], "node_id": "(252) Sort", "lineno": 4976, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194462]", "Arguments:": " [username#2192593 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268"], "size": 35, "equiv": "0"}, "270": {"label": "Exchange", "notes": "", "children": [271], "parent": [269], "node_id": "(251) Exchange", "lineno": 4977, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194462]", "Arguments:": " hashpartitioning(username#2192593, 1000), ENSURE_REQUIREMENTS, [id=#1669066]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269"], "size": 34, "equiv": "0"}, "271": {"label": "Project", "notes": "", "children": [272], "parent": [270], "node_id": "(250) Project", "lineno": 4978, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, userName#2172244 AS username#2192593, application_id#2172243, transaction_date_time#2172247, status#2172245 AS tguard_status#2194462]", "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270"], "size": 33, "equiv": "0"}, "272": {"label": "Filter", "notes": "", "children": [273], "parent": [271], "node_id": "(249) Filter", "lineno": 4979, "detail": {"note": "Filter", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Condition": " : isnull(ip_whitelist_flg#2192601)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271"], "size": 32, "equiv": "0"}, "273": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [274, 299], "parent": [272], "node_id": "(248) SortMergeJoin", "lineno": 4980, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272"], "size": 31, "equiv": "0"}, "274": {"label": "Sort", "notes": "", "children": [275], "parent": [273], "node_id": "(242) Sort", "lineno": 4981, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273"], "size": 25, "equiv": "0"}, "275": {"label": "Exchange", "notes": "", "children": [276], "parent": [274], "node_id": "(241) Exchange", "lineno": 4982, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669057]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274"], "size": 24, "equiv": "0"}, "276": {"label": "Project", "notes": "", "children": [277], "parent": [275], "node_id": "(240) Project", "lineno": 4983, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275"], "size": 23, "equiv": "0"}, "277": {"label": "BroadcastHashJoin LeftAnti BuildRight", "notes": "", "children": [278, 281], "parent": [276], "node_id": "(239) BroadcastHashJoin", "lineno": 4984, "detail": {"note": "BroadcastHashJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2192616]", "Join": " condition: None"}, "full_label": "BroadcastHashJoin LeftAnti BuildRight", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276"], "size": 22, "equiv": "0"}, "278": {"label": "Filter", "notes": "", "children": [279], "parent": [277], "node_id": "(221) Filter", "lineno": 4985, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Condition": " : (isnotnull(transaction_date_time#2172247) AND (status#2172245 = SUCCESS))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277"], "size": 3, "equiv": "8"}, "279": {"label": "InMemoryTableScan", "notes": "", "children": [280], "parent": [278], "node_id": "(220) InMemoryTableScan", "lineno": 4986, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247], [isnotnull(transaction_date_time#2172247), (status#2172245 = SUCCESS)]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "278"], "size": 2, "equiv": "3"}, "280": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [279], "node_id": "(221) InMemoryRelation", "lineno": 4987, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "278", "279"], "size": 1, "equiv": "0"}, "281": {"label": "BroadcastExchange", "notes": "", "children": [282], "parent": [277], "node_id": "(238) BroadcastExchange", "lineno": 4998, "detail": {"note": "BroadcastExchange", "lineno": 5461, "Input": " [1]: [ip_address#2192616]", "Arguments:": " HashedRelationBroadcastMode(List(input[0, string, true]),true), [id=#1669052]"}, "full_label": "BroadcastExchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277"], "size": 18, "equiv": "1"}, "282": {"label": "Project", "notes": "", "children": [283], "parent": [281], "node_id": "(237) Project", "lineno": 4999, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2192616]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281"], "size": 17, "equiv": "2"}, "283": {"label": "Filter", "notes": "", "children": [284], "parent": [282], "node_id": "(236) Filter", "lineno": 5000, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]", "Condition": " : (ip_trans_cnt#2192615L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282"], "size": 16, "equiv": "0"}, "284": {"label": "HashAggregate", "notes": "", "children": [285], "parent": [283], "node_id": "(235) HashAggregate", "lineno": 5001, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210409L) AS count(1)#2192632L]", "Aggregate": " Attributes [1]: [count(1)#2192632L]", "Results": " [2]: [ip_address#2172241, count(1)#2192632L AS ip_trans_cnt#2192615L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283"], "size": 15, "equiv": "0"}, "285": {"label": "Exchange", "notes": "", "children": [286], "parent": [284], "node_id": "(234) Exchange", "lineno": 5002, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1669047]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284"], "size": 14, "equiv": "0"}, "286": {"label": "HashAggregate", "notes": "", "children": [287], "parent": [285], "node_id": "(233) HashAggregate", "lineno": 5003, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210409L]", "Aggregate": " Attributes [1]: [count#2210408L]", "Results": " [2]: [ip_address#2172241, count#2210409L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285"], "size": 13, "equiv": "0"}, "287": {"label": "Project", "notes": "", "children": [288], "parent": [286], "node_id": "(232) Project", "lineno": 5004, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286"], "size": 12, "equiv": "0"}, "288": {"label": "Filter", "notes": "", "children": [289], "parent": [287], "node_id": "(231) Filter", "lineno": 5005, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Condition": " : isnull(ip_whitelist_flg#2192618)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287"], "size": 11, "equiv": "0"}, "289": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [290, 294], "parent": [288], "node_id": "(230) SortMergeJoin", "lineno": 5006, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287", "288"], "size": 10, "equiv": "0"}, "290": {"label": "Sort", "notes": "", "children": [291], "parent": [289], "node_id": "(224) Sort", "lineno": 5007, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287", "288", "289"], "size": 4, "equiv": "0"}, "291": {"label": "Exchange", "notes": "", "children": [292], "parent": [290], "node_id": "(223) Exchange", "lineno": 5008, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669038]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287", "288", "289", "290"], "size": 3, "equiv": "0"}, "292": {"label": "InMemoryTableScan", "notes": "", "children": [293], "parent": [291], "node_id": "(222) InMemoryTableScan", "lineno": 5009, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287", "288", "289", "290", "291"], "size": 2, "equiv": "3"}, "293": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [292], "node_id": "(223) InMemoryRelation", "lineno": 5010, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287", "288", "289", "290", "291", "292"], "size": 1, "equiv": "0"}, "294": {"label": "Sort", "notes": "", "children": [295], "parent": [289], "node_id": "(229) Sort", "lineno": 5021, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287", "288", "289"], "size": 5, "equiv": "4"}, "295": {"label": "Exchange", "notes": "", "children": [296], "parent": [294], "node_id": "(228) Exchange", "lineno": 5022, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669039]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287", "288", "289", "294"], "size": 4, "equiv": "0"}, "296": {"label": "Project", "notes": "", "children": [297], "parent": [295], "node_id": "(227) Project", "lineno": 5023, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192618]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287", "288", "289", "294", "295"], "size": 3, "equiv": "0"}, "297": {"label": "Filter", "notes": "", "children": [298], "parent": [296], "node_id": "(226) Filter", "lineno": 5024, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287", "288", "289", "294", "295", "296"], "size": 2, "equiv": "0"}, "298": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [297], "node_id": "(225) Scan", "lineno": 5025, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "274", "275", "276", "277", "281", "282", "283", "284", "285", "286", "287", "288", "289", "294", "295", "296", "297"], "size": 1, "equiv": "0"}, "299": {"label": "Sort", "notes": "", "children": [300], "parent": [273], "node_id": "(247) Sort", "lineno": 5026, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273"], "size": 5, "equiv": "4"}, "300": {"label": "Exchange", "notes": "", "children": [301], "parent": [299], "node_id": "(246) Exchange", "lineno": 5027, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669058]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "299"], "size": 4, "equiv": "0"}, "301": {"label": "Project", "notes": "", "children": [302], "parent": [300], "node_id": "(245) Project", "lineno": 5028, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192601]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "299", "300"], "size": 3, "equiv": "0"}, "302": {"label": "Filter", "notes": "", "children": [303], "parent": [301], "node_id": "(244) Filter", "lineno": 5029, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "299", "300", "301"], "size": 2, "equiv": "0"}, "303": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [302], "node_id": "(243) Scan", "lineno": 5030, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "269", "270", "271", "272", "273", "299", "300", "301", "302"], "size": 1, "equiv": "0"}, "304": {"label": "Sort", "notes": "", "children": [305], "parent": [268], "node_id": "(257) Sort", "lineno": 5031, "detail": {"note": "Sort", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " [un#2192556 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268"], "size": 5, "equiv": "4"}, "305": {"label": "Exchange", "notes": "", "children": [306], "parent": [304], "node_id": "(256) Exchange", "lineno": 5032, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " hashpartitioning(un#2192556, 1000), ENSURE_REQUIREMENTS, [id=#1669067]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "304"], "size": 4, "equiv": "0"}, "306": {"label": "Project", "notes": "", "children": [307], "parent": [305], "node_id": "(255) Project", "lineno": 5033, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [userName#2175089 AS un#2192556]", "Input": " [2]: [userName#2175089, data_dt#2175091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "304", "305"], "size": 3, "equiv": "0"}, "307": {"label": "Filter", "notes": "", "children": [308], "parent": [306], "node_id": "(254) Filter", "lineno": 5034, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [userName#2175089, data_dt#2175091]", "Condition": " : isnotnull(userName#2175089)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "304", "305", "306"], "size": 2, "equiv": "0"}, "308": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [307], "node_id": "(253) Scan", "lineno": 5035, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [2]: [userName#2175089, data_dt#2175091]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/usr_distip_cnt_map]", "PartitionFilters:": " [isnotnull(data_dt#2175091), (data_dt#2175091 = 2022080317)]", "PushedFilters:": " [IsNotNull(userName)]", "ReadSchema:": " struct<userName:string>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "202", "203", "204", "205", "206", "258", "259", "260", "261", "262", "263", "264", "265", "266", "267", "268", "304", "305", "306", "307"], "size": 1, "equiv": "0"}, "309": {"label": "Sort", "notes": "", "children": [310], "parent": [13], "node_id": "(384) Sort", "lineno": 5036, "detail": {"note": "Sort", "lineno": 5461, "Input": " [8]: [long_ip#2194482L, _gen_alias_2581294#2581294, 15m_success_count#2194484L, 15m_failed_count#2194485L, 15m_suc_dist_usr#2194486L, 15m_fail_dist_usr#2194487L, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L]", "Arguments:": " [long_ip#2194482L ASC NULLS FIRST, _gen_alias_2581294#2581294 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13"], "size": 113, "equiv": "10"}, "310": {"label": "Exchange", "notes": "", "children": [311], "parent": [309], "node_id": "(383) Exchange", "lineno": 5037, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [8]: [long_ip#2194482L, _gen_alias_2581294#2581294, 15m_success_count#2194484L, 15m_failed_count#2194485L, 15m_suc_dist_usr#2194486L, 15m_fail_dist_usr#2194487L, 15m_suc_dist_app#2194488L, 15m_fail_dist_app#2194489L]", "Arguments:": " hashpartitioning(long_ip#2194482L, _gen_alias_2581294#2581294, 1000), ENSURE_REQUIREMENTS, [id=#1669201]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309"], "size": 112, "equiv": "0"}, "311": {"label": "Project", "notes": "", "children": [312], "parent": [310], "node_id": "(382) Project", "lineno": 5038, "detail": {"note": "Project", "lineno": 5461, "Output": " [8]: [coalesce(long_ip#2192570L, long_ip#2172242L) AS long_ip#2194482L, coalesce(window#2194401, window#2194490).end AS _gen_alias_2581294#2581294, coalesce(attempts_per_ip_15m_status#2194491L, 0) AS 15m_success_count#2194484L, coalesce(attempts_per_ip_15m_status#2194396L, 0) AS 15m_failed_count#2194485L, coalesce(dist_usr_15m_status#2194492L, 0) AS 15m_suc_dist_usr#2194486L, coalesce(dist_usr_15m_status#2194397L, 0) AS 15m_fail_dist_usr#2194487L, coalesce(dist_app_15m_status#2194493L, 0) AS 15m_suc_dist_app#2194488L, coalesce(dist_app_15m_status#2194398L, 0) AS 15m_fail_dist_app#2194489L]", "Input": " [10]: [long_ip#2192570L, window#2194401, attempts_per_ip_15m_status#2194396L, dist_usr_15m_status#2194397L, dist_app_15m_status#2194398L, long_ip#2172242L, window#2194490, attempts_per_ip_15m_status#2194491L, dist_usr_15m_status#2194492L, dist_app_15m_status#2194493L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310"], "size": 111, "equiv": "0"}, "312": {"label": "Filter", "notes": "", "children": [313], "parent": [311], "node_id": "(381) Filter", "lineno": 5039, "detail": {"note": "Filter", "lineno": 5461, "Input": " [10]: [long_ip#2192570L, window#2194401, attempts_per_ip_15m_status#2194396L, dist_usr_15m_status#2194397L, dist_app_15m_status#2194398L, long_ip#2172242L, window#2194490, attempts_per_ip_15m_status#2194491L, dist_usr_15m_status#2194492L, dist_app_15m_status#2194493L]", "Condition": " : (isnotnull(coalesce(long_ip#2192570L, long_ip#2172242L)) AND isnotnull(coalesce(window#2194401, window#2194490).end))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311"], "size": 110, "equiv": "0"}, "313": {"label": "SortMergeJoin FullOuter", "notes": "", "children": [314, 368], "parent": [312], "node_id": "(380) SortMergeJoin", "lineno": 5040, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [2]: [long_ip#2192570L, window#2194401]", "Right": " keys [2]: [long_ip#2172242L, window#2194490]", "Join": " condition: None"}, "full_label": "SortMergeJoin FullOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312"], "size": 109, "equiv": "0"}, "314": {"label": "Sort", "notes": "", "children": [315], "parent": [313], "node_id": "(327) Sort", "lineno": 5041, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, window#2194401, attempts_per_ip_15m_status#2194396L, dist_usr_15m_status#2194397L, dist_app_15m_status#2194398L]", "Arguments:": " [long_ip#2192570L ASC NULLS FIRST, window#2194401 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313"], "size": 54, "equiv": "11"}, "315": {"label": "Exchange", "notes": "", "children": [316], "parent": [314], "node_id": "(326) Exchange", "lineno": 5042, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, window#2194401, attempts_per_ip_15m_status#2194396L, dist_usr_15m_status#2194397L, dist_app_15m_status#2194398L]", "Arguments:": " hashpartitioning(long_ip#2192570L, window#2194401, 1000), ENSURE_REQUIREMENTS, [id=#1669192]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314"], "size": 53, "equiv": "0"}, "316": {"label": "HashAggregate", "notes": "", "children": [317], "parent": [315], "node_id": "(325) HashAggregate", "lineno": 5043, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194401, first#2582029L, valueSet#2582030, count#2582032L, count#2582034L]", "Keys": " [3]: [long_ip#2192570L, tguard_status#2192576, window#2194401]", "Functions": " [3]: [finalmerge_first(merge first#2582029L, valueSet#2582030) AS first(if ((gid#2581763 = 0)) count(t.`long_ip`)#2581767L else null) ignore nulls#2581768L, finalmerge_count(merge count#2582032L) AS count(if ((gid#2581763 = 1)) __auto_generated_subquery_name.`username`#2581764 else null)#2194399L, finalmerge_count(merge count#2582034L) AS count(if ((gid#2581763 = 2)) t.`application_id`#2581765 else null)#2194400L]", "Aggregate": " Attributes [3]: [first(if ((gid#2581763 = 0)) count(t.`long_ip`)#2581767L else null) ignore nulls#2581768L, count(if ((gid#2581763 = 1)) __auto_generated_subquery_name.`username`#2581764 else null)#2194399L, count(if ((gid#2581763 = 2)) t.`application_id`#2581765 else null)#2194400L]", "Results": " [5]: [long_ip#2192570L, window#2194401, coalesce(first(if ((gid#2581763 = 0)) count(t.`long_ip`)#2581767L else null) ignore nulls#2581768L, 0) AS attempts_per_ip_15m_status#2194396L, count(if ((gid#2581763 = 1)) __auto_generated_subquery_name.`username`#2581764 else null)#2194399L AS dist_usr_15m_status#2194397L, count(if ((gid#2581763 = 2)) t.`application_id`#2581765 else null)#2194400L AS dist_app_15m_status#2194398L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315"], "size": 52, "equiv": "0"}, "317": {"label": "Exchange", "notes": "", "children": [318], "parent": [316], "node_id": "(324) Exchange", "lineno": 5044, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194401, first#2582029L, valueSet#2582030, count#2582032L, count#2582034L]", "Arguments:": " hashpartitioning(long_ip#2192570L, tguard_status#2192576, window#2194401, 1000), ENSURE_REQUIREMENTS, [id=#1669141]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316"], "size": 51, "equiv": "0"}, "318": {"label": "HashAggregate", "notes": "", "children": [319], "parent": [317], "node_id": "(323) HashAggregate", "lineno": 5045, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194401, __auto_generated_subquery_name.`username`#2581764, t.`application_id`#2581765, gid#2581763, count(t.`long_ip`)#2581767L]", "Keys": " [3]: [long_ip#2192570L, tguard_status#2192576, window#2194401]", "Functions": " [3]: [partial_first(if ((gid#2581763 = 0)) count(t.`long_ip`)#2581767L else null, true) AS (first#2582029L, valueSet#2582030), partial_count(if ((gid#2581763 = 1)) __auto_generated_subquery_name.`username`#2581764 else null) AS count#2582032L, partial_count(if ((gid#2581763 = 2)) t.`application_id`#2581765 else null) AS count#2582034L]", "Aggregate": " Attributes [4]: [first#2582027L, valueSet#2582028, count#2582031L, count#2582033L]", "Results": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194401, first#2582029L, valueSet#2582030, count#2582032L, count#2582034L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317"], "size": 50, "equiv": "0"}, "319": {"label": "HashAggregate", "notes": "", "children": [320], "parent": [318], "node_id": "(322) HashAggregate", "lineno": 5046, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194401, __auto_generated_subquery_name.`username`#2581764, t.`application_id`#2581765, gid#2581763, count#2582036L]", "Keys": " [6]: [long_ip#2192570L, tguard_status#2192576, window#2194401, __auto_generated_subquery_name.`username`#2581764, t.`application_id`#2581765, gid#2581763]", "Functions": " [1]: [finalmerge_count(merge count#2582036L) AS count(t.`long_ip`#2581766L)#2194395L]", "Aggregate": " Attributes [1]: [count(t.`long_ip`#2581766L)#2194395L]", "Results": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194401, __auto_generated_subquery_name.`username`#2581764, t.`application_id`#2581765, gid#2581763, count(t.`long_ip`#2581766L)#2194395L AS count(t.`long_ip`)#2581767L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318"], "size": 49, "equiv": "0"}, "320": {"label": "Exchange", "notes": "", "children": [321], "parent": [319], "node_id": "(321) Exchange", "lineno": 5047, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194401, __auto_generated_subquery_name.`username`#2581764, t.`application_id`#2581765, gid#2581763, count#2582036L]", "Arguments:": " hashpartitioning(long_ip#2192570L, tguard_status#2192576, window#2194401, __auto_generated_subquery_name.`username`#2581764, t.`application_id`#2581765, gid#2581763, 1000), ENSURE_REQUIREMENTS, [id=#1669137]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319"], "size": 48, "equiv": "0"}, "321": {"label": "HashAggregate", "notes": "", "children": [322], "parent": [320], "node_id": "(320) HashAggregate", "lineno": 5048, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194401, __auto_generated_subquery_name.`username`#2581764, t.`application_id`#2581765, gid#2581763, t.`long_ip`#2581766L]", "Keys": " [6]: [long_ip#2192570L, tguard_status#2192576, window#2194401, __auto_generated_subquery_name.`username`#2581764, t.`application_id`#2581765, gid#2581763]", "Functions": " [1]: [partial_count(t.`long_ip`#2581766L) AS count#2582036L]", "Aggregate": " Attributes [1]: [count#2582035L]", "Results": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194401, __auto_generated_subquery_name.`username`#2581764, t.`application_id`#2581765, gid#2581763, count#2582036L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320"], "size": 47, "equiv": "0"}, "322": {"label": "Expand", "notes": "", "children": [323], "parent": [321], "node_id": "(319) Expand", "lineno": 5049, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [window#2194401, long_ip#2192570L, username#2192593, application_id#2172243, tguard_status#2192576]", "Arguments:": " [ArrayBuffer(long_ip#2192570L, tguard_status#2192576, window#2194401, null, null, 0, long_ip#2192570L), ArrayBuffer(long_ip#2192570L, tguard_status#2192576, window#2194401, username#2192593, null, 1, null), ArrayBuffer(long_ip#2192570L, tguard_status#2192576, window#2194401, null, application_id#2172243, 2, null)], [long_ip#2192570L, tguard_status#2192576, window#2194401, __auto_generated_subquery_name.`username`#2581764, t.`application_id`#2581765, gid#2581763, t.`long_ip`#2581766L]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321"], "size": 46, "equiv": "6"}, "323": {"label": "Project", "notes": "", "children": [324], "parent": [322], "node_id": "(318) Project", "lineno": 5050, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [window#2194401, long_ip#2192570L, username#2192593, application_id#2172243, tguard_status#2192576]", "Input": " [6]: [window#2194401, long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322"], "size": 45, "equiv": "0"}, "324": {"label": "Filter", "notes": "", "children": [325], "parent": [323], "node_id": "(317) Filter", "lineno": 5051, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [window#2194401, long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Condition": " : ((isnotnull(window#2194401) AND (transaction_date_time#2172247 >= window#2194401.start)) AND (transaction_date_time#2172247 < window#2194401.end))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323"], "size": 44, "equiv": "0"}, "325": {"label": "Expand", "notes": "", "children": [326], "parent": [324], "node_id": "(316) Expand", "lineno": 5052, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Arguments:": " [List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 3) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 3) * 300000000) + 900000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 3) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 3) * 300000000) + 900000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 3) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 3) * 300000000) + 900000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576)], [window#2194401, long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324"], "size": 43, "equiv": "7"}, "326": {"label": "Project", "notes": "", "children": [327], "parent": [325], "node_id": "(315) Project", "lineno": 5053, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Input": " [6]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576, un#2192556]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325"], "size": 42, "equiv": "0"}, "327": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [328, 363], "parent": [326], "node_id": "(314) SortMergeJoin", "lineno": 5054, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [username#2192593]", "Right": " keys [1]: [un#2192556]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326"], "size": 41, "equiv": "0"}, "328": {"label": "Sort", "notes": "", "children": [329], "parent": [327], "node_id": "(308) Sort", "lineno": 5055, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Arguments:": " [username#2192593 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327"], "size": 35, "equiv": "0"}, "329": {"label": "Exchange", "notes": "", "children": [330], "parent": [328], "node_id": "(307) Exchange", "lineno": 5056, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Arguments:": " hashpartitioning(username#2192593, 1000), ENSURE_REQUIREMENTS, [id=#1669125]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328"], "size": 34, "equiv": "0"}, "330": {"label": "Project", "notes": "", "children": [331], "parent": [329], "node_id": "(306) Project", "lineno": 5057, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L AS long_ip#2192570L, userName#2172244 AS username#2192593, application_id#2172243, transaction_date_time#2172247, status#2172245 AS tguard_status#2192576]", "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329"], "size": 33, "equiv": "0"}, "331": {"label": "Filter", "notes": "", "children": [332], "parent": [330], "node_id": "(305) Filter", "lineno": 5058, "detail": {"note": "Filter", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Condition": " : isnull(ip_whitelist_flg#2192601)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330"], "size": 32, "equiv": "0"}, "332": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [333, 358], "parent": [331], "node_id": "(304) SortMergeJoin", "lineno": 5059, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331"], "size": 31, "equiv": "0"}, "333": {"label": "Sort", "notes": "", "children": [334], "parent": [332], "node_id": "(298) Sort", "lineno": 5060, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332"], "size": 25, "equiv": "0"}, "334": {"label": "Exchange", "notes": "", "children": [335], "parent": [333], "node_id": "(297) Exchange", "lineno": 5061, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669116]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333"], "size": 24, "equiv": "0"}, "335": {"label": "Project", "notes": "", "children": [336], "parent": [334], "node_id": "(296) Project", "lineno": 5062, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334"], "size": 23, "equiv": "0"}, "336": {"label": "BroadcastHashJoin LeftAnti BuildRight", "notes": "", "children": [337, 340], "parent": [335], "node_id": "(295) BroadcastHashJoin", "lineno": 5063, "detail": {"note": "BroadcastHashJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2192616]", "Join": " condition: None"}, "full_label": "BroadcastHashJoin LeftAnti BuildRight", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335"], "size": 22, "equiv": "0"}, "337": {"label": "Filter", "notes": "", "children": [338], "parent": [336], "node_id": "(277) Filter", "lineno": 5064, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Condition": " : ((status#2172245 = FAILED) AND isnotnull(transaction_date_time#2172247))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336"], "size": 3, "equiv": "8"}, "338": {"label": "InMemoryTableScan", "notes": "", "children": [339], "parent": [337], "node_id": "(276) InMemoryTableScan", "lineno": 5065, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247], [(status#2172245 = FAILED), isnotnull(transaction_date_time#2172247)]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "337"], "size": 2, "equiv": "3"}, "339": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [338], "node_id": "(277) InMemoryRelation", "lineno": 5066, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "337", "338"], "size": 1, "equiv": "0"}, "340": {"label": "BroadcastExchange", "notes": "", "children": [341], "parent": [336], "node_id": "(294) BroadcastExchange", "lineno": 5077, "detail": {"note": "BroadcastExchange", "lineno": 5461, "Input": " [1]: [ip_address#2192616]", "Arguments:": " HashedRelationBroadcastMode(List(input[0, string, true]),true), [id=#1669111]"}, "full_label": "BroadcastExchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336"], "size": 18, "equiv": "1"}, "341": {"label": "Project", "notes": "", "children": [342], "parent": [340], "node_id": "(293) Project", "lineno": 5078, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2192616]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340"], "size": 17, "equiv": "2"}, "342": {"label": "Filter", "notes": "", "children": [343], "parent": [341], "node_id": "(292) Filter", "lineno": 5079, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]", "Condition": " : (ip_trans_cnt#2192615L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341"], "size": 16, "equiv": "0"}, "343": {"label": "HashAggregate", "notes": "", "children": [344], "parent": [342], "node_id": "(291) HashAggregate", "lineno": 5080, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210409L) AS count(1)#2192632L]", "Aggregate": " Attributes [1]: [count(1)#2192632L]", "Results": " [2]: [ip_address#2172241, count(1)#2192632L AS ip_trans_cnt#2192615L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342"], "size": 15, "equiv": "0"}, "344": {"label": "Exchange", "notes": "", "children": [345], "parent": [343], "node_id": "(290) Exchange", "lineno": 5081, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1669106]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343"], "size": 14, "equiv": "0"}, "345": {"label": "HashAggregate", "notes": "", "children": [346], "parent": [344], "node_id": "(289) HashAggregate", "lineno": 5082, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210409L]", "Aggregate": " Attributes [1]: [count#2210408L]", "Results": " [2]: [ip_address#2172241, count#2210409L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344"], "size": 13, "equiv": "0"}, "346": {"label": "Project", "notes": "", "children": [347], "parent": [345], "node_id": "(288) Project", "lineno": 5083, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345"], "size": 12, "equiv": "0"}, "347": {"label": "Filter", "notes": "", "children": [348], "parent": [346], "node_id": "(287) Filter", "lineno": 5084, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Condition": " : isnull(ip_whitelist_flg#2192618)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346"], "size": 11, "equiv": "0"}, "348": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [349, 353], "parent": [347], "node_id": "(286) SortMergeJoin", "lineno": 5085, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346", "347"], "size": 10, "equiv": "0"}, "349": {"label": "Sort", "notes": "", "children": [350], "parent": [348], "node_id": "(280) Sort", "lineno": 5086, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346", "347", "348"], "size": 4, "equiv": "0"}, "350": {"label": "Exchange", "notes": "", "children": [351], "parent": [349], "node_id": "(279) Exchange", "lineno": 5087, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669097]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346", "347", "348", "349"], "size": 3, "equiv": "0"}, "351": {"label": "InMemoryTableScan", "notes": "", "children": [352], "parent": [350], "node_id": "(278) InMemoryTableScan", "lineno": 5088, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346", "347", "348", "349", "350"], "size": 2, "equiv": "3"}, "352": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [351], "node_id": "(279) InMemoryRelation", "lineno": 5089, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346", "347", "348", "349", "350", "351"], "size": 1, "equiv": "0"}, "353": {"label": "Sort", "notes": "", "children": [354], "parent": [348], "node_id": "(285) Sort", "lineno": 5100, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346", "347", "348"], "size": 5, "equiv": "4"}, "354": {"label": "Exchange", "notes": "", "children": [355], "parent": [353], "node_id": "(284) Exchange", "lineno": 5101, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669098]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346", "347", "348", "353"], "size": 4, "equiv": "0"}, "355": {"label": "Project", "notes": "", "children": [356], "parent": [354], "node_id": "(283) Project", "lineno": 5102, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192618]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346", "347", "348", "353", "354"], "size": 3, "equiv": "0"}, "356": {"label": "Filter", "notes": "", "children": [357], "parent": [355], "node_id": "(282) Filter", "lineno": 5103, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346", "347", "348", "353", "354", "355"], "size": 2, "equiv": "0"}, "357": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [356], "node_id": "(281) Scan", "lineno": 5104, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "333", "334", "335", "336", "340", "341", "342", "343", "344", "345", "346", "347", "348", "353", "354", "355", "356"], "size": 1, "equiv": "0"}, "358": {"label": "Sort", "notes": "", "children": [359], "parent": [332], "node_id": "(303) Sort", "lineno": 5105, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332"], "size": 5, "equiv": "4"}, "359": {"label": "Exchange", "notes": "", "children": [360], "parent": [358], "node_id": "(302) Exchange", "lineno": 5106, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669117]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "358"], "size": 4, "equiv": "0"}, "360": {"label": "Project", "notes": "", "children": [361], "parent": [359], "node_id": "(301) Project", "lineno": 5107, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192601]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "358", "359"], "size": 3, "equiv": "0"}, "361": {"label": "Filter", "notes": "", "children": [362], "parent": [360], "node_id": "(300) Filter", "lineno": 5108, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "358", "359", "360"], "size": 2, "equiv": "0"}, "362": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [361], "node_id": "(299) Scan", "lineno": 5109, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "328", "329", "330", "331", "332", "358", "359", "360", "361"], "size": 1, "equiv": "0"}, "363": {"label": "Sort", "notes": "", "children": [364], "parent": [327], "node_id": "(313) Sort", "lineno": 5110, "detail": {"note": "Sort", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " [un#2192556 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327"], "size": 5, "equiv": "4"}, "364": {"label": "Exchange", "notes": "", "children": [365], "parent": [363], "node_id": "(312) Exchange", "lineno": 5111, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " hashpartitioning(un#2192556, 1000), ENSURE_REQUIREMENTS, [id=#1669126]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "363"], "size": 4, "equiv": "0"}, "365": {"label": "Project", "notes": "", "children": [366], "parent": [364], "node_id": "(311) Project", "lineno": 5112, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [userName#2175089 AS un#2192556]", "Input": " [2]: [userName#2175089, data_dt#2175091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "363", "364"], "size": 3, "equiv": "0"}, "366": {"label": "Filter", "notes": "", "children": [367], "parent": [365], "node_id": "(310) Filter", "lineno": 5113, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [userName#2175089, data_dt#2175091]", "Condition": " : isnotnull(userName#2175089)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "363", "364", "365"], "size": 2, "equiv": "0"}, "367": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [366], "node_id": "(309) Scan", "lineno": 5114, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [2]: [userName#2175089, data_dt#2175091]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/usr_distip_cnt_map]", "PartitionFilters:": " [isnotnull(data_dt#2175091), (data_dt#2175091 = 2022080317)]", "PushedFilters:": " [IsNotNull(userName)]", "ReadSchema:": " struct<userName:string>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "314", "315", "316", "317", "318", "319", "320", "321", "322", "323", "324", "325", "326", "327", "363", "364", "365", "366"], "size": 1, "equiv": "0"}, "368": {"label": "Sort", "notes": "", "children": [369], "parent": [313], "node_id": "(379) Sort", "lineno": 5115, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, window#2194490, attempts_per_ip_15m_status#2194491L, dist_usr_15m_status#2194492L, dist_app_15m_status#2194493L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST, window#2194490 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313"], "size": 54, "equiv": "11"}, "369": {"label": "Exchange", "notes": "", "children": [370], "parent": [368], "node_id": "(378) Exchange", "lineno": 5116, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, window#2194490, attempts_per_ip_15m_status#2194491L, dist_usr_15m_status#2194492L, dist_app_15m_status#2194493L]", "Arguments:": " hashpartitioning(long_ip#2172242L, window#2194490, 1000), ENSURE_REQUIREMENTS, [id=#1669193]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368"], "size": 53, "equiv": "0"}, "370": {"label": "HashAggregate", "notes": "", "children": [371], "parent": [369], "node_id": "(377) HashAggregate", "lineno": 5117, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194501, window#2194401, first#2582039L, valueSet#2582040, count#2582042L, count#2582044L]", "Keys": " [3]: [long_ip#2172242L, tguard_status#2194501, window#2194401]", "Functions": " [3]: [finalmerge_first(merge first#2582039L, valueSet#2582040) AS first(if ((gid#2581769 = 0)) count(t.`long_ip`)#2581773L else null) ignore nulls#2581774L, finalmerge_count(merge count#2582042L) AS count(if ((gid#2581769 = 1)) __auto_generated_subquery_name.`username`#2581770 else null)#2194399L, finalmerge_count(merge count#2582044L) AS count(if ((gid#2581769 = 2)) t.`application_id`#2581771 else null)#2194400L]", "Aggregate": " Attributes [3]: [first(if ((gid#2581769 = 0)) count(t.`long_ip`)#2581773L else null) ignore nulls#2581774L, count(if ((gid#2581769 = 1)) __auto_generated_subquery_name.`username`#2581770 else null)#2194399L, count(if ((gid#2581769 = 2)) t.`application_id`#2581771 else null)#2194400L]", "Results": " [5]: [long_ip#2172242L, window#2194401 AS window#2194490, coalesce(first(if ((gid#2581769 = 0)) count(t.`long_ip`)#2581773L else null) ignore nulls#2581774L, 0) AS attempts_per_ip_15m_status#2194491L, count(if ((gid#2581769 = 1)) __auto_generated_subquery_name.`username`#2581770 else null)#2194399L AS dist_usr_15m_status#2194492L, count(if ((gid#2581769 = 2)) t.`application_id`#2581771 else null)#2194400L AS dist_app_15m_status#2194493L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369"], "size": 52, "equiv": "0"}, "371": {"label": "Exchange", "notes": "", "children": [372], "parent": [370], "node_id": "(376) Exchange", "lineno": 5118, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194501, window#2194401, first#2582039L, valueSet#2582040, count#2582042L, count#2582044L]", "Arguments:": " hashpartitioning(long_ip#2172242L, tguard_status#2194501, window#2194401, 1000), ENSURE_REQUIREMENTS, [id=#1669188]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370"], "size": 51, "equiv": "0"}, "372": {"label": "HashAggregate", "notes": "", "children": [373], "parent": [371], "node_id": "(375) HashAggregate", "lineno": 5119, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194501, window#2194401, __auto_generated_subquery_name.`username`#2581770, t.`application_id`#2581771, gid#2581769, count(t.`long_ip`)#2581773L]", "Keys": " [3]: [long_ip#2172242L, tguard_status#2194501, window#2194401]", "Functions": " [3]: [partial_first(if ((gid#2581769 = 0)) count(t.`long_ip`)#2581773L else null, true) AS (first#2582039L, valueSet#2582040), partial_count(if ((gid#2581769 = 1)) __auto_generated_subquery_name.`username`#2581770 else null) AS count#2582042L, partial_count(if ((gid#2581769 = 2)) t.`application_id`#2581771 else null) AS count#2582044L]", "Aggregate": " Attributes [4]: [first#2582037L, valueSet#2582038, count#2582041L, count#2582043L]", "Results": " [7]: [long_ip#2172242L, tguard_status#2194501, window#2194401, first#2582039L, valueSet#2582040, count#2582042L, count#2582044L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371"], "size": 50, "equiv": "0"}, "373": {"label": "HashAggregate", "notes": "", "children": [374], "parent": [372], "node_id": "(374) HashAggregate", "lineno": 5120, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194501, window#2194401, __auto_generated_subquery_name.`username`#2581770, t.`application_id`#2581771, gid#2581769, count#2582046L]", "Keys": " [6]: [long_ip#2172242L, tguard_status#2194501, window#2194401, __auto_generated_subquery_name.`username`#2581770, t.`application_id`#2581771, gid#2581769]", "Functions": " [1]: [finalmerge_count(merge count#2582046L) AS count(t.`long_ip`#2581772L)#2194395L]", "Aggregate": " Attributes [1]: [count(t.`long_ip`#2581772L)#2194395L]", "Results": " [7]: [long_ip#2172242L, tguard_status#2194501, window#2194401, __auto_generated_subquery_name.`username`#2581770, t.`application_id`#2581771, gid#2581769, count(t.`long_ip`#2581772L)#2194395L AS count(t.`long_ip`)#2581773L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372"], "size": 49, "equiv": "0"}, "374": {"label": "Exchange", "notes": "", "children": [375], "parent": [373], "node_id": "(373) Exchange", "lineno": 5121, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194501, window#2194401, __auto_generated_subquery_name.`username`#2581770, t.`application_id`#2581771, gid#2581769, count#2582046L]", "Arguments:": " hashpartitioning(long_ip#2172242L, tguard_status#2194501, window#2194401, __auto_generated_subquery_name.`username`#2581770, t.`application_id`#2581771, gid#2581769, 1000), ENSURE_REQUIREMENTS, [id=#1669184]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373"], "size": 48, "equiv": "0"}, "375": {"label": "HashAggregate", "notes": "", "children": [376], "parent": [374], "node_id": "(372) HashAggregate", "lineno": 5122, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194501, window#2194401, __auto_generated_subquery_name.`username`#2581770, t.`application_id`#2581771, gid#2581769, t.`long_ip`#2581772L]", "Keys": " [6]: [long_ip#2172242L, tguard_status#2194501, window#2194401, __auto_generated_subquery_name.`username`#2581770, t.`application_id`#2581771, gid#2581769]", "Functions": " [1]: [partial_count(t.`long_ip`#2581772L) AS count#2582046L]", "Aggregate": " Attributes [1]: [count#2582045L]", "Results": " [7]: [long_ip#2172242L, tguard_status#2194501, window#2194401, __auto_generated_subquery_name.`username`#2581770, t.`application_id`#2581771, gid#2581769, count#2582046L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374"], "size": 47, "equiv": "0"}, "376": {"label": "Expand", "notes": "", "children": [377], "parent": [375], "node_id": "(371) Expand", "lineno": 5123, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [window#2194401, long_ip#2172242L, username#2192593, application_id#2172243, tguard_status#2194501]", "Arguments:": " [ArrayBuffer(long_ip#2172242L, tguard_status#2194501, window#2194401, null, null, 0, long_ip#2172242L), ArrayBuffer(long_ip#2172242L, tguard_status#2194501, window#2194401, username#2192593, null, 1, null), ArrayBuffer(long_ip#2172242L, tguard_status#2194501, window#2194401, null, application_id#2172243, 2, null)], [long_ip#2172242L, tguard_status#2194501, window#2194401, __auto_generated_subquery_name.`username`#2581770, t.`application_id`#2581771, gid#2581769, t.`long_ip`#2581772L]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375"], "size": 46, "equiv": "6"}, "377": {"label": "Project", "notes": "", "children": [378], "parent": [376], "node_id": "(370) Project", "lineno": 5124, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [window#2194401, long_ip#2172242L, username#2192593, application_id#2172243, tguard_status#2194501]", "Input": " [6]: [window#2194401, long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376"], "size": 45, "equiv": "0"}, "378": {"label": "Filter", "notes": "", "children": [379], "parent": [377], "node_id": "(369) Filter", "lineno": 5125, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [window#2194401, long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501]", "Condition": " : ((isnotnull(window#2194401) AND (transaction_date_time#2172247 >= window#2194401.start)) AND (transaction_date_time#2172247 < window#2194401.end))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377"], "size": 44, "equiv": "0"}, "379": {"label": "Expand", "notes": "", "children": [380], "parent": [378], "node_id": "(368) Expand", "lineno": 5126, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501]", "Arguments:": " [List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 3) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 3) * 300000000) + 900000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 3) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 3) * 300000000) + 900000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 3) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 3) * 300000000) + 900000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501)], [window#2194401, long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378"], "size": 43, "equiv": "7"}, "380": {"label": "Project", "notes": "", "children": [381], "parent": [379], "node_id": "(367) Project", "lineno": 5127, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501]", "Input": " [6]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501, un#2192556]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379"], "size": 42, "equiv": "0"}, "381": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [382, 417], "parent": [380], "node_id": "(366) SortMergeJoin", "lineno": 5128, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [username#2192593]", "Right": " keys [1]: [un#2192556]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380"], "size": 41, "equiv": "0"}, "382": {"label": "Sort", "notes": "", "children": [383], "parent": [381], "node_id": "(360) Sort", "lineno": 5129, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501]", "Arguments:": " [username#2192593 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381"], "size": 35, "equiv": "0"}, "383": {"label": "Exchange", "notes": "", "children": [384], "parent": [382], "node_id": "(359) Exchange", "lineno": 5130, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194501]", "Arguments:": " hashpartitioning(username#2192593, 1000), ENSURE_REQUIREMENTS, [id=#1669172]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382"], "size": 34, "equiv": "0"}, "384": {"label": "Project", "notes": "", "children": [385], "parent": [383], "node_id": "(358) Project", "lineno": 5131, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, userName#2172244 AS username#2192593, application_id#2172243, transaction_date_time#2172247, status#2172245 AS tguard_status#2194501]", "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383"], "size": 33, "equiv": "0"}, "385": {"label": "Filter", "notes": "", "children": [386], "parent": [384], "node_id": "(357) Filter", "lineno": 5132, "detail": {"note": "Filter", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Condition": " : isnull(ip_whitelist_flg#2192601)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384"], "size": 32, "equiv": "0"}, "386": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [387, 412], "parent": [385], "node_id": "(356) SortMergeJoin", "lineno": 5133, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385"], "size": 31, "equiv": "0"}, "387": {"label": "Sort", "notes": "", "children": [388], "parent": [386], "node_id": "(350) Sort", "lineno": 5134, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386"], "size": 25, "equiv": "0"}, "388": {"label": "Exchange", "notes": "", "children": [389], "parent": [387], "node_id": "(349) Exchange", "lineno": 5135, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669163]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387"], "size": 24, "equiv": "0"}, "389": {"label": "Project", "notes": "", "children": [390], "parent": [388], "node_id": "(348) Project", "lineno": 5136, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388"], "size": 23, "equiv": "0"}, "390": {"label": "BroadcastHashJoin LeftAnti BuildRight", "notes": "", "children": [391, 394], "parent": [389], "node_id": "(347) BroadcastHashJoin", "lineno": 5137, "detail": {"note": "BroadcastHashJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2192616]", "Join": " condition: None"}, "full_label": "BroadcastHashJoin LeftAnti BuildRight", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389"], "size": 22, "equiv": "0"}, "391": {"label": "Filter", "notes": "", "children": [392], "parent": [390], "node_id": "(329) Filter", "lineno": 5138, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Condition": " : ((status#2172245 = SUCCESS) AND isnotnull(transaction_date_time#2172247))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390"], "size": 3, "equiv": "8"}, "392": {"label": "InMemoryTableScan", "notes": "", "children": [393], "parent": [391], "node_id": "(328) InMemoryTableScan", "lineno": 5139, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247], [(status#2172245 = SUCCESS), isnotnull(transaction_date_time#2172247)]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "391"], "size": 2, "equiv": "3"}, "393": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [392], "node_id": "(329) InMemoryRelation", "lineno": 5140, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "391", "392"], "size": 1, "equiv": "0"}, "394": {"label": "BroadcastExchange", "notes": "", "children": [395], "parent": [390], "node_id": "(346) BroadcastExchange", "lineno": 5151, "detail": {"note": "BroadcastExchange", "lineno": 5461, "Input": " [1]: [ip_address#2192616]", "Arguments:": " HashedRelationBroadcastMode(List(input[0, string, true]),true), [id=#1669158]"}, "full_label": "BroadcastExchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390"], "size": 18, "equiv": "1"}, "395": {"label": "Project", "notes": "", "children": [396], "parent": [394], "node_id": "(345) Project", "lineno": 5152, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2192616]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394"], "size": 17, "equiv": "2"}, "396": {"label": "Filter", "notes": "", "children": [397], "parent": [395], "node_id": "(344) Filter", "lineno": 5153, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]", "Condition": " : (ip_trans_cnt#2192615L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395"], "size": 16, "equiv": "0"}, "397": {"label": "HashAggregate", "notes": "", "children": [398], "parent": [396], "node_id": "(343) HashAggregate", "lineno": 5154, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210409L) AS count(1)#2192632L]", "Aggregate": " Attributes [1]: [count(1)#2192632L]", "Results": " [2]: [ip_address#2172241, count(1)#2192632L AS ip_trans_cnt#2192615L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396"], "size": 15, "equiv": "0"}, "398": {"label": "Exchange", "notes": "", "children": [399], "parent": [397], "node_id": "(342) Exchange", "lineno": 5155, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1669153]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397"], "size": 14, "equiv": "0"}, "399": {"label": "HashAggregate", "notes": "", "children": [400], "parent": [398], "node_id": "(341) HashAggregate", "lineno": 5156, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210409L]", "Aggregate": " Attributes [1]: [count#2210408L]", "Results": " [2]: [ip_address#2172241, count#2210409L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398"], "size": 13, "equiv": "0"}, "400": {"label": "Project", "notes": "", "children": [401], "parent": [399], "node_id": "(340) Project", "lineno": 5157, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399"], "size": 12, "equiv": "0"}, "401": {"label": "Filter", "notes": "", "children": [402], "parent": [400], "node_id": "(339) Filter", "lineno": 5158, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Condition": " : isnull(ip_whitelist_flg#2192618)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400"], "size": 11, "equiv": "0"}, "402": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [403, 407], "parent": [401], "node_id": "(338) SortMergeJoin", "lineno": 5159, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400", "401"], "size": 10, "equiv": "0"}, "403": {"label": "Sort", "notes": "", "children": [404], "parent": [402], "node_id": "(332) Sort", "lineno": 5160, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400", "401", "402"], "size": 4, "equiv": "0"}, "404": {"label": "Exchange", "notes": "", "children": [405], "parent": [403], "node_id": "(331) Exchange", "lineno": 5161, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669144]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400", "401", "402", "403"], "size": 3, "equiv": "0"}, "405": {"label": "InMemoryTableScan", "notes": "", "children": [406], "parent": [404], "node_id": "(330) InMemoryTableScan", "lineno": 5162, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400", "401", "402", "403", "404"], "size": 2, "equiv": "3"}, "406": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [405], "node_id": "(331) InMemoryRelation", "lineno": 5163, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400", "401", "402", "403", "404", "405"], "size": 1, "equiv": "0"}, "407": {"label": "Sort", "notes": "", "children": [408], "parent": [402], "node_id": "(337) Sort", "lineno": 5174, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400", "401", "402"], "size": 5, "equiv": "4"}, "408": {"label": "Exchange", "notes": "", "children": [409], "parent": [407], "node_id": "(336) Exchange", "lineno": 5175, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669145]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400", "401", "402", "407"], "size": 4, "equiv": "0"}, "409": {"label": "Project", "notes": "", "children": [410], "parent": [408], "node_id": "(335) Project", "lineno": 5176, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192618]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400", "401", "402", "407", "408"], "size": 3, "equiv": "0"}, "410": {"label": "Filter", "notes": "", "children": [411], "parent": [409], "node_id": "(334) Filter", "lineno": 5177, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400", "401", "402", "407", "408", "409"], "size": 2, "equiv": "0"}, "411": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [410], "node_id": "(333) Scan", "lineno": 5178, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "387", "388", "389", "390", "394", "395", "396", "397", "398", "399", "400", "401", "402", "407", "408", "409", "410"], "size": 1, "equiv": "0"}, "412": {"label": "Sort", "notes": "", "children": [413], "parent": [386], "node_id": "(355) Sort", "lineno": 5179, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386"], "size": 5, "equiv": "4"}, "413": {"label": "Exchange", "notes": "", "children": [414], "parent": [412], "node_id": "(354) Exchange", "lineno": 5180, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669164]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "412"], "size": 4, "equiv": "0"}, "414": {"label": "Project", "notes": "", "children": [415], "parent": [413], "node_id": "(353) Project", "lineno": 5181, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192601]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "412", "413"], "size": 3, "equiv": "0"}, "415": {"label": "Filter", "notes": "", "children": [416], "parent": [414], "node_id": "(352) Filter", "lineno": 5182, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "412", "413", "414"], "size": 2, "equiv": "0"}, "416": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [415], "node_id": "(351) Scan", "lineno": 5183, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "382", "383", "384", "385", "386", "412", "413", "414", "415"], "size": 1, "equiv": "0"}, "417": {"label": "Sort", "notes": "", "children": [418], "parent": [381], "node_id": "(365) Sort", "lineno": 5184, "detail": {"note": "Sort", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " [un#2192556 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381"], "size": 5, "equiv": "4"}, "418": {"label": "Exchange", "notes": "", "children": [419], "parent": [417], "node_id": "(364) Exchange", "lineno": 5185, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " hashpartitioning(un#2192556, 1000), ENSURE_REQUIREMENTS, [id=#1669173]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "417"], "size": 4, "equiv": "0"}, "419": {"label": "Project", "notes": "", "children": [420], "parent": [418], "node_id": "(363) Project", "lineno": 5186, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [userName#2175089 AS un#2192556]", "Input": " [2]: [userName#2175089, data_dt#2175091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "417", "418"], "size": 3, "equiv": "0"}, "420": {"label": "Filter", "notes": "", "children": [421], "parent": [419], "node_id": "(362) Filter", "lineno": 5187, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [userName#2175089, data_dt#2175091]", "Condition": " : isnotnull(userName#2175089)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "417", "418", "419"], "size": 2, "equiv": "0"}, "421": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [420], "node_id": "(361) Scan", "lineno": 5188, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [2]: [userName#2175089, data_dt#2175091]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/usr_distip_cnt_map]", "PartitionFilters:": " [isnotnull(data_dt#2175091), (data_dt#2175091 = 2022080317)]", "PushedFilters:": " [IsNotNull(userName)]", "ReadSchema:": " struct<userName:string>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "309", "310", "311", "312", "313", "368", "369", "370", "371", "372", "373", "374", "375", "376", "377", "378", "379", "380", "381", "417", "418", "419", "420"], "size": 1, "equiv": "0"}, "422": {"label": "Sort", "notes": "", "children": [423], "parent": [11], "node_id": "(495) Sort", "lineno": 5189, "detail": {"note": "Sort", "lineno": 5461, "Input": " [8]: [long_ip#2194521L, _gen_alias_2581293#2581293, 60m_success_count#2194523L, 60m_failed_count#2194524L, 60m_suc_dist_usr#2194525L, 60m_fail_dist_usr#2194526L, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L]", "Arguments:": " [long_ip#2194521L ASC NULLS FIRST, _gen_alias_2581293#2581293 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11"], "size": 113, "equiv": "10"}, "423": {"label": "Exchange", "notes": "", "children": [424], "parent": [422], "node_id": "(494) Exchange", "lineno": 5190, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [8]: [long_ip#2194521L, _gen_alias_2581293#2581293, 60m_success_count#2194523L, 60m_failed_count#2194524L, 60m_suc_dist_usr#2194525L, 60m_fail_dist_usr#2194526L, 60m_suc_dist_app#2194527L, 60m_fail_dist_app#2194528L]", "Arguments:": " hashpartitioning(long_ip#2194521L, _gen_alias_2581293#2581293, 1000), ENSURE_REQUIREMENTS, [id=#1669310]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422"], "size": 112, "equiv": "0"}, "424": {"label": "Project", "notes": "", "children": [425], "parent": [423], "node_id": "(493) Project", "lineno": 5191, "detail": {"note": "Project", "lineno": 5461, "Output": " [8]: [coalesce(long_ip#2192570L, long_ip#2172242L) AS long_ip#2194521L, coalesce(window#2194436, window#2194529).end AS _gen_alias_2581293#2581293, coalesce(attempts_per_ip_60m_status#2194530L, 0) AS 60m_success_count#2194523L, coalesce(attempts_per_ip_60m_status#2194431L, 0) AS 60m_failed_count#2194524L, coalesce(dist_usr_60m_status#2194531L, 0) AS 60m_suc_dist_usr#2194525L, coalesce(dist_usr_60m_status#2194432L, 0) AS 60m_fail_dist_usr#2194526L, coalesce(dist_app_60m_status#2194532L, 0) AS 60m_suc_dist_app#2194527L, coalesce(dist_app_60m_status#2194433L, 0) AS 60m_fail_dist_app#2194528L]", "Input": " [10]: [long_ip#2192570L, window#2194436, attempts_per_ip_60m_status#2194431L, dist_usr_60m_status#2194432L, dist_app_60m_status#2194433L, long_ip#2172242L, window#2194529, attempts_per_ip_60m_status#2194530L, dist_usr_60m_status#2194531L, dist_app_60m_status#2194532L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423"], "size": 111, "equiv": "0"}, "425": {"label": "Filter", "notes": "", "children": [426], "parent": [424], "node_id": "(492) Filter", "lineno": 5192, "detail": {"note": "Filter", "lineno": 5461, "Input": " [10]: [long_ip#2192570L, window#2194436, attempts_per_ip_60m_status#2194431L, dist_usr_60m_status#2194432L, dist_app_60m_status#2194433L, long_ip#2172242L, window#2194529, attempts_per_ip_60m_status#2194530L, dist_usr_60m_status#2194531L, dist_app_60m_status#2194532L]", "Condition": " : ((coalesce(window#2194436, window#2194529).end >= 1669759889000000) AND isnotnull(coalesce(long_ip#2192570L, long_ip#2172242L)))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424"], "size": 110, "equiv": "0"}, "426": {"label": "SortMergeJoin FullOuter", "notes": "", "children": [427, 481], "parent": [425], "node_id": "(491) SortMergeJoin", "lineno": 5193, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [2]: [long_ip#2192570L, window#2194436]", "Right": " keys [2]: [long_ip#2172242L, window#2194529]", "Join": " condition: None"}, "full_label": "SortMergeJoin FullOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425"], "size": 109, "equiv": "0"}, "427": {"label": "Sort", "notes": "", "children": [428], "parent": [426], "node_id": "(438) Sort", "lineno": 5194, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, window#2194436, attempts_per_ip_60m_status#2194431L, dist_usr_60m_status#2194432L, dist_app_60m_status#2194433L]", "Arguments:": " [long_ip#2192570L ASC NULLS FIRST, window#2194436 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426"], "size": 54, "equiv": "11"}, "428": {"label": "Exchange", "notes": "", "children": [429], "parent": [427], "node_id": "(437) Exchange", "lineno": 5195, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, window#2194436, attempts_per_ip_60m_status#2194431L, dist_usr_60m_status#2194432L, dist_app_60m_status#2194433L]", "Arguments:": " hashpartitioning(long_ip#2192570L, window#2194436, 1000), ENSURE_REQUIREMENTS, [id=#1669301]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427"], "size": 53, "equiv": "0"}, "429": {"label": "HashAggregate", "notes": "", "children": [430], "parent": [428], "node_id": "(436) HashAggregate", "lineno": 5196, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194436, first#2582049L, valueSet#2582050, count#2582052L, count#2582054L]", "Keys": " [3]: [long_ip#2192570L, tguard_status#2192576, window#2194436]", "Functions": " [3]: [finalmerge_first(merge first#2582049L, valueSet#2582050) AS first(if ((gid#2581775 = 0)) count(t.`long_ip`)#2581779L else null) ignore nulls#2581780L, finalmerge_count(merge count#2582052L) AS count(if ((gid#2581775 = 1)) __auto_generated_subquery_name.`username`#2581776 else null)#2194434L, finalmerge_count(merge count#2582054L) AS count(if ((gid#2581775 = 2)) t.`application_id`#2581777 else null)#2194435L]", "Aggregate": " Attributes [3]: [first(if ((gid#2581775 = 0)) count(t.`long_ip`)#2581779L else null) ignore nulls#2581780L, count(if ((gid#2581775 = 1)) __auto_generated_subquery_name.`username`#2581776 else null)#2194434L, count(if ((gid#2581775 = 2)) t.`application_id`#2581777 else null)#2194435L]", "Results": " [5]: [long_ip#2192570L, window#2194436, coalesce(first(if ((gid#2581775 = 0)) count(t.`long_ip`)#2581779L else null) ignore nulls#2581780L, 0) AS attempts_per_ip_60m_status#2194431L, count(if ((gid#2581775 = 1)) __auto_generated_subquery_name.`username`#2581776 else null)#2194434L AS dist_usr_60m_status#2194432L, count(if ((gid#2581775 = 2)) t.`application_id`#2581777 else null)#2194435L AS dist_app_60m_status#2194433L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428"], "size": 52, "equiv": "0"}, "430": {"label": "Exchange", "notes": "", "children": [431], "parent": [429], "node_id": "(435) Exchange", "lineno": 5197, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194436, first#2582049L, valueSet#2582050, count#2582052L, count#2582054L]", "Arguments:": " hashpartitioning(long_ip#2192570L, tguard_status#2192576, window#2194436, 1000), ENSURE_REQUIREMENTS, [id=#1669250]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429"], "size": 51, "equiv": "0"}, "431": {"label": "HashAggregate", "notes": "", "children": [432], "parent": [430], "node_id": "(434) HashAggregate", "lineno": 5198, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194436, __auto_generated_subquery_name.`username`#2581776, t.`application_id`#2581777, gid#2581775, count(t.`long_ip`)#2581779L]", "Keys": " [3]: [long_ip#2192570L, tguard_status#2192576, window#2194436]", "Functions": " [3]: [partial_first(if ((gid#2581775 = 0)) count(t.`long_ip`)#2581779L else null, true) AS (first#2582049L, valueSet#2582050), partial_count(if ((gid#2581775 = 1)) __auto_generated_subquery_name.`username`#2581776 else null) AS count#2582052L, partial_count(if ((gid#2581775 = 2)) t.`application_id`#2581777 else null) AS count#2582054L]", "Aggregate": " Attributes [4]: [first#2582047L, valueSet#2582048, count#2582051L, count#2582053L]", "Results": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194436, first#2582049L, valueSet#2582050, count#2582052L, count#2582054L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430"], "size": 50, "equiv": "0"}, "432": {"label": "HashAggregate", "notes": "", "children": [433], "parent": [431], "node_id": "(433) HashAggregate", "lineno": 5199, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194436, __auto_generated_subquery_name.`username`#2581776, t.`application_id`#2581777, gid#2581775, count#2582056L]", "Keys": " [6]: [long_ip#2192570L, tguard_status#2192576, window#2194436, __auto_generated_subquery_name.`username`#2581776, t.`application_id`#2581777, gid#2581775]", "Functions": " [1]: [finalmerge_count(merge count#2582056L) AS count(t.`long_ip`#2581778L)#2194430L]", "Aggregate": " Attributes [1]: [count(t.`long_ip`#2581778L)#2194430L]", "Results": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194436, __auto_generated_subquery_name.`username`#2581776, t.`application_id`#2581777, gid#2581775, count(t.`long_ip`#2581778L)#2194430L AS count(t.`long_ip`)#2581779L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431"], "size": 49, "equiv": "0"}, "433": {"label": "Exchange", "notes": "", "children": [434], "parent": [432], "node_id": "(432) Exchange", "lineno": 5200, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194436, __auto_generated_subquery_name.`username`#2581776, t.`application_id`#2581777, gid#2581775, count#2582056L]", "Arguments:": " hashpartitioning(long_ip#2192570L, tguard_status#2192576, window#2194436, __auto_generated_subquery_name.`username`#2581776, t.`application_id`#2581777, gid#2581775, 1000), ENSURE_REQUIREMENTS, [id=#1669246]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432"], "size": 48, "equiv": "0"}, "434": {"label": "HashAggregate", "notes": "", "children": [435], "parent": [433], "node_id": "(431) HashAggregate", "lineno": 5201, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194436, __auto_generated_subquery_name.`username`#2581776, t.`application_id`#2581777, gid#2581775, t.`long_ip`#2581778L]", "Keys": " [6]: [long_ip#2192570L, tguard_status#2192576, window#2194436, __auto_generated_subquery_name.`username`#2581776, t.`application_id`#2581777, gid#2581775]", "Functions": " [1]: [partial_count(t.`long_ip`#2581778L) AS count#2582056L]", "Aggregate": " Attributes [1]: [count#2582055L]", "Results": " [7]: [long_ip#2192570L, tguard_status#2192576, window#2194436, __auto_generated_subquery_name.`username`#2581776, t.`application_id`#2581777, gid#2581775, count#2582056L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433"], "size": 47, "equiv": "0"}, "435": {"label": "Expand", "notes": "", "children": [436], "parent": [434], "node_id": "(430) Expand", "lineno": 5202, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [window#2194436, long_ip#2192570L, username#2192593, application_id#2172243, tguard_status#2192576]", "Arguments:": " [ArrayBuffer(long_ip#2192570L, tguard_status#2192576, window#2194436, null, null, 0, long_ip#2192570L), ArrayBuffer(long_ip#2192570L, tguard_status#2192576, window#2194436, username#2192593, null, 1, null), ArrayBuffer(long_ip#2192570L, tguard_status#2192576, window#2194436, null, application_id#2172243, 2, null)], [long_ip#2192570L, tguard_status#2192576, window#2194436, __auto_generated_subquery_name.`username`#2581776, t.`application_id`#2581777, gid#2581775, t.`long_ip`#2581778L]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434"], "size": 46, "equiv": "6"}, "436": {"label": "Project", "notes": "", "children": [437], "parent": [435], "node_id": "(429) Project", "lineno": 5203, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [window#2194436, long_ip#2192570L, username#2192593, application_id#2172243, tguard_status#2192576]", "Input": " [6]: [window#2194436, long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435"], "size": 45, "equiv": "0"}, "437": {"label": "Filter", "notes": "", "children": [438], "parent": [436], "node_id": "(428) Filter", "lineno": 5204, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [window#2194436, long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Condition": " : ((isnotnull(window#2194436) AND (transaction_date_time#2172247 >= window#2194436.start)) AND (transaction_date_time#2172247 < window#2194436.end))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436"], "size": 44, "equiv": "0"}, "438": {"label": "Expand", "notes": "", "children": [439], "parent": [437], "node_id": "(427) Expand", "lineno": 5205, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Arguments:": " [List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 3) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 3) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 4) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 4) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 5) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 5) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 6) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 6) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 7) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 7) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 8) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 8) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 9) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 9) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 10) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 10) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 11) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 11) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576)], [window#2194436, long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437"], "size": 43, "equiv": "7"}, "439": {"label": "Project", "notes": "", "children": [440], "parent": [438], "node_id": "(426) Project", "lineno": 5206, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Input": " [6]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576, un#2192556]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438"], "size": 42, "equiv": "0"}, "440": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [441, 476], "parent": [439], "node_id": "(425) SortMergeJoin", "lineno": 5207, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [username#2192593]", "Right": " keys [1]: [un#2192556]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439"], "size": 41, "equiv": "0"}, "441": {"label": "Sort", "notes": "", "children": [442], "parent": [440], "node_id": "(419) Sort", "lineno": 5208, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Arguments:": " [username#2192593 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440"], "size": 35, "equiv": "0"}, "442": {"label": "Exchange", "notes": "", "children": [443], "parent": [441], "node_id": "(418) Exchange", "lineno": 5209, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2192570L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2192576]", "Arguments:": " hashpartitioning(username#2192593, 1000), ENSURE_REQUIREMENTS, [id=#1669234]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441"], "size": 34, "equiv": "0"}, "443": {"label": "Project", "notes": "", "children": [444], "parent": [442], "node_id": "(417) Project", "lineno": 5210, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L AS long_ip#2192570L, userName#2172244 AS username#2192593, application_id#2172243, transaction_date_time#2172247, status#2172245 AS tguard_status#2192576]", "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442"], "size": 33, "equiv": "0"}, "444": {"label": "Filter", "notes": "", "children": [445], "parent": [443], "node_id": "(416) Filter", "lineno": 5211, "detail": {"note": "Filter", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Condition": " : isnull(ip_whitelist_flg#2192601)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443"], "size": 32, "equiv": "0"}, "445": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [446, 471], "parent": [444], "node_id": "(415) SortMergeJoin", "lineno": 5212, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444"], "size": 31, "equiv": "0"}, "446": {"label": "Sort", "notes": "", "children": [447], "parent": [445], "node_id": "(409) Sort", "lineno": 5213, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445"], "size": 25, "equiv": "0"}, "447": {"label": "Exchange", "notes": "", "children": [448], "parent": [446], "node_id": "(408) Exchange", "lineno": 5214, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669225]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446"], "size": 24, "equiv": "0"}, "448": {"label": "Project", "notes": "", "children": [449], "parent": [447], "node_id": "(407) Project", "lineno": 5215, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447"], "size": 23, "equiv": "0"}, "449": {"label": "BroadcastHashJoin LeftAnti BuildRight", "notes": "", "children": [450, 453], "parent": [448], "node_id": "(406) BroadcastHashJoin", "lineno": 5216, "detail": {"note": "BroadcastHashJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2192616]", "Join": " condition: None"}, "full_label": "BroadcastHashJoin LeftAnti BuildRight", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448"], "size": 22, "equiv": "0"}, "450": {"label": "Filter", "notes": "", "children": [451], "parent": [449], "node_id": "(388) Filter", "lineno": 5217, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Condition": " : ((status#2172245 = FAILED) AND isnotnull(transaction_date_time#2172247))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449"], "size": 3, "equiv": "8"}, "451": {"label": "InMemoryTableScan", "notes": "", "children": [452], "parent": [450], "node_id": "(387) InMemoryTableScan", "lineno": 5218, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247], [(status#2172245 = FAILED), isnotnull(transaction_date_time#2172247)]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "450"], "size": 2, "equiv": "3"}, "452": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [451], "node_id": "(388) InMemoryRelation", "lineno": 5219, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "450", "451"], "size": 1, "equiv": "0"}, "453": {"label": "BroadcastExchange", "notes": "", "children": [454], "parent": [449], "node_id": "(405) BroadcastExchange", "lineno": 5230, "detail": {"note": "BroadcastExchange", "lineno": 5461, "Input": " [1]: [ip_address#2192616]", "Arguments:": " HashedRelationBroadcastMode(List(input[0, string, true]),true), [id=#1669220]"}, "full_label": "BroadcastExchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449"], "size": 18, "equiv": "1"}, "454": {"label": "Project", "notes": "", "children": [455], "parent": [453], "node_id": "(404) Project", "lineno": 5231, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2192616]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453"], "size": 17, "equiv": "2"}, "455": {"label": "Filter", "notes": "", "children": [456], "parent": [454], "node_id": "(403) Filter", "lineno": 5232, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]", "Condition": " : (ip_trans_cnt#2192615L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454"], "size": 16, "equiv": "0"}, "456": {"label": "HashAggregate", "notes": "", "children": [457], "parent": [455], "node_id": "(402) HashAggregate", "lineno": 5233, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210409L) AS count(1)#2192632L]", "Aggregate": " Attributes [1]: [count(1)#2192632L]", "Results": " [2]: [ip_address#2172241, count(1)#2192632L AS ip_trans_cnt#2192615L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455"], "size": 15, "equiv": "0"}, "457": {"label": "Exchange", "notes": "", "children": [458], "parent": [456], "node_id": "(401) Exchange", "lineno": 5234, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1669215]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456"], "size": 14, "equiv": "0"}, "458": {"label": "HashAggregate", "notes": "", "children": [459], "parent": [457], "node_id": "(400) HashAggregate", "lineno": 5235, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210409L]", "Aggregate": " Attributes [1]: [count#2210408L]", "Results": " [2]: [ip_address#2172241, count#2210409L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457"], "size": 13, "equiv": "0"}, "459": {"label": "Project", "notes": "", "children": [460], "parent": [458], "node_id": "(399) Project", "lineno": 5236, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458"], "size": 12, "equiv": "0"}, "460": {"label": "Filter", "notes": "", "children": [461], "parent": [459], "node_id": "(398) Filter", "lineno": 5237, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Condition": " : isnull(ip_whitelist_flg#2192618)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459"], "size": 11, "equiv": "0"}, "461": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [462, 466], "parent": [460], "node_id": "(397) SortMergeJoin", "lineno": 5238, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459", "460"], "size": 10, "equiv": "0"}, "462": {"label": "Sort", "notes": "", "children": [463], "parent": [461], "node_id": "(391) Sort", "lineno": 5239, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459", "460", "461"], "size": 4, "equiv": "0"}, "463": {"label": "Exchange", "notes": "", "children": [464], "parent": [462], "node_id": "(390) Exchange", "lineno": 5240, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669206]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459", "460", "461", "462"], "size": 3, "equiv": "0"}, "464": {"label": "InMemoryTableScan", "notes": "", "children": [465], "parent": [463], "node_id": "(389) InMemoryTableScan", "lineno": 5241, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459", "460", "461", "462", "463"], "size": 2, "equiv": "3"}, "465": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [464], "node_id": "(390) InMemoryRelation", "lineno": 5242, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459", "460", "461", "462", "463", "464"], "size": 1, "equiv": "0"}, "466": {"label": "Sort", "notes": "", "children": [467], "parent": [461], "node_id": "(396) Sort", "lineno": 5253, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459", "460", "461"], "size": 5, "equiv": "4"}, "467": {"label": "Exchange", "notes": "", "children": [468], "parent": [466], "node_id": "(395) Exchange", "lineno": 5254, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669207]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459", "460", "461", "466"], "size": 4, "equiv": "0"}, "468": {"label": "Project", "notes": "", "children": [469], "parent": [467], "node_id": "(394) Project", "lineno": 5255, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192618]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459", "460", "461", "466", "467"], "size": 3, "equiv": "0"}, "469": {"label": "Filter", "notes": "", "children": [470], "parent": [468], "node_id": "(393) Filter", "lineno": 5256, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459", "460", "461", "466", "467", "468"], "size": 2, "equiv": "0"}, "470": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [469], "node_id": "(392) Scan", "lineno": 5257, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "446", "447", "448", "449", "453", "454", "455", "456", "457", "458", "459", "460", "461", "466", "467", "468", "469"], "size": 1, "equiv": "0"}, "471": {"label": "Sort", "notes": "", "children": [472], "parent": [445], "node_id": "(414) Sort", "lineno": 5258, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445"], "size": 5, "equiv": "4"}, "472": {"label": "Exchange", "notes": "", "children": [473], "parent": [471], "node_id": "(413) Exchange", "lineno": 5259, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669226]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "471"], "size": 4, "equiv": "0"}, "473": {"label": "Project", "notes": "", "children": [474], "parent": [472], "node_id": "(412) Project", "lineno": 5260, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192601]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "471", "472"], "size": 3, "equiv": "0"}, "474": {"label": "Filter", "notes": "", "children": [475], "parent": [473], "node_id": "(411) Filter", "lineno": 5261, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "471", "472", "473"], "size": 2, "equiv": "0"}, "475": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [474], "node_id": "(410) Scan", "lineno": 5262, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "441", "442", "443", "444", "445", "471", "472", "473", "474"], "size": 1, "equiv": "0"}, "476": {"label": "Sort", "notes": "", "children": [477], "parent": [440], "node_id": "(424) Sort", "lineno": 5263, "detail": {"note": "Sort", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " [un#2192556 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440"], "size": 5, "equiv": "4"}, "477": {"label": "Exchange", "notes": "", "children": [478], "parent": [476], "node_id": "(423) Exchange", "lineno": 5264, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " hashpartitioning(un#2192556, 1000), ENSURE_REQUIREMENTS, [id=#1669235]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "476"], "size": 4, "equiv": "0"}, "478": {"label": "Project", "notes": "", "children": [479], "parent": [477], "node_id": "(422) Project", "lineno": 5265, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [userName#2175089 AS un#2192556]", "Input": " [2]: [userName#2175089, data_dt#2175091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "476", "477"], "size": 3, "equiv": "0"}, "479": {"label": "Filter", "notes": "", "children": [480], "parent": [478], "node_id": "(421) Filter", "lineno": 5266, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [userName#2175089, data_dt#2175091]", "Condition": " : isnotnull(userName#2175089)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "476", "477", "478"], "size": 2, "equiv": "0"}, "480": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [479], "node_id": "(420) Scan", "lineno": 5267, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [2]: [userName#2175089, data_dt#2175091]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/usr_distip_cnt_map]", "PartitionFilters:": " [isnotnull(data_dt#2175091), (data_dt#2175091 = 2022080317)]", "PushedFilters:": " [IsNotNull(userName)]", "ReadSchema:": " struct<userName:string>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "427", "428", "429", "430", "431", "432", "433", "434", "435", "436", "437", "438", "439", "440", "476", "477", "478", "479"], "size": 1, "equiv": "0"}, "481": {"label": "Sort", "notes": "", "children": [482], "parent": [426], "node_id": "(490) Sort", "lineno": 5268, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, window#2194529, attempts_per_ip_60m_status#2194530L, dist_usr_60m_status#2194531L, dist_app_60m_status#2194532L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST, window#2194529 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426"], "size": 54, "equiv": "11"}, "482": {"label": "Exchange", "notes": "", "children": [483], "parent": [481], "node_id": "(489) Exchange", "lineno": 5269, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, window#2194529, attempts_per_ip_60m_status#2194530L, dist_usr_60m_status#2194531L, dist_app_60m_status#2194532L]", "Arguments:": " hashpartitioning(long_ip#2172242L, window#2194529, 1000), ENSURE_REQUIREMENTS, [id=#1669302]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481"], "size": 53, "equiv": "0"}, "483": {"label": "HashAggregate", "notes": "", "children": [484], "parent": [482], "node_id": "(488) HashAggregate", "lineno": 5270, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194540, window#2194436, first#2582059L, valueSet#2582060, count#2582062L, count#2582064L]", "Keys": " [3]: [long_ip#2172242L, tguard_status#2194540, window#2194436]", "Functions": " [3]: [finalmerge_first(merge first#2582059L, valueSet#2582060) AS first(if ((gid#2581781 = 0)) count(t.`long_ip`)#2581785L else null) ignore nulls#2581786L, finalmerge_count(merge count#2582062L) AS count(if ((gid#2581781 = 1)) __auto_generated_subquery_name.`username`#2581782 else null)#2194434L, finalmerge_count(merge count#2582064L) AS count(if ((gid#2581781 = 2)) t.`application_id`#2581783 else null)#2194435L]", "Aggregate": " Attributes [3]: [first(if ((gid#2581781 = 0)) count(t.`long_ip`)#2581785L else null) ignore nulls#2581786L, count(if ((gid#2581781 = 1)) __auto_generated_subquery_name.`username`#2581782 else null)#2194434L, count(if ((gid#2581781 = 2)) t.`application_id`#2581783 else null)#2194435L]", "Results": " [5]: [long_ip#2172242L, window#2194436 AS window#2194529, coalesce(first(if ((gid#2581781 = 0)) count(t.`long_ip`)#2581785L else null) ignore nulls#2581786L, 0) AS attempts_per_ip_60m_status#2194530L, count(if ((gid#2581781 = 1)) __auto_generated_subquery_name.`username`#2581782 else null)#2194434L AS dist_usr_60m_status#2194531L, count(if ((gid#2581781 = 2)) t.`application_id`#2581783 else null)#2194435L AS dist_app_60m_status#2194532L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482"], "size": 52, "equiv": "0"}, "484": {"label": "Exchange", "notes": "", "children": [485], "parent": [483], "node_id": "(487) Exchange", "lineno": 5271, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194540, window#2194436, first#2582059L, valueSet#2582060, count#2582062L, count#2582064L]", "Arguments:": " hashpartitioning(long_ip#2172242L, tguard_status#2194540, window#2194436, 1000), ENSURE_REQUIREMENTS, [id=#1669297]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483"], "size": 51, "equiv": "0"}, "485": {"label": "HashAggregate", "notes": "", "children": [486], "parent": [484], "node_id": "(486) HashAggregate", "lineno": 5272, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194540, window#2194436, __auto_generated_subquery_name.`username`#2581782, t.`application_id`#2581783, gid#2581781, count(t.`long_ip`)#2581785L]", "Keys": " [3]: [long_ip#2172242L, tguard_status#2194540, window#2194436]", "Functions": " [3]: [partial_first(if ((gid#2581781 = 0)) count(t.`long_ip`)#2581785L else null, true) AS (first#2582059L, valueSet#2582060), partial_count(if ((gid#2581781 = 1)) __auto_generated_subquery_name.`username`#2581782 else null) AS count#2582062L, partial_count(if ((gid#2581781 = 2)) t.`application_id`#2581783 else null) AS count#2582064L]", "Aggregate": " Attributes [4]: [first#2582057L, valueSet#2582058, count#2582061L, count#2582063L]", "Results": " [7]: [long_ip#2172242L, tguard_status#2194540, window#2194436, first#2582059L, valueSet#2582060, count#2582062L, count#2582064L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484"], "size": 50, "equiv": "0"}, "486": {"label": "HashAggregate", "notes": "", "children": [487], "parent": [485], "node_id": "(485) HashAggregate", "lineno": 5273, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194540, window#2194436, __auto_generated_subquery_name.`username`#2581782, t.`application_id`#2581783, gid#2581781, count#2582066L]", "Keys": " [6]: [long_ip#2172242L, tguard_status#2194540, window#2194436, __auto_generated_subquery_name.`username`#2581782, t.`application_id`#2581783, gid#2581781]", "Functions": " [1]: [finalmerge_count(merge count#2582066L) AS count(t.`long_ip`#2581784L)#2194430L]", "Aggregate": " Attributes [1]: [count(t.`long_ip`#2581784L)#2194430L]", "Results": " [7]: [long_ip#2172242L, tguard_status#2194540, window#2194436, __auto_generated_subquery_name.`username`#2581782, t.`application_id`#2581783, gid#2581781, count(t.`long_ip`#2581784L)#2194430L AS count(t.`long_ip`)#2581785L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485"], "size": 49, "equiv": "0"}, "487": {"label": "Exchange", "notes": "", "children": [488], "parent": [486], "node_id": "(484) Exchange", "lineno": 5274, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194540, window#2194436, __auto_generated_subquery_name.`username`#2581782, t.`application_id`#2581783, gid#2581781, count#2582066L]", "Arguments:": " hashpartitioning(long_ip#2172242L, tguard_status#2194540, window#2194436, __auto_generated_subquery_name.`username`#2581782, t.`application_id`#2581783, gid#2581781, 1000), ENSURE_REQUIREMENTS, [id=#1669293]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486"], "size": 48, "equiv": "0"}, "488": {"label": "HashAggregate", "notes": "", "children": [489], "parent": [487], "node_id": "(483) HashAggregate", "lineno": 5275, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, tguard_status#2194540, window#2194436, __auto_generated_subquery_name.`username`#2581782, t.`application_id`#2581783, gid#2581781, t.`long_ip`#2581784L]", "Keys": " [6]: [long_ip#2172242L, tguard_status#2194540, window#2194436, __auto_generated_subquery_name.`username`#2581782, t.`application_id`#2581783, gid#2581781]", "Functions": " [1]: [partial_count(t.`long_ip`#2581784L) AS count#2582066L]", "Aggregate": " Attributes [1]: [count#2582065L]", "Results": " [7]: [long_ip#2172242L, tguard_status#2194540, window#2194436, __auto_generated_subquery_name.`username`#2581782, t.`application_id`#2581783, gid#2581781, count#2582066L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487"], "size": 47, "equiv": "0"}, "489": {"label": "Expand", "notes": "", "children": [490], "parent": [488], "node_id": "(482) Expand", "lineno": 5276, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [window#2194436, long_ip#2172242L, username#2192593, application_id#2172243, tguard_status#2194540]", "Arguments:": " [ArrayBuffer(long_ip#2172242L, tguard_status#2194540, window#2194436, null, null, 0, long_ip#2172242L), ArrayBuffer(long_ip#2172242L, tguard_status#2194540, window#2194436, username#2192593, null, 1, null), ArrayBuffer(long_ip#2172242L, tguard_status#2194540, window#2194436, null, application_id#2172243, 2, null)], [long_ip#2172242L, tguard_status#2194540, window#2194436, __auto_generated_subquery_name.`username`#2581782, t.`application_id`#2581783, gid#2581781, t.`long_ip`#2581784L]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488"], "size": 46, "equiv": "6"}, "490": {"label": "Project", "notes": "", "children": [491], "parent": [489], "node_id": "(481) Project", "lineno": 5277, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [window#2194436, long_ip#2172242L, username#2192593, application_id#2172243, tguard_status#2194540]", "Input": " [6]: [window#2194436, long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489"], "size": 45, "equiv": "0"}, "491": {"label": "Filter", "notes": "", "children": [492], "parent": [490], "node_id": "(480) Filter", "lineno": 5278, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [window#2194436, long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540]", "Condition": " : ((isnotnull(window#2194436) AND (transaction_date_time#2172247 >= window#2194436.start)) AND (transaction_date_time#2172247 < window#2194436.end))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490"], "size": 44, "equiv": "0"}, "492": {"label": "Expand", "notes": "", "children": [493], "parent": [491], "node_id": "(479) Expand", "lineno": 5279, "detail": {"note": "Expand", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540]", "Arguments:": " [List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 0) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 1) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 2) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 3) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 3) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 4) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 4) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 5) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 5) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 6) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 6) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 7) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 7) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 8) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 8) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 9) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 9) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 10) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 10) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540), List(named_struct(start, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 11) - 12) * 300000000) + 0), LongType, TimestampType), end, precisetimestampconversion(((((CASE WHEN (cast(CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) as double) = (cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) THEN (CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) + 1) ELSE CEIL((cast((precisetimestampconversion(transaction_date_time#2172247, TimestampType, LongType) - 0) as double) / 3.0E8)) END + 11) - 12) * 300000000) + 3600000000), LongType, TimestampType)), long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540)], [window#2194436, long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540]"}, "full_label": "Expand", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491"], "size": 43, "equiv": "7"}, "493": {"label": "Project", "notes": "", "children": [494], "parent": [492], "node_id": "(478) Project", "lineno": 5280, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540]", "Input": " [6]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540, un#2192556]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492"], "size": 42, "equiv": "0"}, "494": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [495, 530], "parent": [493], "node_id": "(477) SortMergeJoin", "lineno": 5281, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [username#2192593]", "Right": " keys [1]: [un#2192556]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493"], "size": 41, "equiv": "0"}, "495": {"label": "Sort", "notes": "", "children": [496], "parent": [494], "node_id": "(471) Sort", "lineno": 5282, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540]", "Arguments:": " [username#2192593 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494"], "size": 35, "equiv": "0"}, "496": {"label": "Exchange", "notes": "", "children": [497], "parent": [495], "node_id": "(470) Exchange", "lineno": 5283, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, username#2192593, application_id#2172243, transaction_date_time#2172247, tguard_status#2194540]", "Arguments:": " hashpartitioning(username#2192593, 1000), ENSURE_REQUIREMENTS, [id=#1669281]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495"], "size": 34, "equiv": "0"}, "497": {"label": "Project", "notes": "", "children": [498], "parent": [496], "node_id": "(469) Project", "lineno": 5284, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, userName#2172244 AS username#2192593, application_id#2172243, transaction_date_time#2172247, status#2172245 AS tguard_status#2194540]", "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496"], "size": 33, "equiv": "0"}, "498": {"label": "Filter", "notes": "", "children": [499], "parent": [497], "node_id": "(468) Filter", "lineno": 5285, "detail": {"note": "Filter", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247, exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Condition": " : isnull(ip_whitelist_flg#2192601)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497"], "size": 32, "equiv": "0"}, "499": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [500, 525], "parent": [498], "node_id": "(467) SortMergeJoin", "lineno": 5286, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498"], "size": 31, "equiv": "0"}, "500": {"label": "Sort", "notes": "", "children": [501], "parent": [499], "node_id": "(461) Sort", "lineno": 5287, "detail": {"note": "Sort", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499"], "size": 25, "equiv": "0"}, "501": {"label": "Exchange", "notes": "", "children": [502], "parent": [500], "node_id": "(460) Exchange", "lineno": 5288, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669272]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500"], "size": 24, "equiv": "0"}, "502": {"label": "Project", "notes": "", "children": [503], "parent": [501], "node_id": "(459) Project", "lineno": 5289, "detail": {"note": "Project", "lineno": 5461, "Output": " [5]: [long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501"], "size": 23, "equiv": "0"}, "503": {"label": "BroadcastHashJoin LeftAnti BuildRight", "notes": "", "children": [504, 507], "parent": [502], "node_id": "(458) BroadcastHashJoin", "lineno": 5290, "detail": {"note": "BroadcastHashJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2192616]", "Join": " condition: None"}, "full_label": "BroadcastHashJoin LeftAnti BuildRight", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502"], "size": 22, "equiv": "0"}, "504": {"label": "Filter", "notes": "", "children": [505], "parent": [503], "node_id": "(440) Filter", "lineno": 5291, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Condition": " : ((status#2172245 = SUCCESS) AND isnotnull(transaction_date_time#2172247))"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503"], "size": 3, "equiv": "8"}, "505": {"label": "InMemoryTableScan", "notes": "", "children": [506], "parent": [504], "node_id": "(439) InMemoryTableScan", "lineno": 5292, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userName#2172244, status#2172245, transaction_date_time#2172247], [(status#2172245 = SUCCESS), isnotnull(transaction_date_time#2172247)]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "504"], "size": 2, "equiv": "3"}, "506": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [505], "node_id": "(440) InMemoryRelation", "lineno": 5293, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "504", "505"], "size": 1, "equiv": "0"}, "507": {"label": "BroadcastExchange", "notes": "", "children": [508], "parent": [503], "node_id": "(457) BroadcastExchange", "lineno": 5304, "detail": {"note": "BroadcastExchange", "lineno": 5461, "Input": " [1]: [ip_address#2192616]", "Arguments:": " HashedRelationBroadcastMode(List(input[0, string, true]),true), [id=#1669267]"}, "full_label": "BroadcastExchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503"], "size": 18, "equiv": "1"}, "508": {"label": "Project", "notes": "", "children": [509], "parent": [507], "node_id": "(456) Project", "lineno": 5305, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2192616]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507"], "size": 17, "equiv": "2"}, "509": {"label": "Filter", "notes": "", "children": [510], "parent": [508], "node_id": "(455) Filter", "lineno": 5306, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2192615L]", "Condition": " : (ip_trans_cnt#2192615L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508"], "size": 16, "equiv": "0"}, "510": {"label": "HashAggregate", "notes": "", "children": [511], "parent": [509], "node_id": "(454) HashAggregate", "lineno": 5307, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210409L) AS count(1)#2192632L]", "Aggregate": " Attributes [1]: [count(1)#2192632L]", "Results": " [2]: [ip_address#2172241, count(1)#2192632L AS ip_trans_cnt#2192615L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509"], "size": 15, "equiv": "0"}, "511": {"label": "Exchange", "notes": "", "children": [512], "parent": [510], "node_id": "(453) Exchange", "lineno": 5308, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210409L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1669262]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510"], "size": 14, "equiv": "0"}, "512": {"label": "HashAggregate", "notes": "", "children": [513], "parent": [511], "node_id": "(452) HashAggregate", "lineno": 5309, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210409L]", "Aggregate": " Attributes [1]: [count#2210408L]", "Results": " [2]: [ip_address#2172241, count#2210409L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511"], "size": 13, "equiv": "0"}, "513": {"label": "Project", "notes": "", "children": [514], "parent": [512], "node_id": "(451) Project", "lineno": 5310, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512"], "size": 12, "equiv": "0"}, "514": {"label": "Filter", "notes": "", "children": [515], "parent": [513], "node_id": "(450) Filter", "lineno": 5311, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Condition": " : isnull(ip_whitelist_flg#2192618)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513"], "size": 11, "equiv": "0"}, "515": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [516, 520], "parent": [514], "node_id": "(449) SortMergeJoin", "lineno": 5312, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513", "514"], "size": 10, "equiv": "0"}, "516": {"label": "Sort", "notes": "", "children": [517], "parent": [515], "node_id": "(443) Sort", "lineno": 5313, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513", "514", "515"], "size": 4, "equiv": "0"}, "517": {"label": "Exchange", "notes": "", "children": [518], "parent": [516], "node_id": "(442) Exchange", "lineno": 5314, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669253]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513", "514", "515", "516"], "size": 3, "equiv": "0"}, "518": {"label": "InMemoryTableScan", "notes": "", "children": [519], "parent": [517], "node_id": "(441) InMemoryTableScan", "lineno": 5315, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513", "514", "515", "516", "517"], "size": 2, "equiv": "3"}, "519": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [518], "node_id": "(442) InMemoryRelation", "lineno": 5316, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513", "514", "515", "516", "517", "518"], "size": 1, "equiv": "0"}, "520": {"label": "Sort", "notes": "", "children": [521], "parent": [515], "node_id": "(448) Sort", "lineno": 5327, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513", "514", "515"], "size": 5, "equiv": "4"}, "521": {"label": "Exchange", "notes": "", "children": [522], "parent": [520], "node_id": "(447) Exchange", "lineno": 5328, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192618]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669254]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513", "514", "515", "520"], "size": 4, "equiv": "0"}, "522": {"label": "Project", "notes": "", "children": [523], "parent": [521], "node_id": "(446) Project", "lineno": 5329, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192618]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513", "514", "515", "520", "521"], "size": 3, "equiv": "0"}, "523": {"label": "Filter", "notes": "", "children": [524], "parent": [522], "node_id": "(445) Filter", "lineno": 5330, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513", "514", "515", "520", "521", "522"], "size": 2, "equiv": "0"}, "524": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [523], "node_id": "(444) Scan", "lineno": 5331, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "500", "501", "502", "503", "507", "508", "509", "510", "511", "512", "513", "514", "515", "520", "521", "522", "523"], "size": 1, "equiv": "0"}, "525": {"label": "Sort", "notes": "", "children": [526], "parent": [499], "node_id": "(466) Sort", "lineno": 5332, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499"], "size": 5, "equiv": "4"}, "526": {"label": "Exchange", "notes": "", "children": [527], "parent": [525], "node_id": "(465) Exchange", "lineno": 5333, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2192601]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669273]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "525"], "size": 4, "equiv": "0"}, "527": {"label": "Project", "notes": "", "children": [528], "parent": [526], "node_id": "(464) Project", "lineno": 5334, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2192601]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "525", "526"], "size": 3, "equiv": "0"}, "528": {"label": "Filter", "notes": "", "children": [529], "parent": [527], "node_id": "(463) Filter", "lineno": 5335, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "525", "526", "527"], "size": 2, "equiv": "0"}, "529": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [528], "node_id": "(462) Scan", "lineno": 5336, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "495", "496", "497", "498", "499", "525", "526", "527", "528"], "size": 1, "equiv": "0"}, "530": {"label": "Sort", "notes": "", "children": [531], "parent": [494], "node_id": "(476) Sort", "lineno": 5337, "detail": {"note": "Sort", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " [un#2192556 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494"], "size": 5, "equiv": "4"}, "531": {"label": "Exchange", "notes": "", "children": [532], "parent": [530], "node_id": "(475) Exchange", "lineno": 5338, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [1]: [un#2192556]", "Arguments:": " hashpartitioning(un#2192556, 1000), ENSURE_REQUIREMENTS, [id=#1669282]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "530"], "size": 4, "equiv": "0"}, "532": {"label": "Project", "notes": "", "children": [533], "parent": [531], "node_id": "(474) Project", "lineno": 5339, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [userName#2175089 AS un#2192556]", "Input": " [2]: [userName#2175089, data_dt#2175091]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "530", "531"], "size": 3, "equiv": "0"}, "533": {"label": "Filter", "notes": "", "children": [534], "parent": [532], "node_id": "(473) Filter", "lineno": 5340, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [userName#2175089, data_dt#2175091]", "Condition": " : isnotnull(userName#2175089)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "530", "531", "532"], "size": 2, "equiv": "0"}, "534": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [533], "node_id": "(472) Scan", "lineno": 5341, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [2]: [userName#2175089, data_dt#2175091]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/usr_distip_cnt_map]", "PartitionFilters:": " [isnotnull(data_dt#2175091), (data_dt#2175091 = 2022080317)]", "PushedFilters:": " [IsNotNull(userName)]", "ReadSchema:": " struct<userName:string>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "422", "423", "424", "425", "426", "481", "482", "483", "484", "485", "486", "487", "488", "489", "490", "491", "492", "493", "494", "530", "531", "532", "533"], "size": 1, "equiv": "0"}, "535": {"label": "Project", "notes": "", "children": [536], "parent": [9], "node_id": "(567) Project", "lineno": 5342, "detail": {"note": "Project", "lineno": 5461, "Output": " [59]: [coalesce(long_ip#2172242L, long_ip#2197059L) AS long_ip#2196781L, coalesce(window#2196879, window#2197008) AS window#2196782, (coalesce(cnt_attempts_ip_5m#2196880, 0.0) + coalesce(cnt_attempts_ip_5m#2197009, 0.0)) AS cnt_attempts_ip_5m#2196783, (coalesce(cnt_dist_usr_5m#2196881, 0.0) + coalesce(cnt_dist_usr_5m#2197010, 0.0)) AS cnt_dist_usr_5m#2196784, 2 AS cnt_dist_app_5m#2197130L, [] AS app_id_set_5m#2197131, [] AS userAgent_5m#2197132, [] AS username_set_5m#2197133, coalesce(ip_address#2172241, ip_address#2197058) AS ip_address#2196789, greatest(attsdk_flag#2196845, attsdk_flag#2196974) AS attsdk_flag#2196790, cast((attsdk_flag#2196845 + attsdk_flag#2196974) as bigint) AS sum_attsdk_flag_5m_cnt#2197134L, 3 AS max_targeted_user_score#2196792, 3 AS min_targeted_user_score#2196793, 3 AS 50th_targeted_user_score#2196794, 3 AS 75th_targeted_user_score#2196795, 3 AS 90th_targeted_user_score#2196796, (coalesce(50th_cnt_5m#2196888, 0.0) + coalesce(50th_cnt_5m#2197017, 0.0)) AS 50th_cnt_5m#2196797, (coalesce(50th_cntDistUser_5m#2196889, 0.0) + coalesce(50th_cntDistUser_5m#2197018, 0.0)) AS 50th_cntDistUser_5m#2196798, 2 AS 50th_cntDistApp_5m#2197135L, (coalesce(50th_cnt_15m#2196891, 0.0) + coalesce(50th_cnt_15m#2197020, 0.0)) AS 50th_cnt_15m#2196800, (coalesce(50th_cntDistUser_15m#2196892, 0.0) + coalesce(50th_cntDistUser_15m#2197021, 0.0)) AS 50th_cntDistUser_15m#2196801, 2 AS 50th_cntDistApp_15m#2197136L, (coalesce(50th_cnt_60m#2196894, 0.0) + coalesce(50th_cnt_60m#2197023, 0.0)) AS 50th_cnt_60m#2196803, (coalesce(50th_cntDistUser_60m#2196895, 0.0) + coalesce(50th_cntDistUser_60m#2197024, 0.0)) AS 50th_cntDistUser_60m#2196804, 2 AS 50th_cntDistApp_60m#2197137L, (4500.0 / cast((coalesce(cnt#2196840L, 0) + coalesce(cnt#2196969L, 0)) as double)) AS 50th_timedelta_5m#2196806, ((4500.0 / cast((coalesce(cnt#2196840L, 0) + coalesce(cnt#2196969L, 0)) as double)) * 0.01) AS stddev_timedelta_5m#2196807, coalesce(tguard_data_dt#2196844, tguard_data_dt#2196973) AS tguard_data_dt#2196808, (coalesce(cnt_attempts_ip_15m#2196900, 0.0) + coalesce(cnt_attempts_ip_15m#2197029, 0.0)) AS cnt_attempts_ip_15m#2196809, (coalesce(cnt_attempts_ip_15m#2196900, 0.0) + coalesce(cnt_attempts_ip_15m#2197029, 0.0)) AS cnt_dist_usr_15m#2196810, 2 AS cnt_dist_app_15m#2197138L, [] AS app_id_set_15m#2197139, (4500.0 / cast((coalesce(cnt#2196840L, 0) + coalesce(cnt#2196969L, 0)) as double)) AS 50th_timedelta_15m#2196813, ((4500.0 / cast((coalesce(cnt#2196840L, 0) + coalesce(cnt#2196969L, 0)) as double)) * 0.01) AS stddev_timedelta_15m#2196814, (coalesce(cnt_attempts_ip_60m#2196906, 0.0) + coalesce(cnt_attempts_ip_60m#2197035, 0.0)) AS cnt_attempts_ip_60m#2196815, (coalesce(cnt_attempts_ip_60m#2196906, 0.0) + coalesce(cnt_attempts_ip_60m#2197035, 0.0)) AS cnt_dist_usr_60m#2196816, 2 AS cnt_dist_app_60m#2197140L, [] AS app_id_set_60m#2197141, (4500.0 / cast((coalesce(cnt#2196840L, 0) + coalesce(cnt#2196969L, 0)) as double)) AS 50th_timedelta_60m#2196819, ((4500.0 / cast((coalesce(cnt#2196840L, 0) + coalesce(cnt#2196969L, 0)) as double)) * 0.01) AS stddev_timedelta_60m#2196820, coalesce(50th_cnt_5m#2197017, 0.0) AS 5m_success_count#2196821, coalesce(50th_cnt_5m#2196888, 0.0) AS 5m_failed_count#2196822, coalesce(50th_cnt_5m#2197017, 0.0) AS 5m_suc_dist_usr#2196823, coalesce(50th_cnt_5m#2196888, 0.0) AS 5m_fail_dist_usr#2196824, cast(coalesce(50th_cntDistApp_5m#2197019, 0) as bigint) AS 5m_suc_dist_app#2197142L, cast(coalesce(50th_cntDistApp_5m#2196890, 0) as bigint) AS 5m_fail_dist_app#2197143L, coalesce(50th_cnt_15m#2197020, 0.0) AS 15m_success_count#2196827, coalesce(50th_cnt_15m#2196891, 0.0) AS 15m_failed_count#2196828, coalesce(50th_cnt_15m#2197020, 0.0) AS 15m_suc_dist_usr#2196829, coalesce(50th_cnt_15m#2196891, 0.0) AS 15m_fail_dist_usr#2196830, cast(coalesce(50th_cntDistApp_15m#2197022, 0) as bigint) AS 15m_suc_dist_app#2197144L, cast(coalesce(50th_cntDistApp_15m#2196893, 0) as bigint) AS 15m_fail_dist_app#2197145L, coalesce(50th_cnt_60m#2197023, 0.0) AS 60m_success_count#2196833, coalesce(50th_cnt_60m#2196894, 0.0) AS 60m_failed_count#2196834, coalesce(50th_cnt_60m#2197023, 0.0) AS 60m_suc_dist_usr#2196835, coalesce(50th_cnt_60m#2196894, 0.0) AS 60m_fail_dist_usr#2196836, cast(coalesce(50th_cntDistApp_60m#2197025, 0) as bigint) AS 60m_suc_dist_app#2197146L, cast(coalesce(50th_cntDistApp_60m#2196896, 0) as bigint) AS 60m_fail_dist_app#2197147L, 1 AS heavy_hitters_flag#2196839]", "Input": " [38]: [long_ip#2172242L, window#2196879, cnt_attempts_ip_5m#2196880, cnt_dist_usr_5m#2196881, ip_address#2172241, attsdk_flag#2196845, 50th_cnt_5m#2196888, 50th_cntDistUser_5m#2196889, 50th_cntDistApp_5m#2196890, 50th_cnt_15m#2196891, 50th_cntDistUser_15m#2196892, 50th_cntDistApp_15m#2196893, 50th_cnt_60m#2196894, 50th_cntDistUser_60m#2196895, 50th_cntDistApp_60m#2196896, tguard_data_dt#2196844, cnt_attempts_ip_15m#2196900, cnt_attempts_ip_60m#2196906, cnt#2196840L, long_ip#2197059L, window#2197008, cnt_attempts_ip_5m#2197009, cnt_dist_usr_5m#2197010, ip_address#2197058, attsdk_flag#2196974, 50th_cnt_5m#2197017, 50th_cntDistUser_5m#2197018, 50th_cntDistApp_5m#2197019, 50th_cnt_15m#2197020, 50th_cntDistUser_15m#2197021, 50th_cntDistApp_15m#2197022, 50th_cnt_60m#2197023, 50th_cntDistUser_60m#2197024, 50th_cntDistApp_60m#2197025, tguard_data_dt#2196973, cnt_attempts_ip_15m#2197029, cnt_attempts_ip_60m#2197035, cnt#2196969L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9"], "size": 74, "equiv": "0"}, "536": {"label": "SortMergeJoin FullOuter", "notes": "", "children": [537, 573], "parent": [535], "node_id": "(566) SortMergeJoin", "lineno": 5343, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [long_ip#2197059L]", "Join": " condition: None"}, "full_label": "SortMergeJoin FullOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535"], "size": 73, "equiv": "0"}, "537": {"label": "Project", "notes": "", "children": [538], "parent": [536], "node_id": "(531) Project", "lineno": 5344, "detail": {"note": "Project", "lineno": 5461, "Output": " [19]: [long_ip#2172242L, named_struct(start, min_transaction_date_time#2196843, end, max_transaction_date_time#2196842) AS window#2196879, (cast((cnt#2196840L * 5) as double) / 75.0) AS cnt_attempts_ip_5m#2196880, (cast((cnt#2196840L * 5) as double) / 75.0) AS cnt_dist_usr_5m#2196881, ip_address#2172241, attsdk_flag#2196845, (cast((cnt#2196840L * 5) as double) / 75.0) AS 50th_cnt_5m#2196888, (cast((cnt#2196840L * 5) as double) / 75.0) AS 50th_cntDistUser_5m#2196889, 2 AS 50th_cntDistApp_5m#2196890, (cast((cnt#2196840L * 15) as double) / 75.0) AS 50th_cnt_15m#2196891, (cast((cnt#2196840L * 15) as double) / 75.0) AS 50th_cntDistUser_15m#2196892, 2 AS 50th_cntDistApp_15m#2196893, (cast((cnt#2196840L * 60) as double) / 75.0) AS 50th_cnt_60m#2196894, (cast((cnt#2196840L * 60) as double) / 75.0) AS 50th_cntDistUser_60m#2196895, 2 AS 50th_cntDistApp_60m#2196896, tguard_data_dt#2196844, (cast((cnt#2196840L * 15) as double) / 75.0) AS cnt_attempts_ip_15m#2196900, (cast((cnt#2196840L * 60) as double) / 75.0) AS cnt_attempts_ip_60m#2196906, cnt#2196840L]", "Input": " [7]: [cnt#2196840L, ip_address#2172241, long_ip#2172242L, max_transaction_date_time#2196842, min_transaction_date_time#2196843, tguard_data_dt#2196844, attsdk_flag#2196845]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536"], "size": 36, "equiv": "12"}, "538": {"label": "SortAggregate", "notes": "", "children": [539], "parent": [537], "node_id": "(530) SortAggregate", "lineno": 5345, "detail": {"note": "SortAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2172242L, ip_address#2172241, status#2172245, count#2211951L, max#2582068, max#2582070, max#2582072]", "Keys": " [3]: [long_ip#2172242L, ip_address#2172241, status#2172245]", "Functions": " [4]: [finalmerge_count(merge count#2211951L) AS count(1)#2196963L, finalmerge_max(merge max#2582068) AS max(transaction_date_time#2172247)#2196964, finalmerge_max(merge max#2582070) AS max(data_dt#2172101)#2196966, finalmerge_max(merge max#2582072) AS max(attsdk_flag#2172246)#2196967]", "Aggregate": " Attributes [4]: [count(1)#2196963L, max(transaction_date_time#2172247)#2196964, max(data_dt#2172101)#2196966, max(attsdk_flag#2172246)#2196967]", "Results": " [7]: [count(1)#2196963L AS cnt#2196840L, ip_address#2172241, long_ip#2172242L, max(transaction_date_time#2172247)#2196964 AS max_transaction_date_time#2196842, max(transaction_date_time#2172247)#2196964 AS min_transaction_date_time#2196843, max(data_dt#2172101)#2196966 AS tguard_data_dt#2196844, max(attsdk_flag#2172246)#2196967 AS attsdk_flag#2196845]"}, "full_label": "SortAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537"], "size": 35, "equiv": "0"}, "539": {"label": "SortAggregate", "notes": "", "children": [540], "parent": [538], "node_id": "(529) SortAggregate", "lineno": 5346, "detail": {"note": "SortAggregate", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Keys": " [3]: [long_ip#2172242L, ip_address#2172241, status#2172245]", "Functions": " [4]: [partial_count(1) AS count#2211951L, partial_max(transaction_date_time#2172247) AS max#2582068, partial_max(data_dt#2172101) AS max#2582070, partial_max(attsdk_flag#2172246) AS max#2582072]", "Aggregate": " Attributes [4]: [count#2211950L, max#2582067, max#2582069, max#2582071]", "Results": " [7]: [long_ip#2172242L, ip_address#2172241, status#2172245, count#2211951L, max#2582068, max#2582070, max#2582072]"}, "full_label": "SortAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538"], "size": 34, "equiv": "0"}, "540": {"label": "Sort", "notes": "", "children": [541], "parent": [539], "node_id": "(528) Sort", "lineno": 5347, "detail": {"note": "Sort", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST, ip_address#2172241 ASC NULLS FIRST, status#2172245 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539"], "size": 33, "equiv": "0"}, "541": {"label": "Project", "notes": "", "children": [542], "parent": [540], "node_id": "(527) Project", "lineno": 5348, "detail": {"note": "Project", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Input": " [8]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, exploded_ip#2174776L, ip_whitelist_flg#2196927]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540"], "size": 32, "equiv": "0"}, "542": {"label": "Filter", "notes": "", "children": [543], "parent": [541], "node_id": "(526) Filter", "lineno": 5349, "detail": {"note": "Filter", "lineno": 5461, "Input": " [8]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, exploded_ip#2174776L, ip_whitelist_flg#2196927]", "Condition": " : isnull(ip_whitelist_flg#2196927)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541"], "size": 31, "equiv": "0"}, "543": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [544, 568], "parent": [542], "node_id": "(525) SortMergeJoin", "lineno": 5350, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542"], "size": 30, "equiv": "0"}, "544": {"label": "Sort", "notes": "", "children": [545], "parent": [543], "node_id": "(519) Sort", "lineno": 5351, "detail": {"note": "Sort", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543"], "size": 24, "equiv": "0"}, "545": {"label": "Exchange", "notes": "", "children": [546], "parent": [544], "node_id": "(518) Exchange", "lineno": 5352, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669334]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544"], "size": 23, "equiv": "0"}, "546": {"label": "SortMergeJoin LeftSemi", "notes": "", "children": [547, 550], "parent": [545], "node_id": "(517) SortMergeJoin", "lineno": 5353, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2196942]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftSemi", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545"], "size": 22, "equiv": "0"}, "547": {"label": "Filter", "notes": "", "children": [548], "parent": [546], "node_id": "(499) Filter", "lineno": 5354, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Condition": " : (status#2172245 = FAILED)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546"], "size": 3, "equiv": "8"}, "548": {"label": "InMemoryTableScan", "notes": "", "children": [549], "parent": [547], "node_id": "(498) InMemoryTableScan", "lineno": 5355, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101], [(status#2172245 = FAILED)]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "547"], "size": 2, "equiv": "3"}, "549": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [548], "node_id": "(499) InMemoryRelation", "lineno": 5356, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "547", "548"], "size": 1, "equiv": "0"}, "550": {"label": "Sort", "notes": "", "children": [551], "parent": [546], "node_id": "(516) Sort", "lineno": 5367, "detail": {"note": "Sort", "lineno": 5461, "Input": " [1]: [ip_address#2196942]", "Arguments:": " [ip_address#2196942 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546"], "size": 18, "equiv": "0"}, "551": {"label": "Project", "notes": "", "children": [552], "parent": [550], "node_id": "(515) Project", "lineno": 5368, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2196942]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2196941L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550"], "size": 17, "equiv": "2"}, "552": {"label": "Filter", "notes": "", "children": [553], "parent": [551], "node_id": "(514) Filter", "lineno": 5369, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2196941L]", "Condition": " : (ip_trans_cnt#2196941L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551"], "size": 16, "equiv": "0"}, "553": {"label": "HashAggregate", "notes": "", "children": [554], "parent": [552], "node_id": "(513) HashAggregate", "lineno": 5370, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210411L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210411L) AS count(1)#2196958L]", "Aggregate": " Attributes [1]: [count(1)#2196958L]", "Results": " [2]: [ip_address#2172241, count(1)#2196958L AS ip_trans_cnt#2196941L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552"], "size": 15, "equiv": "0"}, "554": {"label": "Exchange", "notes": "", "children": [555], "parent": [553], "node_id": "(512) Exchange", "lineno": 5371, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210411L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1669324]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553"], "size": 14, "equiv": "0"}, "555": {"label": "HashAggregate", "notes": "", "children": [556], "parent": [554], "node_id": "(511) HashAggregate", "lineno": 5372, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210411L]", "Aggregate": " Attributes [1]: [count#2210410L]", "Results": " [2]: [ip_address#2172241, count#2210411L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554"], "size": 13, "equiv": "0"}, "556": {"label": "Project", "notes": "", "children": [557], "parent": [555], "node_id": "(510) Project", "lineno": 5373, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2196944]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555"], "size": 12, "equiv": "0"}, "557": {"label": "Filter", "notes": "", "children": [558], "parent": [556], "node_id": "(509) Filter", "lineno": 5374, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2196944]", "Condition": " : isnull(ip_whitelist_flg#2196944)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556"], "size": 11, "equiv": "0"}, "558": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [559, 563], "parent": [557], "node_id": "(508) SortMergeJoin", "lineno": 5375, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556", "557"], "size": 10, "equiv": "0"}, "559": {"label": "Sort", "notes": "", "children": [560], "parent": [558], "node_id": "(502) Sort", "lineno": 5376, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556", "557", "558"], "size": 4, "equiv": "0"}, "560": {"label": "Exchange", "notes": "", "children": [561], "parent": [559], "node_id": "(501) Exchange", "lineno": 5377, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669315]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556", "557", "558", "559"], "size": 3, "equiv": "0"}, "561": {"label": "InMemoryTableScan", "notes": "", "children": [562], "parent": [560], "node_id": "(500) InMemoryTableScan", "lineno": 5378, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556", "557", "558", "559", "560"], "size": 2, "equiv": "3"}, "562": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [561], "node_id": "(501) InMemoryRelation", "lineno": 5379, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556", "557", "558", "559", "560", "561"], "size": 1, "equiv": "0"}, "563": {"label": "Sort", "notes": "", "children": [564], "parent": [558], "node_id": "(507) Sort", "lineno": 5390, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2196944]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556", "557", "558"], "size": 5, "equiv": "4"}, "564": {"label": "Exchange", "notes": "", "children": [565], "parent": [563], "node_id": "(506) Exchange", "lineno": 5391, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2196944]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669316]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556", "557", "558", "563"], "size": 4, "equiv": "0"}, "565": {"label": "Project", "notes": "", "children": [566], "parent": [564], "node_id": "(505) Project", "lineno": 5392, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2196944]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556", "557", "558", "563", "564"], "size": 3, "equiv": "0"}, "566": {"label": "Filter", "notes": "", "children": [567], "parent": [565], "node_id": "(504) Filter", "lineno": 5393, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556", "557", "558", "563", "564", "565"], "size": 2, "equiv": "0"}, "567": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [566], "node_id": "(503) Scan", "lineno": 5394, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "544", "545", "546", "550", "551", "552", "553", "554", "555", "556", "557", "558", "563", "564", "565", "566"], "size": 1, "equiv": "0"}, "568": {"label": "Sort", "notes": "", "children": [569], "parent": [543], "node_id": "(524) Sort", "lineno": 5395, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2196927]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543"], "size": 5, "equiv": "4"}, "569": {"label": "Exchange", "notes": "", "children": [570], "parent": [568], "node_id": "(523) Exchange", "lineno": 5396, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2196927]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669335]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "568"], "size": 4, "equiv": "0"}, "570": {"label": "Project", "notes": "", "children": [571], "parent": [569], "node_id": "(522) Project", "lineno": 5397, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2196927]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "568", "569"], "size": 3, "equiv": "0"}, "571": {"label": "Filter", "notes": "", "children": [572], "parent": [570], "node_id": "(521) Filter", "lineno": 5398, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "568", "569", "570"], "size": 2, "equiv": "0"}, "572": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [571], "node_id": "(520) Scan", "lineno": 5399, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "537", "538", "539", "540", "541", "542", "543", "568", "569", "570", "571"], "size": 1, "equiv": "0"}, "573": {"label": "Project", "notes": "", "children": [574], "parent": [536], "node_id": "(565) Project", "lineno": 5400, "detail": {"note": "Project", "lineno": 5461, "Output": " [19]: [long_ip#2197059L, named_struct(start, min_transaction_date_time#2196972, end, max_transaction_date_time#2196971) AS window#2197008, (cast((cnt#2196969L * 5) as double) / 75.0) AS cnt_attempts_ip_5m#2197009, (cast((cnt#2196969L * 5) as double) / 75.0) AS cnt_dist_usr_5m#2197010, ip_address#2197058, attsdk_flag#2196974, (cast((cnt#2196969L * 5) as double) / 75.0) AS 50th_cnt_5m#2197017, (cast((cnt#2196969L * 5) as double) / 75.0) AS 50th_cntDistUser_5m#2197018, 2 AS 50th_cntDistApp_5m#2197019, (cast((cnt#2196969L * 15) as double) / 75.0) AS 50th_cnt_15m#2197020, (cast((cnt#2196969L * 15) as double) / 75.0) AS 50th_cntDistUser_15m#2197021, 2 AS 50th_cntDistApp_15m#2197022, (cast((cnt#2196969L * 60) as double) / 75.0) AS 50th_cnt_60m#2197023, (cast((cnt#2196969L * 60) as double) / 75.0) AS 50th_cntDistUser_60m#2197024, 2 AS 50th_cntDistApp_60m#2197025, tguard_data_dt#2196973, (cast((cnt#2196969L * 15) as double) / 75.0) AS cnt_attempts_ip_15m#2197029, (cast((cnt#2196969L * 60) as double) / 75.0) AS cnt_attempts_ip_60m#2197035, cnt#2196969L]", "Input": " [7]: [cnt#2196969L, ip_address#2197058, long_ip#2197059L, max_transaction_date_time#2196971, min_transaction_date_time#2196972, tguard_data_dt#2196973, attsdk_flag#2196974]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536"], "size": 36, "equiv": "12"}, "574": {"label": "SortAggregate", "notes": "", "children": [575], "parent": [573], "node_id": "(564) SortAggregate", "lineno": 5401, "detail": {"note": "SortAggregate", "lineno": 5461, "Input": " [7]: [long_ip#2197059L, ip_address#2197058, status#2172245, count#2211959L, max#2582074, max#2582076, max#2582078]", "Keys": " [3]: [long_ip#2197059L, ip_address#2197058, status#2172245]", "Functions": " [4]: [finalmerge_count(merge count#2211959L) AS count(1)#2197092L, finalmerge_max(merge max#2582074) AS max(transaction_date_time#2172247)#2197093, finalmerge_max(merge max#2582076) AS max(data_dt#2172101)#2197095, finalmerge_max(merge max#2582078) AS max(attsdk_flag#2172246)#2197096]", "Aggregate": " Attributes [4]: [count(1)#2197092L, max(transaction_date_time#2172247)#2197093, max(data_dt#2172101)#2197095, max(attsdk_flag#2172246)#2197096]", "Results": " [7]: [count(1)#2197092L AS cnt#2196969L, ip_address#2197058, long_ip#2197059L, max(transaction_date_time#2172247)#2197093 AS max_transaction_date_time#2196971, max(transaction_date_time#2172247)#2197093 AS min_transaction_date_time#2196972, max(data_dt#2172101)#2197095 AS tguard_data_dt#2196973, max(attsdk_flag#2172246)#2197096 AS attsdk_flag#2196974]"}, "full_label": "SortAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573"], "size": 35, "equiv": "0"}, "575": {"label": "SortAggregate", "notes": "", "children": [576], "parent": [574], "node_id": "(563) SortAggregate", "lineno": 5402, "detail": {"note": "SortAggregate", "lineno": 5461, "Input": " [6]: [ip_address#2197058, long_ip#2197059L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Keys": " [3]: [long_ip#2197059L, ip_address#2197058, status#2172245]", "Functions": " [4]: [partial_count(1) AS count#2211959L, partial_max(transaction_date_time#2172247) AS max#2582074, partial_max(data_dt#2172101) AS max#2582076, partial_max(attsdk_flag#2172246) AS max#2582078]", "Aggregate": " Attributes [4]: [count#2211958L, max#2582073, max#2582075, max#2582077]", "Results": " [7]: [long_ip#2197059L, ip_address#2197058, status#2172245, count#2211959L, max#2582074, max#2582076, max#2582078]"}, "full_label": "SortAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574"], "size": 34, "equiv": "0"}, "576": {"label": "Sort", "notes": "", "children": [577], "parent": [575], "node_id": "(562) Sort", "lineno": 5403, "detail": {"note": "Sort", "lineno": 5461, "Input": " [6]: [ip_address#2197058, long_ip#2197059L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Arguments:": " [long_ip#2197059L ASC NULLS FIRST, ip_address#2197058 ASC NULLS FIRST, status#2172245 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575"], "size": 33, "equiv": "0"}, "577": {"label": "Project", "notes": "", "children": [578], "parent": [576], "node_id": "(561) Project", "lineno": 5404, "detail": {"note": "Project", "lineno": 5461, "Output": " [6]: [ip_address#2172241 AS ip_address#2197058, long_ip#2172242L AS long_ip#2197059L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Input": " [8]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, exploded_ip#2174776L, ip_whitelist_flg#2197056]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576"], "size": 32, "equiv": "0"}, "578": {"label": "Filter", "notes": "", "children": [579], "parent": [577], "node_id": "(560) Filter", "lineno": 5405, "detail": {"note": "Filter", "lineno": 5461, "Input": " [8]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, exploded_ip#2174776L, ip_whitelist_flg#2197056]", "Condition": " : isnull(ip_whitelist_flg#2197056)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577"], "size": 31, "equiv": "0"}, "579": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [580, 604], "parent": [578], "node_id": "(559) SortMergeJoin", "lineno": 5406, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578"], "size": 30, "equiv": "0"}, "580": {"label": "Sort", "notes": "", "children": [581], "parent": [579], "node_id": "(553) Sort", "lineno": 5407, "detail": {"note": "Sort", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579"], "size": 24, "equiv": "0"}, "581": {"label": "Exchange", "notes": "", "children": [582], "parent": [580], "node_id": "(552) Exchange", "lineno": 5408, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669366]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580"], "size": 23, "equiv": "0"}, "582": {"label": "SortMergeJoin LeftSemi", "notes": "", "children": [583, 586], "parent": [581], "node_id": "(551) SortMergeJoin", "lineno": 5409, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [ip_address#2172241]", "Right": " keys [1]: [ip_address#2197071]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftSemi", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581"], "size": 22, "equiv": "0"}, "583": {"label": "Filter", "notes": "", "children": [584], "parent": [582], "node_id": "(533) Filter", "lineno": 5410, "detail": {"note": "Filter", "lineno": 5461, "Input": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Condition": " : (status#2172245 = SUCCESS)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582"], "size": 3, "equiv": "8"}, "584": {"label": "InMemoryTableScan", "notes": "", "children": [585], "parent": [583], "node_id": "(532) InMemoryTableScan", "lineno": 5411, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [6]: [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101]", "Arguments:": " [ip_address#2172241, long_ip#2172242L, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101], [(status#2172245 = SUCCESS)]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "583"], "size": 2, "equiv": "3"}, "585": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [584], "node_id": "(533) InMemoryRelation", "lineno": 5412, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "583", "584"], "size": 1, "equiv": "0"}, "586": {"label": "Sort", "notes": "", "children": [587], "parent": [582], "node_id": "(550) Sort", "lineno": 5423, "detail": {"note": "Sort", "lineno": 5461, "Input": " [1]: [ip_address#2197071]", "Arguments:": " [ip_address#2197071 ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582"], "size": 18, "equiv": "0"}, "587": {"label": "Project", "notes": "", "children": [588], "parent": [586], "node_id": "(549) Project", "lineno": 5424, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241 AS ip_address#2197071]", "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2197070L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586"], "size": 17, "equiv": "2"}, "588": {"label": "Filter", "notes": "", "children": [589], "parent": [587], "node_id": "(548) Filter", "lineno": 5425, "detail": {"note": "Filter", "lineno": 5461, "Input": " [2]: [ip_address#2172241, ip_trans_cnt#2197070L]", "Condition": " : (ip_trans_cnt#2197070L > 1500)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587"], "size": 16, "equiv": "0"}, "589": {"label": "HashAggregate", "notes": "", "children": [590], "parent": [588], "node_id": "(547) HashAggregate", "lineno": 5426, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210413L]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [finalmerge_count(merge count#2210413L) AS count(1)#2197087L]", "Aggregate": " Attributes [1]: [count(1)#2197087L]", "Results": " [2]: [ip_address#2172241, count(1)#2197087L AS ip_trans_cnt#2197070L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588"], "size": 15, "equiv": "0"}, "590": {"label": "Exchange", "notes": "", "children": [591], "parent": [589], "node_id": "(546) Exchange", "lineno": 5427, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, count#2210413L]", "Arguments:": " hashpartitioning(ip_address#2172241, 1000), ENSURE_REQUIREMENTS, [id=#1669356]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589"], "size": 14, "equiv": "0"}, "591": {"label": "HashAggregate", "notes": "", "children": [592], "parent": [590], "node_id": "(545) HashAggregate", "lineno": 5428, "detail": {"note": "HashAggregate", "lineno": 5461, "Input": " [1]: [ip_address#2172241]", "Keys": " [1]: [ip_address#2172241]", "Functions": " [1]: [partial_count(1) AS count#2210413L]", "Aggregate": " Attributes [1]: [count#2210412L]", "Results": " [2]: [ip_address#2172241, count#2210413L]"}, "full_label": "HashAggregate", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590"], "size": 13, "equiv": "0"}, "592": {"label": "Project", "notes": "", "children": [593], "parent": [591], "node_id": "(544) Project", "lineno": 5429, "detail": {"note": "Project", "lineno": 5461, "Output": " [1]: [ip_address#2172241]", "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2197073]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591"], "size": 12, "equiv": "0"}, "593": {"label": "Filter", "notes": "", "children": [594], "parent": [592], "node_id": "(543) Filter", "lineno": 5430, "detail": {"note": "Filter", "lineno": 5461, "Input": " [4]: [ip_address#2172241, long_ip#2172242L, exploded_ip#2174776L, ip_whitelist_flg#2197073]", "Condition": " : isnull(ip_whitelist_flg#2197073)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592"], "size": 11, "equiv": "0"}, "594": {"label": "SortMergeJoin LeftOuter", "notes": "", "children": [595, 599], "parent": [593], "node_id": "(542) SortMergeJoin", "lineno": 5431, "detail": {"note": "SortMergeJoin", "lineno": 5461, "Left": " keys [1]: [long_ip#2172242L]", "Right": " keys [1]: [exploded_ip#2174776L]", "Join": " condition: None"}, "full_label": "SortMergeJoin LeftOuter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592", "593"], "size": 10, "equiv": "0"}, "595": {"label": "Sort", "notes": "", "children": [596], "parent": [594], "node_id": "(536) Sort", "lineno": 5432, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [long_ip#2172242L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592", "593", "594"], "size": 4, "equiv": "0"}, "596": {"label": "Exchange", "notes": "", "children": [597], "parent": [595], "node_id": "(535) Exchange", "lineno": 5433, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " hashpartitioning(long_ip#2172242L, 1000), ENSURE_REQUIREMENTS, [id=#1669347]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592", "593", "594", "595"], "size": 3, "equiv": "0"}, "597": {"label": "InMemoryTableScan", "notes": "", "children": [598], "parent": [596], "node_id": "(534) InMemoryTableScan", "lineno": 5434, "detail": {"note": "InMemoryTableScan", "lineno": 5461, "Output": " [2]: [ip_address#2172241, long_ip#2172242L]", "Arguments:": " [ip_address#2172241, long_ip#2172242L]"}, "full_label": "InMemoryTableScan", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592", "593", "594", "595", "596"], "size": 2, "equiv": "3"}, "598": {"label": "InMemoryRelation", "notes": "", "children": [], "parent": [597], "node_id": "(535) InMemoryRelation", "lineno": 5435, "detail": {"note": "InMemoryRelation", "lineno": 5461, "Arguments:": " [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, timedelta#2172258L], CachedRDDBuilder(org.apache.spark.sql.execution.columnar.DefaultCachedBatchSerializer@4a0cee7,StorageLevel(disk, memory, deserialized, 1 replicas),*(3) Filter (isnotnull(transaction_date_time#2172247) AND (transaction_date_time#2172247 >= 1669756289000000))", "+-": " Window [ip_address#2172241, long_ip#2172242L, application_id#2172243, userAgent#2172171, userName#2172244, status#2172245, attsdk_flag#2172246, transaction_date_time#2172247, data_dt#2172101, (unix_timestamp(transaction_date_time#2172247, yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false) - unix_timestamp(lag(transaction_date_time#2172247, -1, null) windowspecdefinition(ip_address#2172241, transaction_date_time#2172247 ASC NULLS FIRST, specifiedwindowframe(RowFrame, -1, -1)), yyyy-MM-dd HH:mm:ss, Some(Etc/UTC), false)) AS timedelta#2172258L], [ip_address#2172241], [transaction_date_time#2172247 ASC NULLS FIRST]", "": "                        +- FileScan parquet [body_str#2172100,data_dt#2172101] Batched: true, DataFilters: [isnotnull(body_str#2172100), isnotnull(from_json(StructField(sourceIp,StringType,true), body_str..., Format: Parquet, Location: PreparedDeltaFileIndex[abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/haloc_st..., PartitionFilters: [isnotnull(data_dt#2172101), (data_dt#2172101 >= 2022112920)], PushedFilters: [IsNotNull(body_str)], ReadSchema: struct<body_str:string>", ",None": ")"}, "full_label": "InMemoryRelation", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592", "593", "594", "595", "596", "597"], "size": 1, "equiv": "0"}, "599": {"label": "Sort", "notes": "", "children": [600], "parent": [594], "node_id": "(541) Sort", "lineno": 5446, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2197073]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592", "593", "594"], "size": 5, "equiv": "4"}, "600": {"label": "Exchange", "notes": "", "children": [601], "parent": [599], "node_id": "(540) Exchange", "lineno": 5447, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2197073]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669348]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592", "593", "594", "599"], "size": 4, "equiv": "0"}, "601": {"label": "Project", "notes": "", "children": [602], "parent": [600], "node_id": "(539) Project", "lineno": 5448, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2197073]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592", "593", "594", "599", "600"], "size": 3, "equiv": "0"}, "602": {"label": "Filter", "notes": "", "children": [603], "parent": [601], "node_id": "(538) Filter", "lineno": 5449, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592", "593", "594", "599", "600", "601"], "size": 2, "equiv": "0"}, "603": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [602], "node_id": "(537) Scan", "lineno": 5450, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "580", "581", "582", "586", "587", "588", "589", "590", "591", "592", "593", "594", "599", "600", "601", "602"], "size": 1, "equiv": "0"}, "604": {"label": "Sort", "notes": "", "children": [605], "parent": [579], "node_id": "(558) Sort", "lineno": 5451, "detail": {"note": "Sort", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2197056]", "Arguments:": " [exploded_ip#2174776L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579"], "size": 5, "equiv": "4"}, "605": {"label": "Exchange", "notes": "", "children": [606], "parent": [604], "node_id": "(557) Exchange", "lineno": 5452, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [2]: [exploded_ip#2174776L, ip_whitelist_flg#2197056]", "Arguments:": " hashpartitioning(exploded_ip#2174776L, 1000), ENSURE_REQUIREMENTS, [id=#1669367]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "604"], "size": 4, "equiv": "0"}, "606": {"label": "Project", "notes": "", "children": [607], "parent": [605], "node_id": "(556) Project", "lineno": 5453, "detail": {"note": "Project", "lineno": 5461, "Output": " [2]: [exploded_ip#2174776L, 1 AS ip_whitelist_flg#2197056]", "Input": " [1]: [exploded_ip#2174776L]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "604", "605"], "size": 3, "equiv": "0"}, "607": {"label": "Filter", "notes": "", "children": [608], "parent": [606], "node_id": "(555) Filter", "lineno": 5454, "detail": {"note": "Filter", "lineno": 5461, "Input": " [1]: [exploded_ip#2174776L]", "Condition": " : isnotnull(exploded_ip#2174776L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "604", "605", "606"], "size": 2, "equiv": "0"}, "608": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [607], "node_id": "(554) Scan", "lineno": 5455, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [1]: [exploded_ip#2174776L]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/whitelist_blowup]", "PushedFilters:": " [IsNotNull(exploded_ip)]", "ReadSchema:": " struct<exploded_ip:bigint>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "4", "5", "6", "7", "8", "9", "535", "536", "573", "574", "575", "576", "577", "578", "579", "604", "605", "606", "607"], "size": 1, "equiv": "0"}, "609": {"label": "Sort", "notes": "", "children": [610], "parent": [3], "node_id": "(578) Sort", "lineno": 5456, "detail": {"note": "Sort", "lineno": 5461, "Input": " [78]: [ip_start_iploc#2174784, ip_end_iploc#2174785, country_name_iploc#2174786, region_iploc#2174787, city_iploc#2174788, latitude_iploc#2174789, longitude_iploc#2174790, zip_code_iploc#2174791, time_zone_iploc#2174792, ISP_or_company_name_iploc#2174793, domain_name_iploc#2174794, net_speed_iploc#2174795, idd_code_iploc#2174796, area_code_iploc#2174797, weather_station_code_iploc#2174798, weather_station_name_iploc#2174799, mobile_country_codes_iploc#2174800, mobile_network_code_iploc#2174801, mobile_brand_iploc#2174802, elevation_iploc#2174803, usage_type_iploc#2174804, exploded_ip_iploc#2174805L, dotted_num_ip_iploc#2174806, country_code_iploc#2174807, alpha3code#2174808, country_blk_list_iploc#2174809, source_inetnum#2174810, nic_inetnum#2174811, originas_inetnum#2174812, netname_inetnum#2174813, nethandle_inetnum#2174814, startip_inetnum#2174815, endip_inetnum#2174816, bits_inetnum#2174817, ipversion_inetnum#2174818, org_inetnum#2174819, holder_inetnum#2174820, maintainer_inetnum#2174821, admincontact_inetnum#2174822, techcontact_inetnum#2174823, abusecontact_inetnum#2174824, parent_inetnum#2174825, nameserver_inetnum#2174826, city_inetnum#2174827, country_code_inetnum#2174828, rdate_inetnum#2174829, adate_inetnum#2174830, status_inetnum#2174831, mntlower_inetnum#2174832, mntdomains_inetnum#2174833, mntroutes_inetnum#2174834, inetnumup_inetnum#2174835, rev_inetnum#2174836, remarks_inetnum#2174837, exploded_ip_inetnum#2174838L, dotted_num_ip_inetnum#2174839, country_name_inetnum#2174840, startip_ddos#2174841, bits_ddos#2174842, asn_ddos#2174843, country_code_ddos#2174844, holder_ddos#2174845, date_ddos#2174846, asName_ddos#2174847, asBlock_ddos#2174848, asBits_ddos#2174849, asnClass_ddos#2174850, source_ddos#2174851, ipbestguessclass_ddos#2174852, startip_dotnum_ddos#2174853, startblock_ip_ddos#2174854, endblock_ip_ddos#2174855, startip_num_ddos#2174856, startblock_num_ddos#2174857L, endblock_num_ddos#2174858L, exploded_ip_ddos#2174859L, country_name_ddos#2174860, att_ctry_blacklist_iploc_flg#2196486]", "Arguments:": " [exploded_ip_iploc#2174805L ASC NULLS FIRST], false, 0"}, "full_label": "Sort", "ancestors": ["1", "2", "3"], "size": 5, "equiv": "4"}, "610": {"label": "Exchange", "notes": "", "children": [611], "parent": [609], "node_id": "(577) Exchange", "lineno": 5457, "detail": {"note": "Exchange", "lineno": 5461, "Input": " [78]: [ip_start_iploc#2174784, ip_end_iploc#2174785, country_name_iploc#2174786, region_iploc#2174787, city_iploc#2174788, latitude_iploc#2174789, longitude_iploc#2174790, zip_code_iploc#2174791, time_zone_iploc#2174792, ISP_or_company_name_iploc#2174793, domain_name_iploc#2174794, net_speed_iploc#2174795, idd_code_iploc#2174796, area_code_iploc#2174797, weather_station_code_iploc#2174798, weather_station_name_iploc#2174799, mobile_country_codes_iploc#2174800, mobile_network_code_iploc#2174801, mobile_brand_iploc#2174802, elevation_iploc#2174803, usage_type_iploc#2174804, exploded_ip_iploc#2174805L, dotted_num_ip_iploc#2174806, country_code_iploc#2174807, alpha3code#2174808, country_blk_list_iploc#2174809, source_inetnum#2174810, nic_inetnum#2174811, originas_inetnum#2174812, netname_inetnum#2174813, nethandle_inetnum#2174814, startip_inetnum#2174815, endip_inetnum#2174816, bits_inetnum#2174817, ipversion_inetnum#2174818, org_inetnum#2174819, holder_inetnum#2174820, maintainer_inetnum#2174821, admincontact_inetnum#2174822, techcontact_inetnum#2174823, abusecontact_inetnum#2174824, parent_inetnum#2174825, nameserver_inetnum#2174826, city_inetnum#2174827, country_code_inetnum#2174828, rdate_inetnum#2174829, adate_inetnum#2174830, status_inetnum#2174831, mntlower_inetnum#2174832, mntdomains_inetnum#2174833, mntroutes_inetnum#2174834, inetnumup_inetnum#2174835, rev_inetnum#2174836, remarks_inetnum#2174837, exploded_ip_inetnum#2174838L, dotted_num_ip_inetnum#2174839, country_name_inetnum#2174840, startip_ddos#2174841, bits_ddos#2174842, asn_ddos#2174843, country_code_ddos#2174844, holder_ddos#2174845, date_ddos#2174846, asName_ddos#2174847, asBlock_ddos#2174848, asBits_ddos#2174849, asnClass_ddos#2174850, source_ddos#2174851, ipbestguessclass_ddos#2174852, startip_dotnum_ddos#2174853, startblock_ip_ddos#2174854, endblock_ip_ddos#2174855, startip_num_ddos#2174856, startblock_num_ddos#2174857L, endblock_num_ddos#2174858L, exploded_ip_ddos#2174859L, country_name_ddos#2174860, att_ctry_blacklist_iploc_flg#2196486]", "Arguments:": " hashpartitioning(exploded_ip_iploc#2174805L, 1000), ENSURE_REQUIREMENTS, [id=#1669389]"}, "full_label": "Exchange", "ancestors": ["1", "2", "3", "609"], "size": 4, "equiv": "0"}, "611": {"label": "Project", "notes": "", "children": [612], "parent": [610], "node_id": "(576) Project", "lineno": 5458, "detail": {"note": "Project", "lineno": 5461, "Output": " [78]: [ip_start_iploc#2174784, ip_end_iploc#2174785, country_name_iploc#2174786, region_iploc#2174787, city_iploc#2174788, latitude_iploc#2174789, longitude_iploc#2174790, zip_code_iploc#2174791, time_zone_iploc#2174792, ISP_or_company_name_iploc#2174793, domain_name_iploc#2174794, net_speed_iploc#2174795, idd_code_iploc#2174796, area_code_iploc#2174797, weather_station_code_iploc#2174798, weather_station_name_iploc#2174799, mobile_country_codes_iploc#2174800, mobile_network_code_iploc#2174801, mobile_brand_iploc#2174802, elevation_iploc#2174803, usage_type_iploc#2174804, exploded_ip_iploc#2174805L, dotted_num_ip_iploc#2174806, country_code_iploc#2174807, alpha3code#2174808, country_blk_list_iploc#2174809, source_inetnum#2174810, nic_inetnum#2174811, originas_inetnum#2174812, netname_inetnum#2174813, nethandle_inetnum#2174814, startip_inetnum#2174815, endip_inetnum#2174816, bits_inetnum#2174817, ipversion_inetnum#2174818, org_inetnum#2174819, holder_inetnum#2174820, maintainer_inetnum#2174821, admincontact_inetnum#2174822, techcontact_inetnum#2174823, abusecontact_inetnum#2174824, parent_inetnum#2174825, nameserver_inetnum#2174826, city_inetnum#2174827, country_code_inetnum#2174828, rdate_inetnum#2174829, adate_inetnum#2174830, status_inetnum#2174831, mntlower_inetnum#2174832, mntdomains_inetnum#2174833, mntroutes_inetnum#2174834, inetnumup_inetnum#2174835, rev_inetnum#2174836, remarks_inetnum#2174837, exploded_ip_inetnum#2174838L, dotted_num_ip_inetnum#2174839, country_name_inetnum#2174840, startip_ddos#2174841, bits_ddos#2174842, asn_ddos#2174843, country_code_ddos#2174844, holder_ddos#2174845, date_ddos#2174846, asName_ddos#2174847, asBlock_ddos#2174848, asBits_ddos#2174849, asnClass_ddos#2174850, source_ddos#2174851, ipbestguessclass_ddos#2174852, startip_dotnum_ddos#2174853, startblock_ip_ddos#2174854, endblock_ip_ddos#2174855, startip_num_ddos#2174856, startblock_num_ddos#2174857L, endblock_num_ddos#2174858L, exploded_ip_ddos#2174859L, country_name_ddos#2174860, cast(country_blk_list_iploc#2174809 as int) AS att_ctry_blacklist_iploc_flg#2196486]", "Input": " [77]: [ip_start_iploc#2174784, ip_end_iploc#2174785, country_name_iploc#2174786, region_iploc#2174787, city_iploc#2174788, latitude_iploc#2174789, longitude_iploc#2174790, zip_code_iploc#2174791, time_zone_iploc#2174792, ISP_or_company_name_iploc#2174793, domain_name_iploc#2174794, net_speed_iploc#2174795, idd_code_iploc#2174796, area_code_iploc#2174797, weather_station_code_iploc#2174798, weather_station_name_iploc#2174799, mobile_country_codes_iploc#2174800, mobile_network_code_iploc#2174801, mobile_brand_iploc#2174802, elevation_iploc#2174803, usage_type_iploc#2174804, exploded_ip_iploc#2174805L, dotted_num_ip_iploc#2174806, country_code_iploc#2174807, alpha3code#2174808, country_blk_list_iploc#2174809, source_inetnum#2174810, nic_inetnum#2174811, originas_inetnum#2174812, netname_inetnum#2174813, nethandle_inetnum#2174814, startip_inetnum#2174815, endip_inetnum#2174816, bits_inetnum#2174817, ipversion_inetnum#2174818, org_inetnum#2174819, holder_inetnum#2174820, maintainer_inetnum#2174821, admincontact_inetnum#2174822, techcontact_inetnum#2174823, abusecontact_inetnum#2174824, parent_inetnum#2174825, nameserver_inetnum#2174826, city_inetnum#2174827, country_code_inetnum#2174828, rdate_inetnum#2174829, adate_inetnum#2174830, status_inetnum#2174831, mntlower_inetnum#2174832, mntdomains_inetnum#2174833, mntroutes_inetnum#2174834, inetnumup_inetnum#2174835, rev_inetnum#2174836, remarks_inetnum#2174837, exploded_ip_inetnum#2174838L, dotted_num_ip_inetnum#2174839, country_name_inetnum#2174840, startip_ddos#2174841, bits_ddos#2174842, asn_ddos#2174843, country_code_ddos#2174844, holder_ddos#2174845, date_ddos#2174846, asName_ddos#2174847, asBlock_ddos#2174848, asBits_ddos#2174849, asnClass_ddos#2174850, source_ddos#2174851, ipbestguessclass_ddos#2174852, startip_dotnum_ddos#2174853, startblock_ip_ddos#2174854, endblock_ip_ddos#2174855, startip_num_ddos#2174856, startblock_num_ddos#2174857L, endblock_num_ddos#2174858L, exploded_ip_ddos#2174859L, country_name_ddos#2174860]"}, "full_label": "Project", "ancestors": ["1", "2", "3", "609", "610"], "size": 3, "equiv": "0"}, "612": {"label": "Filter", "notes": "", "children": [613], "parent": [611], "node_id": "(575) Filter", "lineno": 5459, "detail": {"note": "Filter", "lineno": 5461, "Input": " [77]: [ip_start_iploc#2174784, ip_end_iploc#2174785, country_name_iploc#2174786, region_iploc#2174787, city_iploc#2174788, latitude_iploc#2174789, longitude_iploc#2174790, zip_code_iploc#2174791, time_zone_iploc#2174792, ISP_or_company_name_iploc#2174793, domain_name_iploc#2174794, net_speed_iploc#2174795, idd_code_iploc#2174796, area_code_iploc#2174797, weather_station_code_iploc#2174798, weather_station_name_iploc#2174799, mobile_country_codes_iploc#2174800, mobile_network_code_iploc#2174801, mobile_brand_iploc#2174802, elevation_iploc#2174803, usage_type_iploc#2174804, exploded_ip_iploc#2174805L, dotted_num_ip_iploc#2174806, country_code_iploc#2174807, alpha3code#2174808, country_blk_list_iploc#2174809, source_inetnum#2174810, nic_inetnum#2174811, originas_inetnum#2174812, netname_inetnum#2174813, nethandle_inetnum#2174814, startip_inetnum#2174815, endip_inetnum#2174816, bits_inetnum#2174817, ipversion_inetnum#2174818, org_inetnum#2174819, holder_inetnum#2174820, maintainer_inetnum#2174821, admincontact_inetnum#2174822, techcontact_inetnum#2174823, abusecontact_inetnum#2174824, parent_inetnum#2174825, nameserver_inetnum#2174826, city_inetnum#2174827, country_code_inetnum#2174828, rdate_inetnum#2174829, adate_inetnum#2174830, status_inetnum#2174831, mntlower_inetnum#2174832, mntdomains_inetnum#2174833, mntroutes_inetnum#2174834, inetnumup_inetnum#2174835, rev_inetnum#2174836, remarks_inetnum#2174837, exploded_ip_inetnum#2174838L, dotted_num_ip_inetnum#2174839, country_name_inetnum#2174840, startip_ddos#2174841, bits_ddos#2174842, asn_ddos#2174843, country_code_ddos#2174844, holder_ddos#2174845, date_ddos#2174846, asName_ddos#2174847, asBlock_ddos#2174848, asBits_ddos#2174849, asnClass_ddos#2174850, source_ddos#2174851, ipbestguessclass_ddos#2174852, startip_dotnum_ddos#2174853, startblock_ip_ddos#2174854, endblock_ip_ddos#2174855, startip_num_ddos#2174856, startblock_num_ddos#2174857L, endblock_num_ddos#2174858L, exploded_ip_ddos#2174859L, country_name_ddos#2174860]", "Condition": " : isnotnull(exploded_ip_iploc#2174805L)"}, "full_label": "Filter", "ancestors": ["1", "2", "3", "609", "610", "611"], "size": 2, "equiv": "0"}, "613": {"label": "Scan parquet ", "notes": "", "children": [], "parent": [612], "node_id": "(574) Scan", "lineno": 5460, "detail": {"note": "Scan parquet", "lineno": 5461, "Output": " [77]: [ip_start_iploc#2174784, ip_end_iploc#2174785, country_name_iploc#2174786, region_iploc#2174787, city_iploc#2174788, latitude_iploc#2174789, longitude_iploc#2174790, zip_code_iploc#2174791, time_zone_iploc#2174792, ISP_or_company_name_iploc#2174793, domain_name_iploc#2174794, net_speed_iploc#2174795, idd_code_iploc#2174796, area_code_iploc#2174797, weather_station_code_iploc#2174798, weather_station_name_iploc#2174799, mobile_country_codes_iploc#2174800, mobile_network_code_iploc#2174801, mobile_brand_iploc#2174802, elevation_iploc#2174803, usage_type_iploc#2174804, exploded_ip_iploc#2174805L, dotted_num_ip_iploc#2174806, country_code_iploc#2174807, alpha3code#2174808, country_blk_list_iploc#2174809, source_inetnum#2174810, nic_inetnum#2174811, originas_inetnum#2174812, netname_inetnum#2174813, nethandle_inetnum#2174814, startip_inetnum#2174815, endip_inetnum#2174816, bits_inetnum#2174817, ipversion_inetnum#2174818, org_inetnum#2174819, holder_inetnum#2174820, maintainer_inetnum#2174821, admincontact_inetnum#2174822, techcontact_inetnum#2174823, abusecontact_inetnum#2174824, parent_inetnum#2174825, nameserver_inetnum#2174826, city_inetnum#2174827, country_code_inetnum#2174828, rdate_inetnum#2174829, adate_inetnum#2174830, status_inetnum#2174831, mntlower_inetnum#2174832, mntdomains_inetnum#2174833, mntroutes_inetnum#2174834, inetnumup_inetnum#2174835, rev_inetnum#2174836, remarks_inetnum#2174837, exploded_ip_inetnum#2174838L, dotted_num_ip_inetnum#2174839, country_name_inetnum#2174840, startip_ddos#2174841, bits_ddos#2174842, asn_ddos#2174843, country_code_ddos#2174844, holder_ddos#2174845, date_ddos#2174846, asName_ddos#2174847, asBlock_ddos#2174848, asBits_ddos#2174849, asnClass_ddos#2174850, source_ddos#2174851, ipbestguessclass_ddos#2174852, startip_dotnum_ddos#2174853, startblock_ip_ddos#2174854, endblock_ip_ddos#2174855, startip_num_ddos#2174856, startblock_num_ddos#2174857L, endblock_num_ddos#2174858L, exploded_ip_ddos#2174859L, country_name_ddos#2174860]", "Batched:": " true", "Location:": " InMemoryFileIndex [abfss://jailer-gen2-dev@jd1yn19kmtz58fes6xgb.dfs.core.windows.net/initial_data/fathom/iploc_inetnum_ddos/file_date=20221012]", "PushedFilters:": " [IsNotNull(exploded_ip_iploc)]", "ReadSchema:": " struct<ip_start_iploc:string,ip_end_iploc:string,country_name_iploc:string,region_iploc:string,city_iploc:string,latitude_iploc:string,longitude_iploc:string,zip_code_iploc:string,time_zone_iploc:string,ISP_or_company_name_iploc:string,domain_name_iploc:string,net_speed_iploc:string,idd_code_iploc:string,area_code_iploc:string,weather_station_code_iploc:string,weather_station_name_iploc:string,mobile_country_codes_iploc:string,mobile_network_code_iploc:string,mobile_brand_iploc:string,elevation_iploc:string,usage_type_iploc:string,exploded_ip_iploc:bigint,dotted_num_ip_iploc:string,country_code_iploc:string,alpha3code:string,country_blk_list_iploc:string,source_inetnum:string,nic_inetnum:string,originas_inetnum:string,netname_inetnum:string,nethandle_inetnum:string,startip_inetnum:string,endip_inetnum:string,bits_inetnum:string,ipversion_inetnum:string,org_inetnum:string,holder_inetnum:string,maintainer_inetnum:string,admincontact_inetnum:string,techcontact_inetnum:string,abusecontact_inetnum:string,parent_inetnum:string,nameserver_inetnum:string,city_inetnum:string,country_code_inetnum:string,rdate_inetnum:string,adate_inetnum:string,status_inetnum:string,mntlower_inetnum:string,mntdomains_inetnum:string,mntroutes_inetnum:string,inetnumup_inetnum:string,rev_inetnum:string,remarks_inetnum:string,exploded_ip_inetnum:bigint,dotted_num_ip_inetnum:string,country_name_inetnum:string,startip_ddos:string,bits_ddos:string,asn_ddos:string,country_code_ddos:string,holder_ddos:string,date_ddos:string,asName_ddos:string,asBlock_ddos:string,asBits_ddos:string,asnClass_ddos:string,source_ddos:string,ipbestguessclass_ddos:string,startip_dotnum_ddos:string,startblock_ip_ddos:string,endblock_ip_ddos:string,startip_num_ddos:string,startblock_num_ddos:bigint,endblock_num_ddos:bigint,exploded_ip_ddos:bigint,country_name_ddos:string>"}, "full_label": "Scan parquet ", "ancestors": ["1", "2", "3", "609", "610", "611", "612"], "size": 1, "equiv": "0"}}}