/*!
 *  dc.graph 0.4.1
 *  http://dc-js.github.io/dc.graph.js/
 *  Copyright 2015-2016 AT&T Intellectual Property & the dc.graph.js Developers
 *  https://github.com/dc-js/dc.graph.js/blob/master/AUTHORS
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 *
 */

!function(){function a(a,b,c){"use strict";function d(a){return a.orig}function e(a){return a}function f(a,b){var c=K(b),d=function(){return arguments.length?(console.warn(a),c.apply(K,arguments),this):c()};return["cascade","_eval","eval","react"].forEach(function(a){d[a]=c[a]}),d}function g(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})}function h(a,b,c){function d(a,b){return function(c,d){return a(c)?b(c):d()}}var e={};for(var f in c)/^node/.test(f)?a&&(e[f]=d(a,j(c[f]))):/^edge/.test(f)?b&&(e[f]=d(b,j(c[f]))):console.error('only know how to deal with properties that start with "node" or "edge"');return e}function i(a,b){return function(){return a(b.apply(null,arguments))}}function j(a){return J.functor_wrap(a,d)}function k(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function l(a,b,c){for(var d=["M",a[0].x,",",a[0].y],e=b,f=!1,g=1;g<a.length;++g)(isNaN(a[g].x)||isNaN(a[g].y))&&(f=!0),d.push(e===b?L[b]:" ",a[g].x,",",a[g].y),0===--e&&(e=b);return e!=b&&console.log("warning: pts.length didn't match bezian degree",a,b),c&&d.push("Z"),d.join("")}function m(a,b,c,d,e,f){function g(b){var f=c(b);a[f]||e(f,a[f]={},b);var g=a[f];return d(g,b),h[f]=!0,g}e||(e=function(a,b){}),f||(f=function(a){});var h={},i=b.map(g);for(var j in a)h[j]||(f(j,a[j]),delete a[j]);return i}function n(a,b,c,d){var e=Math.tan(Math.atan2(d,c));e*=e;var f={x:a*b/Math.sqrt(b*b+a*a*e),y:a*b/Math.sqrt(a*a+b*b/e)};return c<0&&(f.x=-f.x),d<0&&(f.y=-f.y),f}function o(a,b,c){return a-N<=b&&b<=c+N}function p(a,b,c,d,e,f,g,h){var i=((a*d-b*c)*(e-g)-(a-c)*(e*h-f*g))/((a-c)*(f-h)-(b-d)*(e-g)),j=((a*d-b*c)*(f-h)-(b-d)*(e*h-f*g))/((a-c)*(f-h)-(b-d)*(e-g));if(isNaN(i)||isNaN(j))return!1;if(a>=c){if(!o(c,i,a))return!1}else if(!o(a,i,c))return!1;if(b>=d){if(!o(d,j,b))return!1}else if(!o(b,j,d))return!1;if(e>=g){if(!o(g,i,e))return!1}else if(!o(e,i,g))return!1;if(f>=h){if(!o(h,j,f))return!1}else if(!o(f,j,h))return!1;return{x:i,y:j}}function q(a,b,c,d,e){for(var f=0;f<a.length;++f){var g=f===a.length-1?0:f+1,h=p(a[f].x,a[f].y,a[g].x,a[g].y,b,c,d,e);if(h)return h}return null}function r(a,b,c,d){switch(b.dcg_shape.shape){case"ellipse":return n(b.dcg_rx,b.dcg_ry,c,d);case"polygon":return q(b.dcg_points,0,0,c,d)}}function s(a){var b=a.shape;if("random"===a.shape){var c=Object.keys(O);b=a._shape=c[Math.floor(Math.random()*c.length)]}return(O[b]||function(){throw new Error("unknown shape "+a.shape)})(a)}function t(a){return function(b){var c=a.nodeShape.eval(b)||P;b.dcg_shape=s(c),b.dcg_shape.abstract=c}}function u(a){return function(b){var c=a.nodeShape.eval(b)||P,d=b.dcg_shape.abstract;return c.shape!==d.shape||"polygon"===c.shape&&(c.shape.sides!==d.sides||c.shape.skew!==d.skew||c.shape.distortion!==d.distortion||c.shape.rotation!==d.rotation)}}function v(a){return function(a){var b,c=a.dcg_shape.shape;switch(c){case"ellipse":b="ellipse";break;case"polygon":b="path";break;default:throw new Error("unknown shape "+c)}return document.createElementNS("http://www.w3.org/2000/svg",b)}}function w(a){return function(b){var c,d=a.nodeRadius.eval(b);a.nodeFitLabel.eval(b)&&(c=this.getBBox());var e=0;if(c&&c.width&&c.height){d=Math.max(d,c.height/2+5);var f;if("ellipse"===b.dcg_shape.shape){var g=c.height/2/d;f=c.width/2/Math.sqrt(1-g*g),b.dcg_rx=Math.max(f,d),b.dcg_ry=d}else f=c.width/2,b.dcg_rx=f*Math.sqrt(2)/Math.cos(Math.PI/(b.dcg_shape.sides||4)),b.dcg_ry=d;e=2*f+a.nodePadding.eval(b)+a.nodeStrokeWidth.eval(b)}else b.dcg_rx=b.dcg_ry=d;var h=2*d+a.nodePadding.eval(b)+a.nodeStrokeWidth.eval(b);b.cola.width=Math.max(e,h),b.cola.height=h}}function x(a,b){return{rx:function(a){return a.dcg_rx},ry:function(a){return a.dcg_ry}}}function y(b,c){return{d:function(b){var c=b.dcg_shape,d=c.sides||4,e=c.skew||0,f=c.distortion||0,g=c.rotation||0,h=d%2?0:.5,i=[];g=g/360+.25;for(var j=0;j<d;++j){var k=-((j+h)/d+g)*Math.PI*2;i.push({x:Math.cos(k),y:Math.sin(k)})}var m=a.extent(i,function(a){return a.y}),n=b.dcg_rx,o=b.dcg_ry/Math.min(-m[0],m[1]);return b.dcg_points=i.map(function(a){var c=n*a.x,d=o*a.y;return c*=1+f*((b.dcg_ry-d)/b.dcg_ry-1),c-=e*d/2,{x:c,y:d}}),l(b.dcg_points,1,!0)}}}function z(b){return function(c){var d=a.select(this);switch(c.dcg_shape.shape){case"ellipse":d.attr(x(b,c));break;case"polygon":d.attr(y(b,c));break;default:throw new Error("unknown shape "+c.dcg_shape.shape)}}}function A(a,b,c){var d=100;if(a(b).val>=0)throw new Error("f(a) must be less than 0");if(a(c).val<=0)throw new Error("f(b) must be greater than 0");for(;;){if(!--d)throw new Error("patience ran out");var e=(b+c)/2,f=a(e),g=f.val;if(Math.abs(g)<.5)return f;g>0?c=e:b=e}}function B(a,b,c,d,e,f,g,h,i,j,k,l){var m,n,o,p,q,s;if(h){var t,u,v=function(b,c){return r(a,b,1e3*Math.cos(c),1e3*Math.sin(c))},w=function(a,b,c){return function(d){var e=v(a,d);return e?{port:e,val:Math.hypot(e.x-b.x,e.y-b.y)-c,ang:d}:{port:{x:0,y:0},val:0,ang:d}}},x=Math.atan2(h.sourcePort.y,h.sourcePort.x),y=Math.atan2(h.targetPort.y,h.targetPort.x);try{t=A(w(b,h.sourcePort,j),x,x+2*i*j/k)}catch(a){t={ang:x,port:h.sourcePort}}try{u=A(w(c,h.targetPort,j),y,y-2*i*j/k)}catch(a){u={ang:y,port:h.targetPort}}o=t.port,p=u.port;var z=Math.hypot(o.x,o.y),B=Math.hypot(p.x,p.y),C=z+k/2,D=B+l/2,E=d+C*Math.cos(t.ang),F=e+C*Math.sin(t.ang),G=f+D*Math.cos(u.ang),H=g+D*Math.sin(u.ang);q=[{x:d+o.x,y:e+o.y},{x:E,y:F},{x:G,y:H},{x:f+p.x,y:g+p.y}],s=3}else m=f-d,n=g-e,o=r(a,b,m,n),p=r(a,c,-m,-n),o||(o={x:0,y:0}),p||(p={x:0,y:0}),q=[{x:d+o.x,y:e+o.y},{x:f+p.x,y:g+p.y}],s=1;return{sourcePort:o,targetPort:p,points:q,bezDegree:s}}function C(a,b){for(var c=[],d=1;d<a.length;d++){var e=a[d-1],f=a[d];c.push({x:e.x+(f.x-e.x)*b,y:e.y+(f.y-e.y)*b})}return c}function D(a,b){for(var c=[a],d=1;d<a.length;d++)c.push(C(c[c.length-1],b));return c}function E(a,b){var c=D(a,b);return c[c.length-1][0]}function F(a){if(!Q[a]){var b=Q[a]={worker:new Worker(M()+"dc.graph."+a+".worker.js"),layouts:{}};b.worker.onmessage=function(a){var c=a.data.layoutId;if(!b.layouts[c])throw new Error('layoutId "'+c+'" unknown!');b.layouts[c].dispatch()[a.data.response].apply(null,a.data.args)}}return Q[a]}function G(a){var b=function(){return{type:"alignment",axis:a}};return b.listname="offsets",b.wrap=function(a){return{node:a,offset:0}},b}function H(a,b,c){function d(){c.accept&&c.accept(g.innerText),g.onblur=null,f.remove()}function e(){c.cancel&&c.cancel(),g.onblur=null,f.remove()}var f=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),g=document.createElement("div"),h=c.text||"type on me",i=document.createTextNode(h);g.appendChild(i),g.setAttribute("contentEditable","true"),g.setAttribute("width","auto"),g.setAttribute("style","display: inline-block; background-color: white; padding: 2px"),f.setAttribute("width","100%"),f.setAttribute("height","100%"),f.setAttribute("style","text-align: left"),f.setAttributeNS(null,"transform","translate("+b.x+" "+b.y+")"),a.appendChild(f),f.appendChild(g),g.onkeydown=function(a){13===a.keyCode&&a.preventDefault()},g.onkeyup=function(a){13===a.keyCode?d():27===a.keyCode&&e()},g.onblur=e,g.focus();var j=document.createRange();c.selectText?j.selectNodeContents(g):(j.setStart(g,h.length),j.setEnd(g,h.length));var k=window.getSelection();k.removeAllRanges(),k.addRange(j)}function I(a){return(a.nodes||a.vertices)&&(a.edges||a.links)}var J={version:"0.4.1",constants:{CHART_CLASS:"dc-graph"}},K=function(a,b){void 0===b?b=d:b===!1&&(b=e);var c=a,f=null,g=[],h=function(a){return arguments.length?(f&&f(a),c=a,this):c};return h.cascade=function(a,b){for(var c=0;c<g.length;++c){if(g[c].n===a)return b?g[c].f=b:delete g[c],h;if(g[c].n>a)return g.splice(c,0,{n:a,f:b}),h}return g.push({n:a,f:b}),h},h._eval=function(a,c){if(0!==c&&g.length){var d=g[c-1];return d.f(a,function(){return h._eval(a,c-1)})}return J.functor_wrap(h(),b)(a)},h.eval=function(a){return h._eval(a,g.length)},h.react=function(a){return arguments.length?(f=a,this):f},h};J.functor_wrap=function(a,b){return"function"==typeof a?b?function(c){return a(b(c))}:a:function(){return a}};var L={1:"L",2:"Q",3:"C"};Math.hypot=Math.hypot||function(){for(var a=0,b=arguments.length,c=0;c<b;c++){if(arguments[c]===1/0||arguments[c]===-(1/0))return 1/0;a+=arguments[c]*arguments[c]}return Math.sqrt(a)};var M=function(){var a;return function(){if(void 0===a){a=null;var b="dc.graph.js",c=document.getElementsByTagName("script");if(c&&c.length>0)for(var d in c)if(c[d].src&&c[d].src.match(new RegExp(b+"$"))){a=c[d].src.replace(new RegExp("(.*)"+b+"$"),"$1");break}}return a}}();J.depth_first_traversal=function(a){return function(b,c){function d(b,c){var e=a.nodeid(b);return j[e]?void(a.skip&&a.skip(b,f[e])):(i[c]||(i[c]=[]),a.place&&a.place(b,c,i[c]),i[c].push(b),j[e]=!0,g[e]&&g[e].forEach(function(b,f){var i=h[a.targetid(b)];f&&a.sib&&a.sib(!1,h[a.targetid(g[e][f-1])],i),a.push&&a.push(),d(i,c+1)}),void(a.pop&&a.pop(b)))}a.init&&a.init(),a.tree&&(c=c.filter(function(b){return a.tree(b)}));var e,f={},g=c.reduce(function(b,c){var d=a.sourceid(c),e=a.targetid(c);return b[d]||(b[d]=[]),b[d].push(c),f[e]=(f[e]||0)+1,b},{}),h=b.reduce(function(b,c){var d=a.nodeid(c);return b[d]=c,b},{}),i=[],j={};a.root?e=b.filter(function(b){return a.root(b)}):(e=b.filter(function(b){return!f[a.nodeid(b)]}),b.length&&!e.length&&(e=[b[0]])),e.forEach(function(b,c){c&&a.sib&&a.sib(!0,e[c-1],b),a.push&&a.push(),d(b,a.row&&a.row(b)||0)}),a.finish(i)}};var N=1e-7,O={ellipse:function(){return{shape:"ellipse"}},egg:function(){return{shape:"polygon",sides:100,distortion:-.25}},triangle:function(){return{shape:"polygon",sides:3}},rectangle:function(){return{shape:"polygon",sides:4}},diamond:function(){return{shape:"polygon",sides:4,rotation:45}},trapezium:function(){return{shape:"polygon",sides:4,distortion:-.5}},parallelogram:function(){return{shape:"polygon",sides:4,skew:.5}},pentagon:function(){return{shape:"polygon",sides:5}},hexagon:function(){return{shape:"polygon",sides:6}},septagon:function(){return{shape:"polygon",sides:7}},octagon:function(){return{shape:"polygon",sides:8}},invtriangle:function(){return{shape:"polygon",sides:3,rotation:180}},invtrapezium:function(){return{shape:"polygon",sides:4,distortion:.5}},square:function(){return{shape:"polygon",sides:4}},polygon:function(a){return{shape:"polygon",sides:a.sides,skew:a.skew,distortion:a.distortion,rotation:a.rotation}}};J.available_shapes=function(){var a=Object.keys(O);return a.slice(0,a.length-1)};var P={shape:"ellipse"};J.diagram=function(g,h){function k(a){return function(b){ba.layoutEngine()||ba.layoutAlgorithm("cola",!0),console.warn('Warning: dc_graph.diagram."'+a+'"is deprecated. Call the corresponding method on the layout engine instead.');var c=ba.layoutEngine();return c.getEngine&&(c=c.getEngine()),c[a](b),this}}function n(){ba.layoutEngine()||ba.layoutAlgorithm("cola",!0),ba.layoutEngine().init({width:ba.width(),height:ba.height()})}function o(a){return!!a.source&&!!a.target}function p(){return"none"!==ba.stageTransitions()?ba.transitionDuration()/2:ba.transitionDuration()}function q(a){return"none"===ba.stageTransitions()||"modins"===ba.stageTransitions()==!a?0:ba.transitionDuration()/2}function r(b,c){c.attr("stroke",ba.edgeStroke.eval).attr("stroke-width",ba.edgeStrokeWidth.eval).attr("marker-end",function(a){var b=ba.edgeArrowhead.eval(a),c=R(a,"head",b);return c?"url(#"+c+")":null}).attr("marker-start",function(a){var b=ba.edgeArrowtail.eval(a),c=R(a,"tail",b);return b?"url(#"+c+")":null}).each(function(b){a.selectAll("#"+ba.arrowId(b,"head")+",#"+ba.arrowId(b,"tail")).attr("fill",ba.edgeStroke.eval(b))}),ba._updateNode(b)}function s(a){ma.end(a),sa=!1,va&&(va=!1,window.setTimeout(function(){ba.isRunning()||ba.redraw()},0))}function x(a,b,c,d,e,f){if(!a.ports[b]){var g=a.source.dcg_ry+ba.nodeStrokeWidth.eval(a.source)/2,h=a.target.dcg_ry+ba.nodeStrokeWidth.eval(a.target)/2;a.ports[b]=new Array(a.ports.n);for(var i=a.ports.rev[a.parallel],j=0;j<a.ports.n;++j){var k=!!(j%2)==c<e?-1:1,l=Math.floor((j+1)/2),m=l?a.ports[b][j>2?j-2:0].path:null,n=B(ba,a.source,a.target,c,d,e,f,m,k,ba.parallelEdgeOffset(),g,h);a.ports.rev[j]!==i&&n.points.reverse();var o=(n.points[0],n.points[n.points.length-1]),p=E(n.points,.75);a.ports[b][j]={path:n,orient:Math.atan2(o.y-p.y,o.x-p.x)+"rad"}}}return a.ports[b][a.parallel].path}function y(a){x(a,"old",a.source.prevX||a.source.cola.x,a.source.prevY||a.source.cola.y,a.target.prevX||a.target.cola.x,a.target.prevY||a.target.cola.y)}function A(a){var b=x(a,"new",a.source.cola.x,a.source.cola.y,a.target.cola.x,a.target.cola.y),c=b.points[0],d=b.points[b.points.length-1];a.length=Math.hypot(d.x-c.x,d.y-c.y)}function C(a){return function(b){var c=b.ports[a][b.parallel].path;return l(c.points,c.bezDegree)}}function D(a){return function(b){var c=b.ports[a][b.parallel].path,d=b.target.cola.x<b.source.cola.x?c.points.slice(0).reverse():c.points;return l(d,c.bezDegree)}}function F(a,b){a.every(function(a){return 0===a.size()})&&b();var c=0;a.forEach(function(a){a.each(function(){++c}).each("end.all",function(){--c||b()})})}function G(a){return{left:a.cola.x-a.dcg_rx,top:a.cola.y-a.dcg_ry,right:a.cola.x+a.dcg_rx,bottom:a.cola.y+a.dcg_ry}}function H(a,b){return{left:Math.min(a.left,b.left),top:Math.min(a.top,b.top),right:Math.max(a.right,b.right),bottom:Math.max(a.bottom,b.bottom)}}function I(a){return{left:a.x,top:a.y,right:a.x,bottom:a.y}}function L(a){var b=a.ports.new[a.parallel].path.points;return b.map(I).reduce(H)}function M(a){var b=ja.selectAll("rect.bounds").data([0]);b.enter().insert("rect",":first-child").attr({class:"bounds",fill:"rgba(128,255,128,0.1)",stroke:"#000"}),b.attr({x:a.left,y:a.top,width:a.right-a.left,height:a.bottom-a.top})}function N(a,b){(ba.fitStrategy()||ba.restrictPan())&&a.size()&&(wa=a.data().map(G).reduce(H),wa=b.data().map(L).reduce(H,wa))}function O(){if(ba.fitStrategy()){if(!wa)return;var a,b=wa.right-wa.left,c=wa.bottom-wa.top,d=ba.width(),e=ba.height();ba.DEBUG_BOUNDS&&M(wa);var f,g,h=ba.fitStrategy(),i=[0,0],j=1;if(["default","vertical","horizontal"].indexOf(h)>=0){var k=e/d,l=c/b,m=l<k;"default"===h?(g=!m,f=null):(g="vertical"===h,f="xMidYMid "+(m^g?"meet":"slice")),i=[ba.margins().left,ba.margins().top],j=g?(e-ba.margins().top-ba.margins().bottom)/e:(d-ba.margins().left-ba.margins().right)/d}else if("string"==typeof h&&h.match(/^align_/)){var n=h.split("_")[1].toLowerCase().split("");if(n.length>2)throw new Error("align_ expecting 0-2 sides, not "+n.length);var o=T();i=ea.translate(),j=ea.scale(),n.forEach(function(a){switch(a){case"l":i[0]=U(i,o.left);break;case"t":i[1]=V(i,o.top);break;case"r":i[0]=W(i,o.right);break;case"b":i[1]=X(i,o.bottom);break;default:throw new Error("align_ expecting l t r or b, not '"+a+"'")}})}else if("function"==typeof h){var p=h(b,c,d,e);f=p.pAR,i=p.translate,j=p.scale,a=p.viewBox}else{if("string"!=typeof h)throw new Error("unknown fitStrategy type "+typeof h);f=ba.fitStrategy()}void 0!==f&&(a||(a=[wa.left,wa.top,b,c].join(" ")),ha.attr({viewBox:a,preserveAspectRatio:f})),ea.translate(i).scale(j).event(ha),ma.zoomed(i,j)}}function Q(b,c,d,e,f,g,h,i,j,k){console.assert(d.data().every(o));var l={};c.each(function(a){l[ba.nodeKey.eval(a)]=!0}).attr("transform",function(a){return"translate("+a.cola.x+","+a.cola.y+")"});var m=b.transition().duration(p()).delay(function(a){return q(l[ba.nodeKey.eval(a)])}).attr("opacity",ba.nodeOpacity.eval).attr("transform",function(a){return"translate("+a.cola.x+","+a.cola.y+")"}).each("end.record",function(a){a.prevX=a.cola.x,a.prevY=a.cola.y});d.each(function(a){a.ports.new=null,a.ports.old=null});var n={};e.each(function(a){n[ba.edgeKey.eval(a)]=!0}).each(function(b){var c;"modins"===ba.stageTransitions()?(A(b),c="new"):(y(b),c="old"),ba.edgeArrowhead.eval(b)&&a.select("#"+ba.arrowId(b,"head")).attr("orient",function(){return b.ports[c][b.parallel].orient})}).attr("d",C("modins"===ba.stageTransitions()?"new":"old"));var r=d.each(A).each(function(b){ba.edgeArrowhead.eval(b)&&a.select("#"+ba.arrowId(b,"head")).transition().duration(p()).delay(q(!1)).attr("orient",function(){return b.ports.new[b.parallel].orient})}).transition().duration(p()).delay(function(a){return q(n[ba.edgeKey.eval(a)])}).attr("opacity",ba.edgeOpacity.eval).attr("d",function(a){var b="insmod"===ba.stageTransitions()&&n[ba.edgeKey.eval(a)]?"old":"new";return C(b)(a)});k.attr("d",D("modins"===ba.stageTransitions()?"new":"old"));var t=j.transition().duration(p()).delay(function(a){return q(n[ba.edgeKey.eval(a)])}).attr("opacity",ba.edgeOpacity.eval).attr("d",function(a){var b="insmod"===ba.stageTransitions()&&n[ba.edgeKey.eval(a)]?"old":"new";return D(b)(a)});"insmod"===ba.stageTransitions()&&(p()>=50?(r=r.transition().duration(p()).attr("d",C("new")),t=t.transition().duration(p()).attr("d",D("new"))):(r.attr("d",C("new")),t.attr("d",C("new")))),ba.showLayoutSteps()||F([m,r,t],function(){s(!0)}),f.attr("d",C("new"))}function R(a,b,c){var d=ba.arrowId(a,b),e=ba.addOrRemoveDef(d,!!c,"svg:marker");return c&&e.attr("viewBox","0 -5 10 10").attr("refX",ra[c].refX).attr("refY",ra[c].refY).attr("markerUnits","userSpaceOnUse").attr("markerWidth",ra[c].width*ba.edgeArrowSize.eval(a)).attr("markerHeight",ra[c].height*ba.edgeArrowSize.eval(a)).attr("stroke",ba.edgeStroke.eval(a)).attr("fill",ba.edgeStroke.eval(a)).call(ra[c].drawFunction),c?d:null}function S(a,b){ta=a,ua=b,ja.attr("transform","translate("+a+") scale("+b+")")}function T(){return{left:wa.left-ba.margins().left,top:wa.top-ba.margins().top,right:wa.right+ba.margins().right,bottom:wa.bottom+ba.margins().bottom}}function U(a,b){return a[0]-ba.x()(b)+ba.x().range()[0]}function V(a,b){return a[1]-ba.y()(b)+ba.y().range()[0]}function W(a,b){return a[0]-ba.x()(b)+ba.x().range()[1]}function X(a,b){return a[1]-ba.y()(b)+ba.y().range()[1]}function Y(){var b=a.event.translate;if(ba.restrictPan()){var c,d=ba.x().domain(),e=ba.y().domain(),f=T(),g=f.left<d[0],h=f.right<d[1],i=f.right-f.left<d[1]-d[0],j=0;switch(g&&h?c=i?"left":"right":g||h||(c=i?"right":"left"),c){case"left":b[0]=U(b,f.left);break;case"right":b[0]=W(b,f.right);break;default:++j}switch(g=f.top<e[0],h=f.bottom<e[1],i=f.bottom-f.top<e[1]-e[0],g&&h?c=i?"top":"bottom":g||h||(c=i?"bottom":"top"),c){case"top":b[1]=V(b,f.top);break;case"bottom":b[1]=X(b,f.bottom);break;default:++j}j<2&&ea.translate(b)}S(b,a.event.scale)}function Z(a,b){ha&&ha.attr("width",a||ba.width()).attr("height",b||ba.height())}function $(){ha.call(ea),ha.on("dblclick.zoom",null)}function _(){ha.on(".zoom",null)}function aa(){return ha=ba.root().append("svg"),Z(),ia=ha.append("svg:defs"),ba.x()||ba.x(a.scale.linear().domain([0,ba.width()]).range([0,ba.width()])),ba.y()||ba.y(a.scale.linear().domain([0,ba.height()]).range([0,ba.height()])),ea=a.behavior.zoom().on("zoom",Y).x(ba.x()).y(ba.y()),ba.mouseZoomable()&&(ba.altKeyZoom()?a.select(document).on("keydown",function(){"Alt"===a.event.key&&$()}).on("keyup",function(){"Alt"===a.event.key&&_()}):$()),ha}var ba=c.marginMixin({});ba.__dcFlag__=c.utils.uniqueId();var ca,da,ea,fa,ga,ha=null,ia=null,ja=null,ka=null,la=null,ma=a.dispatch("end","start","drawn","zoomed"),na={},oa={},pa={},qa={},ra={},sa=!1,ta=[0,0],ua=1;ba.width=K(200).react(function(a){Z(a,0)}),ba.height=K(200).react(function(a){Z(0,a)}),ba.root=K(null).react(function(a){a.empty()&&console.log("Warning: parent selector "+g+" doesn't seem to exist")}),ba.mouseZoomable=K(!0),ba.altKeyZoom=K(!1),ba.fitStrategy=K("default"),ba.restrictPan=K(!1),ba.autoZoom=K(null),ba.zoomToFit=function(){if(ka&&la){var a=ka.selectAll(".node"),b=la.selectAll(".edge");O(a,b)}},ba.nodeDimension=K(),ba.nodeGroup=K(),ba.edgeDimension=K(),ba.edgeGroup=K(),ba.nodeKey=ba.nodeKeyAccessor=K(function(a){return a.key}),ba.edgeKey=ba.edgeKeyAccessor=K(function(a){return a.key}),ba.edgeSource=ba.sourceAccessor=K(function(a){return a.value.sourcename}),ba.edgeTarget=ba.targetAccessor=K(function(a){return a.value.targetname}),ba.nodeRadius=ba.nodeRadiusAccessor=K(25),ba.nodeStrokeWidth=ba.nodeStrokeWidthAccessor=K(1),ba.nodeStroke=ba.nodeStrokeAccessor=K("black"),ba.nodeFillScale=K(null),ba.nodeFill=ba.nodeFillAccessor=K("white"),ba.nodeOpacity=K(1),ba.nodePadding=K(6),ba.nodeLabel=ba.nodeLabelAccessor=K(function(a){return a.value.label||a.value.name}),ba.nodeLabelFill=ba.nodeLabelFillAccessor=K(null),ba.nodeFitLabel=ba.nodeFitLabelAccessor=K(!0),ba.nodeShape=K(P),ba.nodeTitle=ba.nodeTitleAccessor=K(function(a){return ba.nodeKeyAccessor()(a)}),ba.nodeOrdering=K(null),ba.nodeFixed=ba.nodeFixedAccessor=K(null),ba.edgeStroke=ba.edgeStrokeAccessor=K("black"),ba.edgeStrokeWidth=ba.edgeStrokeWidthAccessor=K(1),ba.edgeOpacity=ba.edgeOpacityAccessor=K(1),ba.edgeLabel=ba.edgeLabelAccessor=K(function(a){return ba.edgeKey()(a)}),ba.edgeArrowhead=ba.edgeArrowheadAccessor=K("vee"),ba.edgeArrowtail=ba.edgeArrowtailAccessor=K(null),ba.edgeArrowSize=K(1),ba.edgeIsLayout=ba.edgeIsLayoutAccessor=K(function(a){return!a.value.notLayout}),ba.edgeIsShown=ba.edgeIsLayoutAccessor=K(!0),ba.lengthStrategy=k("lengthStrategy"),ba.edgeLength=ba.edgeDistanceAccessor=K(function(a){return a.value.distance}),ba.flowLayout=k("flowLayout"),ba.rankdir=k("rankdir"),ba.baseLength=k("baseLength"),ba.transitionDuration=K(500),ba.stageTransitions=K("none"),ba.deleteDelay=K(0),ba.groupConnected=K(!1),ba.timeLimit=K(0),ba.constrain=K(function(a,b){return[]}),ba.parallelEdgeOffset=K(10),ba.edgeOrdering=K(null),ba.cascade=function(a,b,c){for(var d in c){if(!ba[d])throw new Error("unknown attribute "+d);ba[d].cascade(a,b?c[d]:null)}return ba},ba.initLayoutOnRedraw=K(!1),ba.layoutUnchanged=K(!1),ba.relayout=function(){return ca=da=null,this},ba.initialLayout=f("initialLayout is deprecated - use layout algorithms instead",null),ba.initialOnly=f("initialOnly is deprecated - see the initialLayout deprecation notice in the documentation",!1),ba.induceNodes=K(!1),ba.showLayoutSteps=K(!1),ba.legend=K(null).react(function(a){a.parent(ba)}),ba.child=function(a,b){return 1===arguments.length?qa[a]:qa[a]===b?ba:(qa[a]&&qa[a].parent(null),qa[a]=b,b&&b.parent(ba),ba)},ba.layoutAlgorithm=function(a,b){if(!arguments.length)return ba.layoutEngine()?ba.layoutEngine().layoutAlgorithm():"cola";b||console.warn("dc.graph.diagram.layoutAlgorithm is depecrated - pass the layout engine object to dc_graph.diagram.layoutEngine instead");var c;switch(a){case"cola":c=J.cola_layout();break;case"dagre":c=J.dagre_layout()}return c=J.webworker_layout(c),ba.layoutEngine(c),this},ba.layoutEngine=K(null).react(function(a){a&&a.parent&&a.parent(ba)}),ba.tickSize=k("tickSize"),ba.uniqueId=function(){return ba.anchorName().replace(/[ .#=\[\]"]/g,"-")},ba.edgeId=function(a){return"edge-"+ba.edgeKey.eval(a).replace(/[^\w-_]/g,"-")},ba.arrowId=function(a,b){return"arrow-"+b+"-"+ba.uniqueId()+"-"+ba.edgeId(a)},ba.textpathId=function(a){return"textpath-"+ba.uniqueId()+"-"+ba.edgeId(a)},ba.getNode=function(a){return na[a]?na[a].orig:null},ba.handleDisconnected=k("handleDisconnected"),ba._enterNode=function(a){return ba.nodeTitle()&&a.append("title"),a.each(t(ba)),a.append(v(ba)).attr("class","node-shape"),a.append("text").attr("class","node-label"),ba},ba._updateNode=function(a){var b=a.filter(u(ba));b.select(".node-shape").remove(),b.each(t(ba)),b.insert(v(ba),":first-child").attr("class","node-shape"),a.select("title").text(ba.nodeTitle.eval);var c=a.select("text.node-label"),d=c.selectAll("tspan").data(function(a){var b=ba.nodeLabel.eval(a);if(!b)return[];"string"==typeof b&&(b=[b]);var c=b.length%2?.3-(b.length-1)/2:1-b.length/2;return b.map(function(a,b){return{line:a,ofs:(0==b?c:1)+"em"}})});return d.enter().append("tspan").attr("x",0).attr("dy",function(a){return a.ofs}),d.text(function(a){return a.line}),d.exit().remove(),c.attr("fill",ba.nodeLabelFill.eval).each(w(ba)),a.select(".node-shape").each(z(ba)).attr({stroke:ba.nodeStroke.eval,"stroke-width":ba.nodeStrokeWidth.eval,fill:i(ba.nodeFillScale()||e,ba.nodeFill.eval)}),ba},ba.isRunning=function(){return sa};var va=!1;ba.redraw=function(){return sa?(va=!0,this):ba.startLayout()},ba.startLayout=function(){function c(a,b){a.forEach(function(a){var b=na[a.dcg_nodeKey];b.cola.x=a.x,b.cola.y=a.y}),b.forEach(function(a){oa[a.dcg_edgeKey]})}var e=ba.nodeGroup().all(),f=ba.edgeGroup().all();if(sa)throw new Error("dc_graph.diagram.redraw already running!");sa=!0,ba.layoutEngine().stop(),ba.initLayoutOnRedraw()&&n(),ba.nodeOrdering()&&(e=b.quicksort.by(ba.nodeOrdering())(e.slice(0),0,e.length)),ba.edgeOrdering()&&(f=b.quicksort.by(ba.edgeOrdering())(f.slice(0),0,f.length));var g=m(na,e,function(a){return ba.nodeKey()(a)},function(a,b){a.orig=b,a.cola=a.cola||{},a.cola.dcg_nodeKey=ba.nodeKey.eval(a),ba.nodeFixed()&&(a.cola.dcg_nodeFixed=ba.nodeFixed.eval(a)),ba.layoutEngine().populateLayoutNode(a.cola,a)}),h=m(oa,f,function(a){return ba.edgeKey()(a)},function(a,b){a.orig=b,a.cola=a.cola||{},a.cola.dcg_edgeKey=ba.edgeKey.eval(a),a.cola.dcg_edgeSource=ba.edgeSource.eval(a),a.cola.dcg_edgeTarget=ba.edgeTarget.eval(a),a.source=na[a.cola.dcg_edgeSource],a.target=na[a.cola.dcg_edgeTarget],a.cola.dcg_edgeLength=ba.edgeLength.eval(a),ba.layoutEngine().populateLayoutEdge(a.cola,a)});if(h=h.filter(o),h=h.filter(function(a){return a.source!==a.target}),h=h.filter(ba.edgeIsShown.eval),ba.induceNodes()){var i={};h.forEach(function(a){i[a.cola.dcg_edgeSource]=!0,i[a.cola.dcg_edgeTarget]=!0}),g=g.filter(function(a){return i[a.cola.dcg_nodeKey]});for(var k in na)i[k]||delete na[k]}if(g.forEach(function(a,b){a.index=b}),pa={nnodes:g.length,nedges:h.length},ba.parallelEdgeOffset()){for(var l=new Array(g.length),q=0;q<l.length;++q){l[q]=new Array(l.length);for(var t=0;t<l.length;++t)l[q][t]={n:0,ports:{rev:[]}}}for(h.forEach(function(a){var b=Math.min(a.source.index,a.target.index),c=Math.max(a.source.index,a.target.index);a.parallel=l[b][c].n++,a.ports=l[b][c].ports,a.ports.rev.push(b!==a.source.index)}),q=0;q<l.length;++q)for(t=0;t<l.length;++t)l[q][t].n&&(l[q][t].ports.n=l[q][t].n)}var u=la.selectAll(".edge").data(h,ba.edgeKey.eval),v=u.enter().append("svg:path").attr({class:"edge",id:ba.edgeId,opacity:0});u.exit().transition().duration(p()).delay(ba.deleteDelay()).attr("opacity",0).each(function(a){R(a,"head",null),R(a,"head",null)}).remove();var w=la.selectAll(".edge-hover").data(h,ba.edgeKey.eval),x=w.enter().append("svg:path").attr("class","edge-hover").attr("opacity",0).attr("stroke","green").attr("stroke-width",10).on("mouseover",function(b){a.select("#"+ba.edgeId(b)+"-label").attr("visibility","visible")}).on("mouseout",function(b){a.select("#"+ba.edgeId(b)+"-label").attr("visibility","hidden")});w.exit().remove();var y=la.selectAll(".edge-label").data(h,ba.edgeKey.eval),z=y.enter().append("text").attr("id",function(a){return ba.edgeId(a)+"-label"}).attr("visibility","hidden").attr({class:"edge-label","text-anchor":"middle",dy:-2}).append("textPath").attr("startOffset","50%").attr("xlink:href",function(a){var b=ba.textpathId(a);return"#"+b}),A=ia.selectAll("path.edge-label-path").data(h,ba.textpathId),B=A.enter().append("svg:path").attr({class:"edge-label-path",id:ba.textpathId});y.each(function(a){a.dcg_bbox=null}).selectAll("textPath").text(function(a){return ba.edgeLabel.eval(a)}),y.exit().transition().duration(p()).delay(ba.deleteDelay()).attr("opacity",0).remove();var C=ka.selectAll(".node").data(g,ba.nodeKey.eval),D=C.enter().append("g").attr("class","node").attr("opacity","0");ba._enterNode(D),C.exit().transition().duration(p()).delay(ba.deleteDelay()).attr("opacity",0).remove(),ma.drawn(C,u,w),r(C,u),ba.initialLayout()&&ba.initialLayout()(ba,g,h);var E=!1;if(!ba.layoutUnchanged()){var F=JSON.stringify(g.map(d)),G=JSON.stringify(h.map(d));F===ca&&G===da&&(E=!0),ca=F,da=G}var H=ba.constrain()(ba,g,h);H.forEach(function(a){if(a.type)switch(a.type){case"alignment":a.offsets.forEach(function(a){a.node=na[a.node].index});break;case"circle":a.nodes.forEach(function(a){a.node=na[a.node].index})}else a.axis&&(a.left=na[a.left].index,a.right=na[a.right].index)});var I=h.filter(ba.edgeIsLayout.eval),K=(h.filter(function(a){return!ba.edgeIsLayout.eval(a)}),H.filter(function(a){return"circle"===a.type}));H=H.filter(function(a){return"circle"!==a.type}),K.forEach(function(a){var b=(a.distance||4*ba.baseLength())/(2*Math.sin(Math.PI/a.nodes.length)),c=a.nodes.map(function(a){return a.node}),d=function(a){return ba.nodeKey.eval(g[a])},e=J.wheel_edges(d,c,b).map(function(a){var b={internal:a};return b.source=na[a.sourcename],b.target=na[a.targetname],b});I=I.concat(e)});var L=H.filter(function(a){return"ordering"===a.type});if(H=H.filter(function(a){return"ordering"!==a.type}),L.forEach(function(a){var c=a.nodes.map(function(a){return na[a]});if(a.ordering){var d=b.quicksort.by(j(a.ordering));c=d(c,0,c.length)}var e;c.forEach(function(b,c){0===c?e=b:H.push({left:e.index,right:(e=b).index,axis:a.axis,gap:a.gap})})}),ba.legend()&&ba.legend().redraw(),E)return sa=!1,ma.end(!1),this;var M=Date.now();return ba.layoutEngine().on("tick",function(a,b){var d=Date.now()-M;ba.initialOnly()||c(a,b),ba.showLayoutSteps()&&Q(C,D,u,v,w,x,y,z,A,B),(va||ba.timeLimit()&&d>ba.timeLimit())&&(console.log("cancelled"),ba.layoutEngine().stop())}).on("end",function(a,b){ba.showLayoutSteps()?s(!0):(ba.initialOnly()||c(a,b),Q(C,D,u,v,w,x,y,z,A,B));var d;switch(ba.autoZoom()){case"always":d=!0;break;case"once":d=!0,ba.autoZoom(null);break;default:d=!1}N(C,u),d&&O()}).on("start",function(){console.log("algo "+ba.layoutEngine().layoutAlgorithm()+" started."),ma.start()}),ba.initialOnly()?ba.layoutEngine().dispatch().end(g,h):(ma.start(),ba.layoutEngine().data(g.map(function(a){return a.cola}),I.map(function(a){return a.cola}),H,{groupConnected:ba.groupConnected()}),ba.layoutEngine().start({initialUnconstrainedIterations:10,initialUserConstraintIterations:20,initialAllConstraintsIterations:20})),this},ba.refresh=function(b,c,d,e,f){b=b||ka.selectAll(".node"),c=c||la.selectAll(".edge"),r(b,c),d=d||la.selectAll(".edge-hover"),e=e||la.selectAll(".edge-label"),f=f||ia.selectAll("path.edge-label-path");var g=a.select(null);Q(b,g,c,g,d,g,e,g,f,g)};var wa;return ba.render=function(){return ba.initLayoutOnRedraw()||n(),ba.resetSvg(),ja=ha.append("g").attr("class","draw"),la=ja.append("g").attr("class","edge-layer"),ka=ja.append("g").attr("class","node-layer"),ba.legend()&&ba.legend().render(),ba.redraw()},ba.on=function(a,b){return ma.on(a,b),this},ba.getStats=function(){return pa},ba.select=function(a){return ba.root().select(a)},ba.selectAll=function(a){return ba.root()?ba.root().selectAll(a):null},ba.x=K(null),ba.y=K(null),ba.svg=function(a){return arguments.length?(ha=a,ba):ha},ba.g=function(a){return arguments.length?(ja=a,ba):ja},ba.resetSvg=function(){return ba.select("svg").remove(),aa()},ba.redrawGroup=function(){c.redrawAll(h)},ba.renderGroup=function(){c.renderAll(h)},ba.defineArrow=function(a,b,c,d,e,f){return ra[a]={name:a,width:b,height:c,refX:d,refY:e,drawFunction:f},ba},ba.addOrRemoveDef=function(a,b,c){var d=b?[0]:[],e=ia.selectAll("#"+a).data(d),f=e.enter().append(c).attr("id",a);return e.exit().remove(),f},ba.invertCoord=function(a){return[ba.x().invert(a[0]),ba.y().invert(a[1])]},ba.defineArrow("vee",12,12,10,0,function(a){a.append("svg:path").attr("d","M0,-5 L10,0 L0,5 L3,0").attr("stroke-width","0px")}),ba.defineArrow("dot",7,7,0,0,function(a){a.append("svg:circle").attr("r",5).attr("cx",5).attr("cy",0).attr("stroke-width","0px")}),ba.anchor=function(b,d){if(!arguments.length)return fa;if(!b)throw new c.errors.BadArgumentException("parent must be defined");return fa=b.select&&b.classed?b.node():b,ba.root(a.select(fa)),ba.root().classed(J.constants.CHART_CLASS,!0),c.registerChart(ba,d),ga=d,ba},ba.chartID=function(){return ba.__dcFlag__},ba.anchorName=function(){var a=ba.anchor();return a&&a.id?a.id:a&&a.replace?a.replace("#",""):"dc-graph"+ba.chartID()},ba.anchor(g,h)},J.spawn_engine=function(a,b,c){var d,e,f=!0;switch(a){case"dagre":d=J.dagre_layout(),e=["rankdir"];break;case"tree":d=J.tree_layout(),e=[],f=!1;break;case"cola":default:d=J.cola_layout(),
e=["lengthStrategy"]}return e.forEach(function(a){b[a]&&d[a](b[a])}),f&&"false"!==c&&(d=J.webworker_layout(d)),d};var Q={};J.webworker_layout=function(b){var c=a.dispatch("init","start","tick","end"),d=F(b.layoutAlgorithm()),e={};d.layouts[b.layoutId()]=e,e.parent=function(a){b.parent&&b.parent(a)},e.init=function(a){return a=b.optionNames().reduce(function(a,c){return a[c]=b[c](),a},a),d.worker.postMessage({command:"init",args:{layoutId:b.layoutId(),options:a}}),this},e.data=function(a,c,e,f){d.worker.postMessage({command:"data",args:{layoutId:b.layoutId(),nodes:a,edges:c,constraints:e,options:f}})},e.start=function(a){d.worker.postMessage({command:"start",args:{layoutId:b.layoutId(),options:a}})},e.stop=function(){return d.worker.postMessage({command:"stop",args:{layoutId:b.layoutId()}}),this},e.getEngine=function(){return b};var f=["layoutAlgorithm","populateLayoutNode","populateLayoutEdge","rankdir","ranksep"];return f.forEach(function(a){e[a]=function(){var c=b[a].apply(b,arguments);return arguments.length?this:c}}),e.on=function(a,b){return c.on(a,b),this},e.dispatch=function(){return c},e},J.graphviz_attrs=function(){return{rankdir:K("TB"),ranksep:K(40)}},J.cola_layout=function(b){function c(a){switch(j=cola.d3adaptor().avoidOverlaps(!0).size([a.width,a.height]).handleDisconnected(a.handleDisconnected),j.tickSize&&j.tickSize(a.tickSize),a.lengthStrategy){case"symmetric":j.symmetricDiffLinkLengths(a.baseLength);break;case"jaccard":j.jaccardLinkLengths(a.baseLength);break;case"individual":j.linkDistance(function(b){return b.dcg_edgeLength||a.baseLength});break;case"none":}a.flowLayout&&j.flowLayout(a.flowLayout.axis,a.flowLayout.minSeparation)}function d(a,b,c,d){function e(a){k[a](f,g.map(function(a){return{dcg_edgeKey:a.dcg_edgeKey}}))}var f=m(l,a,function(a){return a.dcg_nodeKey},function(a,b){a.dcg_nodeKey=b.dcg_nodeKey,a.width=b.width,a.height=b.height,a.fixed=!!b.dcg_nodeFixed,a.fixed&&"object"==typeof b.dcg_nodeFixed?(a.x=b.dcg_nodeFixed.x,a.y=b.dcg_nodeFixed.y):(void 0!==b.x&&(a.x=b.x),void 0!==b.y&&(a.y=b.y))}),g=m(n,b,function(a){return a.dcg_edgeKey},function(a,b){a.dcg_edgeKey=b.dcg_edgeKey,a.source=l[b.dcg_edgeSource],a.target=l[b.dcg_edgeTarget],a.dcg_edgeLength=b.dcg_edgeLength});f.forEach(function(a,b){a.index=b});var h=null;if(d.groupConnected){var i=cola.separateGraphs(f,g);h=i.map(function(a){return{leaves:a.array.map(function(a){return a.index})}})}j.on("tick",function(){e("tick")}).on("start",function(){k.start()}).on("end",function(){e("end")}),j.nodes(f).links(g).constraints(c).groups(h)}function e(a){j.start(a.initialUnconstrainedIterations,a.initialUserConstraintIterations,a.initialAllConstraintsIterations,a.gridSnapIterations)}function f(){j.stop()}var h,i=b||g(),j=null,k=a.dispatch("tick","start","end"),l={},n={},o=J.graphviz_attrs(),p=Object.keys(o);o.rankdir(null);var q=Object.assign(o,{layoutAlgorithm:function(){return"cola"},layoutId:function(){return i},parent:K(null),on:function(a,b){return k.on(a,b),this},init:function(a){return this.optionNames().forEach(function(b){a[b]=a[b]||this[b]()}.bind(this)),c(a),this},data:function(a,b,c,e){d(a,b,c,e)},start:function(a){e(a)},stop:function(){f()},optionNames:function(){return["handleDisconnected","lengthStrategy","baseLength","flowLayout","tickSize"].concat(p)},populateLayoutNode:function(){},populateLayoutEdge:function(){},handleDisconnected:K(!0),lengthStrategy:K("symmetric"),baseLength:K(30),flowLayout:function(a){if(!arguments.length){if(h)return h;var b=q.rankdir();if(!b)return null;var c="LR"===b||"RL"===b?"x":"y";return{axis:c,minSeparation:q.ranksep()+2*q.parent().nodeRadius()}}return h=a,this},tickSize:K(1)});return q},J.cola_layout.scripts=["d3.js","cola.js"],J.dagre_layout=function(b){function c(a){k=new dagre.graphlib.Graph({multigraph:!0}),k.setGraph({rankdir:a.rankdir}),k.setDefaultEdgeLabel(function(){return{}})}function d(a,b,c,d){function e(a){l[a](f,g.map(function(a){return{dcg_edgeKey:a.dcg_edgeKey}}))}var f=m(n,a,function(a){return a.dcg_nodeKey},function(a,b){a.dcg_nodeKey=b.dcg_nodeKey,a.width=b.width,a.height=b.height},function(a,b){k.setNode(a,b)},function(a){k.removeNode(a)}),g=m(o,b,function(a){return a.dcg_edgeKey},function(a,b){a.dcg_edgeKey=b.dcg_edgeKey,a.dcg_edgeSource=b.dcg_edgeSource,a.dcg_edgeTarget=b.dcg_edgeTarget},function(a,b,c){k.setEdge(c.dcg_edgeSource,c.dcg_edgeTarget,b)},function(a,b){k.removeEdge(b.dcg_edgeSource,b.dcg_edgeTarget,b.dcg_edgeKey)});h=function(){e("tick")},i=function(){e("end")}}function e(a){l.start(),dagre.layout(k),i()}function f(){}var h,i,j=b||g(),k=null,l=a.dispatch("tick","start","end"),n={},o={},p=J.graphviz_attrs(),q=Object.keys(p);return Object.assign(p,{layoutAlgorithm:function(){return"dagre"},layoutId:function(){return j},on:function(a,b){return l.on(a,b),this},init:function(a){return this.optionNames().forEach(function(b){a[b]=a[b]||this[b]()}.bind(this)),c(a),this},data:function(a,b,c,e){d(a,b,c,e)},start:function(a){e(a)},stop:function(){f()},optionNames:function(){return q},populateLayoutNode:function(){},populateLayoutEdge:function(){}})},J.dagre_layout.scripts=["d3.js","dagre.js"],J.tree_layout=function(b){function c(b){function c(a,b){return(e(a)+e(b))/2}var d,e=a.functor(b.nodeWidth);h=J.depth_first_traversal({nodeid:function(a){return a.dcg_nodeKey},sourceid:function(a){return a.dcg_edgeSource},targetid:function(a){return a.dcg_edgeTarget},init:function(){d=b.offsetX},row:function(a){return a.dcg_rank},place:function(a,c,f){if(f.length){var g=f[f.length-1],h=(e(g)+e(a))/2;d=Math.max(d,g.left_x+h)}a.left_x=d,a.hit_ins=1,a.y=c*b.gapY+b.offsetY},sib:function(a,b,e){var f=c(b,e);a&&(f*=1.5),d+=f},pop:function(a){a.x=(a.left_x+d)/2},skip:function(a,b){a.x=(a.hit_ins*a.x+d)/++a.hit_ins,a.hit_ins===b&&delete a.hit_ins},finish:function(a){a.forEach(function(a){for(var b,d=a.sort(function(a,b){return a.x-b.x}),e=null,f=null,g=0;g<d.length-1;++g){var h=d[g],i=d[g+1];if(e){if(b+=c(h,i),g<d.length-2&&i.x<f+b)continue;e>0&&--e;var j,k;if(g<d.length-2){var l=i.x-(f+b);j=d[e].x+l/2,k=g+1}else j=Math.max(d[e].x,f-c(d[e],d[e+1])-(b-i.x+f)/2),k=d.length;for(var m=e+1;m<k;++m)j+=c(d[m-1],d[m]),d[m].x=j;e=f=b=null}else i.x-h.x<c(h,i)&&(e=g,f=h.x,b=c(h,i))}})}})}function d(a,b,c,d){i=a,j=b}function e(a){h(i,j),l.end(i,j)}function f(){}var h,i,j,k=b||g(),l=a.dispatch("tick","start","end"),m={layoutAlgorithm:function(){return"tree"},layoutId:function(){return k},on:function(a,b){return l.on(a,b),this},init:function(a){return this.optionNames().forEach(function(b){a[b]=a[b]||this[b]()}.bind(this)),c(a),this},data:function(a,b,c,e){d(a,b,c,e)},start:function(a){e(a)},stop:function(){f()},optionNames:function(){return["nodeWidth","offsetX","offsetY","rowFunction","gapY"]},populateLayoutNode:function(a,b){this.rowFunction()&&(a.dcg_rank=this.rowFunction.eval(b))},populateLayoutEdge:function(){},nodeWidth:K(function(a){return a.width}),offsetX:K(30),offsetY:K(30),rowFunction:K(null),gapY:K(100)};return m},J.tree_layout.scripts=[],J.legend=function(){var a,b={};return b.x=K(0),b.y=K(0),b.gap=K(5),b.nodeWidth=K(40),b.nodeHeight=K(40),b.exemplars=K({}),b.parent=K(null),b.redraw=function(){var c=b.parent().svg().selectAll("g.dc-graph-legend").data([0]);c.enter().append("g").attr("class","dc-graph-legend").attr("transform","translate("+b.x()+","+b.y()+")");var d=c.selectAll(".node").data(a,function(a){return a.name}),e=d.enter().append("g").attr("class","node");e.append("text").attr("dy","0.3em").attr("class","legend-label"),d.attr("transform",function(a,c){return"translate("+b.nodeWidth()/2+","+(b.nodeHeight()+b.gap())*(c+.5)+")"}),d.select("text.legend-label").attr("transform","translate("+(b.nodeWidth()/2+b.gap())+",0)").text(function(a){return a.name}),b.parent()._enterNode(e)._updateNode(d)},b.render=function(){var c=b.exemplars();if(c instanceof Array)a=c.map(function(a){return{name:a.name,orig:{key:a.key,value:a.value},cola:{}}});else{a=[];for(var d in c)a.push({name:d,orig:{key:d,value:c[d]},cola:{}})}b.redraw()},b},J.constraint_pattern=function(a){var b={},c=[];return a.nodes.forEach(function(a){var c=a.id,d=b[c]||(b[c]={});if(a.partition){var e=a.partition,f=a.value||a.id;a.all||a.typename?(d.match=a.extract?function(b){return a.extract(b.value[e])}:function(a){return a.value[e]},d.typename=a.typename||function(a){return e+"="+a.value[e]}):d.match=function(a){return a.value[e]===f}}else{if(!a.match)throw new Error("couldn't determine matcher for type "+JSON.stringify(a));d.match=a.match}}),a.edges.forEach(function(a){if(!a.disable){var b={source:a.source,target:a.target};b.produce="function"==typeof a.produce?a.produce:function(){return k(a.produce)},["listname","wrap","reverse"].forEach(function(c){void 0!==a[c]&&(b[c]=a[c])}),c.push(b)}}),function(a,d,e){var f=[],g={};d.forEach(function(c){var d=a.nodeKey.eval(c);for(var e in b){var f=b[e],h=f.match(c.orig);if(h){var i=f.typename?f.typename(e,h):e;g[i]||(g[i]={nodes:[],whether:{}}),g[i].nodes.push(d),g[i].whether[d]=!0}}});var h=c.filter(function(a){return a.source!==a.target}),i=c.filter(function(a){return a.source===a.target});return e.forEach(function(b){var c=a.edgeSource.eval(b),i=a.edgeTarget.eval(b);h.forEach(function(a){if(g[a.source]&&g[a.source].whether[c]&&g[a.target]&&g[a.target].whether[i]){var b=a.produce(g,d,e);a.reverse?(b.left=i,b.right=c):(b.left=c,b.right=i),f.push(b)}})}),i.forEach(function(a){if(g[a.source]){var b=a.produce(),c=a.listname||a.produce.listname||"nodes",d=a.wrap||a.produce.wrap||function(a){return a};b[c]=g[a.source].nodes.map(d),f.push(b)}}),f}},J.gap_y=function(a,b){return{axis:"y",gap:a,equality:!!b}},J.gap_x=function(a,b){return{axis:"x",gap:a,equality:!!b}},J.align_y=function(){return G("y")},J.align_x=function(){return G("x")},J.order_x=function(a,b){return{type:"ordering",axis:"x",gap:60,ordering:b}},J.order_y=function(a,b){return{type:"ordering",axis:"y",gap:60,ordering:b}},J.tree_positions=function(b,c,d,e,f,g,h){function i(a,b){return(g(a)+g(b))/2}console.warn("dc_graph.tree_positions is deprecated; use the layout engine tree_layout instead"),(b||d)&&console.warn("dc_graph.tree_positions: rootf and treef are ignored");var j;g=a.functor(g);var k=J.depth_first_traversal({nodeid:function(a){return a.cola.dcg_nodeKey},sourceid:function(a){return a.cola.dcg_edgeSource},targetid:function(a){return a.cola.dcg_edgeTarget},init:function(){j=e},row:function(a){return c(a.orig)},place:function(a,b,c){if(c.length){var d=c[c.length-1],e=(g(d)+g(a))/2;j=Math.max(j,d.left_x+e)}a.left_x=j,a.hit_ins=1,a.cola.y=b*h+f},sib:function(a,b,c){var d=i(b,c);a&&(d*=1.5),j+=d},pop:function(a){a.cola.x=(a.left_x+j)/2},skip:function(a,b){a.cola.x=(a.hit_ins*a.cola.x+j)/++a.hit_ins,a.hit_ins===b&&delete a.hit_ins},finish:function(a){a.forEach(function(a){for(var b,c=a.sort(function(a,b){return a.cola.x-b.cola.x}),d=null,e=null,f=0;f<c.length-1;++f){var g=c[f],h=c[f+1];if(d){if(b+=i(g,h),f<c.length-2&&h.cola.x<e+b)continue;d>0&&--d;var j,k;if(f<c.length-2){var l=h.cola.x-(e+b);j=c[d].cola.x+l/2,k=f+1}else j=Math.max(c[d].cola.x,e-i(c[d],c[d+1])-(b-h.cola.x+e)/2),k=c.length;for(var m=d+1;m<k;++m)j+=i(c[m-1],c[m]),c[m].cola.x=j;d=e=b=null}else h.cola.x-g.cola.x<i(g,h)&&(d=f,e=g.cola.x,b=i(g,h))}})}});return function(a,b,c){return k(b,c)}},J.tree_constraints=function(a,b,c,d){return console.warn("dc_graph.tree_constraints is deprecated - it never worked right and may not be a good idea"),function(d,e,f){var g=[],h=0,i=J.depth_first_traversal({root:a,tree:b,place:function(a,b,c){if(c.length){var e=c[c.length-1];g.push({left:d.nodeKey.eval(e),right:d.nodeKey.eval(a),axis:"x",gap:h-e.foo_x,equality:!0})}a.foo_x=h},sib:function(){h+=c}});return i(d,e,f),g}},J.behavior=function(a,b){var c={};return c.parent=K(null).react(function(d){var e;if(d){var f=!0;e=d,d.on("drawn."+a,function(a,c,d){b.add_behavior(e,a,c,d),f&&b.first?(b.first(e,a,c,d),f=!1):b.rest&&b.rest(e,a,c,d)})}else c.parent()&&(e=c.parent(),e.on("drawn."+a,function(c,d,f){b.remove_behavior(e,c,d,f),e.on("drawn."+a,null)}));b.parent&&b.parent(d)}),c},J.tip=function(){function b(b){return function(c){var d=a.event.target,h=function(){f[b]()(c,function(a){g.show(a,d)})};f.delay()?(clearTimeout(e),e=setTimeout(h,f.delay())):h()}}function c(){e&&(clearTimeout(e),e=null),g.hide()}function d(d,e){g||(g=a.tip().attr("class","d3-tip").html(function(a){return"<span>"+a+"</span>"}).direction(f.direction()),f.parent().svg().call(g)),d.on("mouseover.tip",b("content")).on("mouseout.tip",c),e.on("mouseover.tip",b("content")).on("mouseout.tip",c)}var e,f={},g=null;return f.parent=K(null).react(function(a){a?a.on("drawn.tip",function(a,b,c){d(a,c)}):f.parent()&&f.parent().on("drawn.tip",null)}),f.direction=K("n"),f.content=K(function(a,b){b(f.parent()?f.parent().nodeTitle.eval(a):"")}),f.delay=K(0),f},J.tip.table=function(){var b=function(c,d){c=c.orig.value;var e=Object.keys(c).filter(a.functor(b.filter())).filter(function(a){return c[a]}),f=a.select(document.createElement("table")),g=f.selectAll("tr").data(e),h=g.enter().append("tr");h.append("td").text(function(a){return a}),h.append("td").text(function(a){return c[a]}),d(f.node().outerHTML)};return b.filter=K(!0),b},J.edit_text=function(a,b,c){var d=c.position||{x:0,y:0};H(a.node(),d,c)},J.select_nodes=function(b){function c(a){return a.shiftKey}function d(a){return u?a.metaKey:a.ctrlKey}function e(a,b){return a.indexOf(b)>=0?a:a.concat([b])}function f(a,b){return a.indexOf(b)>=0?a.filter(function(a){return a!=b}):a.concat([b])}function g(a){return function(b){t=b,a.refresh()}}function i(a,b){a.svg().on("click.select-nodes",b?function(a){s.node_set_changed([])}:null)}function j(){c(a.event.sourceEvent)||d(a.event.sourceEvent)?p=t.slice():(p=[],s.node_set_changed([]))}function k(){var b,g=q.extent(),h=v.parent().selectAll("g.node").data().filter(function(a){return a&&g[0][0]<a.cola.x&&a.cola.x<g[1][0]&&g[0][1]<a.cola.y&&a.cola.y<g[1][1]}).map(function(a){return a.orig.key});b=c(a.event.sourceEvent)?h.reduce(e,p):d(a.event.sourceEvent)?h.reduce(f,p):h,s.node_set_changed(b)}function l(){r.call(q.clear())}function m(b){q||(q=a.svg.brush().x(b.x()).y(b.y()).on("brushstart",j).on("brush",k).on("brushend",l),r=b.svg().insert("g",":first-child").attr("class","brush").call(q))}function n(g,j,k){var l=v.noneIsAll()?function(a){return!t.length||t.indexOf(a.orig.key)>=0}:function(a){return t.indexOf(a.orig.key)>=0};g.cascade(50,!0,h(l,null,b)),j.on("click.select-nodes",function(b){var h,i=g.nodeKey.eval(b);c(a.event)?h=e(t,i):d(a.event)?h=f(t,i):(1===t.length&&t[0]===i&&v.secondClickEvent()&&v.secondClickEvent()(a.select(this)),h=[i]),s.node_set_changed(h),a.event.stopPropagation()}),v.multipleSelect()?m(g):i(g,v.clickBackgroundClears());var n=j.data().map(function(a){return a.orig.key}),o=t.filter(function(a){return n.indexOf(a)>=0});t.length!==o.length&&s.node_set_changed(o)}function o(a,c,d){c.on("click.select-nodes",null),a.svg().on("click.select-nodes",null),a.cascade(50,!1,b)}var p,q,r,s=J.select_nodes_group("select-nodes-group"),t=[],u=navigator.platform.toUpperCase().indexOf("MAC")!==-1,v=J.behavior("select-nodes",{add_behavior:n,remove_behavior:o,parent:function(a){s.on("node_set_changed.select-nodes",a?g(a):null)}});return v.multipleSelect=K(!0),v.clickBackgroundClears=K(!0,!1).react(function(a){!v.multipleSelect()&&v.parent()&&i(v.parent(),a)}),v.secondClickEvent=K(null),v.noneIsAll=K(!1),v},J.select_nodes_group=function(b){return window.chart_registry.create_type("select-nodes",function(){return a.dispatch("node_set_changed")}),window.chart_registry.create_group("select-nodes",b)},J.filter_selection=function(){function b(b){return function(c){if(c.length){var d=a.set(c);b.nodeDimension().filterFunction(function(a){return d.has(a)})}else b.nodeDimension().filter(null);b.redrawGroup()}}var c=J.select_nodes_group("select-nodes-group"),d={parent:K(null).react(function(a){c.on("node_set_changed.filter-selection",a?b(a):null)})};return d},J.label_nodes=function(b){function c(a){return function(a){k=a,k.length&&g.node().focus()}}function d(a){return function(b,c){J.edit_text(a.svg(),b,{text:c.text||a.nodeLabel.eval(b.datum()),position:{x:b.datum().cola.x,y:b.datum().cola.y},selectText:c.selectText,accept:function(c){var d=b.datum();d.orig.value[h]=c,a.redraw()}})}}function e(b,c,d){g=b.svg().selectAll("a#label-nodes-input").data([1]),g.enter().append("a").attr({id:"label-nodes-input",href:"#"}),g.on("keyup.label-nodes",function(){if(k.length){if(1!==a.event.key.length)return;var d=c.filter(function(a){return b.nodeKey.eval(a)===k[0]});if(d.empty())return void console.error("couldn't find node '"+k[0]+"'!");if(d.size()>1)return void console.error("found too many nodes for '"+k[0]+"' ("+d.size()+")!");j.edit_node_label(d,{text:a.event.key,selectText:!1})}})}function f(a,b,c){a.root().select("a#label-nodes-input").remove()}if(!b.nodeCrossfilter)throw new Error("need nodeCrossfilter");var g,h=(b.idTag||"id",b.labelTag||"label"),i=J.select_nodes_group("select-nodes-group"),j=J.label_nodes_group("label-nodes-group"),k=[],l=J.behavior("label-nodes",{add_behavior:e,remove_behavior:f,parent:function(a){i.on("node_set_changed.label-nodes",a?c(a):null),j.on("edit_node_label.label-nodes",a?d(a):null)}});return l},J.label_nodes_group=function(b){return window.chart_registry.create_type("label-nodes",function(){return a.dispatch("edit_node_label")}),window.chart_registry.create_group("label-nodes",b)},J.highlight_neighbors=function(a){function b(a){a.each(function(a){a.dcg_highlighted=!1})}function c(c,d,e){c.cascade(100,!0,h(null,function(a){return a.dcg_highlighted},a)),d.on("mouseover.highlight-neighbors",function(a){e.each(function(b){b.dcg_highlighted=b.source===a||b.target===a}),c.refresh(d,e)}).on("mouseout.highlight-neighbors",function(a){b(e),c.refresh(d,e)})}function d(c,d,e){d.on("mouseover.highlight-neighbors",null).on("mouseout.highlight-neighbors",null),b(e),c.cascade(100,!1,a)}return J.behavior("highlight-neighbors",{add_behavior:c,remove_behavior:function(a,b,c){d(a,b,c)}})},J.register_highlight_paths_group=function(b){return window.chart_registry.create_type("highlight-paths",function(){return a.dispatch("paths_changed","hover_changed","select_changed")}),window.chart_registry.create_group("highlight-paths",b)},J.highlight_paths=function(a,b,c,d){function e(){v.doRedraw()?v.parent().relayout().redraw():v.parent().refresh()}function f(a,b){r=a,s=b,t=u=null,e()}function g(a){a!==u&&(u=a,e())}function i(a){a!==t&&(t=a,e())}function j(){r={},s={}}function k(a){return function(b){return a.indexOf(b)>=0}}function l(a){var b=k(a);return function(a){return!b(a)}}function m(a,b){return!(!a||!b)&&a.some(k(b))}function n(a,b){return a?b?b.every(k(a))?a.filter(l(b)):a.concat(b.filter(l(a))):a:b}function o(d,e,f,g){d.cascade(200,!0,h(function(a){return!!r[d.nodeKey.eval(a)]},function(a){return!!s[d.edgeKey.eval(a)]},a)).cascade(300,!0,h(function(a){return m(r[d.nodeKey.eval(a)],t)},function(a){return m(s[d.edgeKey.eval(a)],t)},c)).cascade(400,!0,h(function(a){return m(r[d.nodeKey.eval(a)],u)},function(a){return m(s[d.edgeKey.eval(a)],u)},b)),e.on("mouseover.highlight-paths",function(a){q.hover_changed(r[d.nodeKey.eval(a)]||null)}).on("mouseout.highlight-paths",function(a){q.hover_changed(null)}).on("click.highlight-paths",function(a){q.select_changed(n(t,r[d.nodeKey.eval(a)]))}),g.on("mouseover.highlight-paths",function(a){q.hover_changed(s[d.edgeKey.eval(a)]||null)}).on("mouseout.highlight-paths",function(a){q.hover_changed(null)}).on("click.highlight-paths",function(a){q.select_changed(n(t,s[d.nodeKey.eval(a)]))})}function p(d,e,f,g){e.on("mouseover.highlight-paths",null).on("mouseout.highlight-paths",null).on("click.highlight-paths",null),g.on("mouseover.highlight-paths",null).on("mouseout.highlight-paths",null).on("click.highlight-paths",null),j(),d.cascade(200,!1,a).cascade(300,!1,c).cascade(400,!1,b)}var q=J.register_highlight_paths_group(d||"highlight-paths-group");a=a||{},b=b||{},c=c||{};var r={},s={},t=null,u=null,v=J.behavior("highlight-paths",{add_behavior:o,remove_behavior:function(a,b,c,d){return p(a,b,c,d),this},parent:function(a){var b=a.anchorName();q.on("paths_changed."+b,a?f:null),q.on("hover_changed."+b,a?g:null),q.on("select_changed."+b,a?i:null)}});return v.doRedraw=K(!1),v},J.expand_collapse=function(b,c,d,e){function f(a){var b=a.addOrRemoveDef("spike-gradient",!0,"linearGradient");b.attr({x1:"0%",y1:"0%",x2:"100%",y2:"0%",spreadMethod:"pad"}),b.selectAll("stop").data([[0,"black",1],[100,"black","0"]]).enter().append("stop").attr({offset:function(a){return a[0]+"%"},"stop-color":function(a){return a[1]},"stop-opacity":function(a){return a[2]}})}function g(a,b,c,d){var e;switch(c){case"out":e=function(b){return a.edgeSource.eval(b)===d};break;case"in":e=function(b){return a.edgeTarget.eval(b)===d};break;case"both":e=function(b){return a.edgeSource.eval(b)===d||a.edgeTarget.eval(b)===d}}return b.filter(e).size()}function h(a,b,c){if("both"===b)return function(a){return Math.PI*(2*a/c-.5)};var d,e=(c-1)*Math.PI/c;switch(a){case"LR":d=0;break;case"TB":d=Math.PI/2;break;case"RL":d=Math.PI;break;case"BT":d=-Math.PI/2}return"in"===b&&(d+=Math.PI),function(a){return d+e*(-.5+(c>1?a/(c-1):0))}}function i(a,b,c){var d=b.selectAll("g.spikes").data(function(a){return!a.dcg_expand_selected||a.dcg_expanded&&a.dcg_expanded[a.dcg_expand_selected.dir]?[]:[a]});d.exit().remove(),d.enter().insert("g",":first-child").classed("spikes",!0);var e=d.selectAll("rect.spike").data(function(b){for(var c=(a.nodeKey.eval(b),b.dcg_expand_selected.dir),d=b.dcg_expand_selected.n,e=h(a.layoutEngine().rankdir(),c,d),f=Array(d),g=0;g<d;++g){var i=e(g);f[g]={a:180*i/Math.PI,x:Math.cos(i)*b.dcg_rx*.9,y:Math.sin(i)*b.dcg_ry*.9}}return f});e.enter().append("rect").classed("spike",!0).attr({width:25,height:3,fill:"url(#spike-gradient)",rx:1,ry:1,x:0,y:0}),e.attr("transform",function(a){return"translate("+a.x+","+a.y+") rotate("+a.a+")"}),e.exit().remove()}function j(a,b,c){b.each(function(a){a.dcg_expand_selected=null}),i(a,b,c)}function k(a,b,c,d){return 1===g(a,b,d,c)}function l(a,b,c,d){if(1===c.length)return c[0];var e=a.root().node().getBoundingClientRect(),f=a.invertCoord([b.clientX-e.left,b.clientY-e.top]),g=f[0],h=f[1];switch(a.layoutEngine().rankdir()){case"TB":return h>d.cola.y?"out":"in";case"BT":return h<d.cola.y?"out":"in";case"LR":return g>d.cola.x?"out":"in";case"RL":return g<d.cola.x?"out":"in"}throw new Error("unknown rankdir "+a.layoutEngine().rankdir())}function m(f,h,m){function n(c){var d=l(f,a.event,e,c),j=f.nodeKey.eval(c);Promise.resolve(b(j,d)).then(function(a){var b={dir:d,n:Math.max(0,a-g(f,m,d,j))};h.each(function(a){a.dcg_expand_selected=a===c?b:null}),i(f,h,m)})}function o(b){function g(){var a=l(f,j,e,b);b.dcg_expanded=b.dcg_expanded||{},b.dcg_expanded[a]?(d(f.nodeKey.eval(b),k.bind(null,f,m,a),a),b.dcg_expanded[a]=!1):(c(f.nodeKey.eval(b),a,"dblclick"===j.type),b.dcg_expanded[a]=!0),i(f,h,m),b.dcg_dblclk_timeout=null}var j=a.event;return console.log(j.type),g()}h.on("mouseover.expand-collapse",n).on("mousemove.expand-collapse",n).on("mouseout.expand-collapse",function(a){j(f,h,m)}).on("click",o).on("dblclick",o)}function n(a,b,c){b.on("mouseover.expand-collapse",null).on("mouseout.expand-collapse",null),j(a,b)}if(e=e||["both"],e.length>2)throw new Error("there are only two directions to expand in");return J.behavior("expand-collapse",{add_behavior:m,first:f,remove_behavior:n})},J.draw_graphs=function(b){function c(b){var c=b.root().node().getBoundingClientRect();return b.invertCoord([a.event.clientX-c.left,a.event.clientY-c.top])}function d(){var a=u.filter(function(a){return a.source&&a.target}),b=t.selectAll("line.hint-edge").data(a);b.exit().remove(),b.enter().append("line").attr("class","hint-edge").style({fill:"none",stroke:"black","pointer-events":"none"}),b.attr({x1:function(a){return a.source.x},y1:function(a){return a.source.y},x2:function(a){return a.target.x},y2:function(a){return a.target.y}})}function e(){u=[],r=s=null,d()}function f(a,c){var d={};d[m]=g(),d[p]="",d[q]={x:c[0],y:c[1]},b.nodeCrossfilter.add([d]),a.redraw(),k.node_set_changed([d[m]])}function h(a,c,d){e();var f={};f[m]=g(),f[n]=c.orig.key,f[o]=d.orig.key,c.orig.value[q]=null,d.orig.value[q]=null,b.edgeCrossfilter.add([f]),a.redraw(),k.node_set_changed([])}function i(b,g,i,j){var k=b.child("select-nodes");k&&(k.clickBackgroundClears(!1),k.secondClickEvent(function(a){l.edit_node_label(a,{selectText:!0})})),g.on("mousedown.draw-graphs",function(b){a.event.stopPropagation(),r=b,u=[{source:{x:r.cola.x,y:r.cola.y}}]}).on("mousemove.draw-graphs",function(b){a.event.stopPropagation(),r&&(b===r?(s=null,u[0].target=null):b!==s&&(s=b,u[0].target={x:s.cola.x,y:s.cola.y}),d())}).on("mouseup.draw-graphs",function(c){a.event.stopPropagation(),r&&s?h(b,r,s):e()}),b.svg().on("mousedown.draw-graphs",function(){r=null}).on("mousemove.draw-graphs",function(){if(r){var a=c(b);s=null,u[0].target={x:a[0],y:a[1]},d()}}).on("mouseup.draw-graphs",function(){r?e():f(b,c(b))}),t||(t=b.g().append("g").attr("class","draw-graphs"))}function j(a,b,c,d){b.on("mousedown.draw-graphs",null).on("mousemove.draw-graphs",null).on("mouseup.draw-graphs",null),a.svg().on("mousedown.draw-graphs",null).on("mousemove.draw-graphs",null).on("mouseup.draw-graphs",null)}if(!b.nodeCrossfilter)throw new Error("need nodeCrossfilter");if(!b.edgeCrossfilter)throw new Error("need edgeCrossfilter");var k=J.select_nodes_group("select-nodes-group"),l=J.label_nodes_group("label-nodes-group"),m=b.idTag||"id",n=b.sourceTag||"source",o=b.targetTag||"target",p=b.labelTag||"label",q=b.fixedPosTag||"fixedPos",r=null,s=null,t=null,u=[],v=J.behavior("highlight-paths",{add_behavior:i,remove_behavior:j});return v.doRedraw=K(!1),v},J.load_graph=function(){function b(a){return a?a.replace(/\?.*/,""):null}var c,d,e;if(c=arguments[0],3===arguments.length)d=arguments[1],e=arguments[2];else{if(2!==arguments.length)throw new Error("need two or three arguments");e=arguments[1]}d?queue().defer(a.json,c).defer(a.json,d).await(function(a,b,c){a?e(a,null):e(null,{nodes:b.results,edges:c.results})}):/\.json$/.test(b(c))?a.json(c,e):/\.gv|\.dot$/.test(b(c))&&a.text(c,function(a,b){if(a)return void e(a,null);var c=graphlibDot.parse(b),d=c.nodes(),f=new Array(d.length);d.forEach(function(a,b){var e=f[b]=c._nodes[d[b]];e.id=b,e.name=a});var g=c.edges(),h=[];g.forEach(function(a){var b=c._edges[a];h.push({source:c._nodes[b.u].id,target:c._nodes[b.v].id,sourcename:b.u,targetname:b.v})});var i={nodes:f,links:h};e(null,i)})},J.munge_graph=function(a,b,c,d){function e(a,b){return b.filter(function(b){return!!a[b]})}var f,g,h=b||"name",i=c||"sourcename",j=d||"targetname";if(!I(a)){var k=["database","response"],l=k.findIndex(function(b){return a[b]&&I(a[b])});if(l<0)throw new Error("couldn't find the data!");a=a[k[l]]}g=a.edges||a.links,f=a.nodes||a.vertices;var m=g[0];if(void 0===m[i]){var n=c?[c]:["source_ecomp_uid","node1","source","tail"],o=d?[d]:["target_ecomp_uid","node2","target","head"],p=["edge"];if(m.node0&&m.node1)i="node0",j="node1";else{var q=e(m,n);if(!q.length){if(l=p.findIndex(function(a){return m[a]&&e(m[a],n).length}),l<0)throw c?new Error("sourceattr "+i+" didn't work"):new Error("didn't find any source attr");g=g.map(function(a){return a[p[l]]}),m=g[0],q=e(m,n)}if(q.length>1&&console.warn("found more than one possible source attr",q),i=q[0],q=e(m,o),!q.length)throw d&&!m[d]?new Error("targetattr "+j+" didn't work"):new Error("didn't find any target attr");q.length>1&&console.warn("found more than one possible target attr",q),j=q[0]}}var r=f[0];if(void 0===r[h]){var s=b?[b]:["ecomp_uid","id","_id"],t=["vertex"];if(q=e(r,s),!q.length){if(l=t.findIndex(function(a){return r[a]&&e(r[a],s).length}),l<0)throw b?new Error("nodekeyattr "+h+" didn't work"):new Error("couldn't find the node data");f=f.map(function(a){return a[t[l]]}),r=f[0],q=e(r,s)}q.length>1&&console.warn("found more than one possible node key attr",q),h=q[0]}return{nodes:f,edges:g,nodekeyattr:h,sourceattr:i,targetattr:j}},J.flat_group=function(){function a(a){return{all:function(){return a.all().filter(function(a){return null!==a.value})}}}function c(b,c){var e=b.dimension(c);return{crossfilter:b,dimension:e,group:a(e.group().reduce(d.add,d.remove,d.init))}}var d={add:function(a,b){return b},remove:function(){return null},init:function(){return null}};return{make:function(a,d){var e=b(a);return c(e,d)},another:function(a,b){return c(a,b)}}}();var R=function(a,b,d,e,f,h){if(f=f||0,b.length>(d.valuesByAttr?1:0)){var i=b.shift(),j=[],k=[],l=a.map(function(a){var c=a[d.nestKey],l=d.nestKeysUnique?c:g();if(l){var m;if(d.ancestorKeys?(h=h||{},i&&(h[i]=c),m=Object.assign({},h)):m={},m[d.nodeKey]=l,d.label&&d.labelFun&&(m[d.label]=d.labelFun(c,i,a)),d.level&&(m[d.level]=f+1),j.push(m),e){var n={};n[d.edgeSource]=e,n[d.edgeTarget]=l,k.push(n)}}var o=d.valuesByAttr?a[b[0]]:a.values,p=R(o,b.slice(0),d,l,f+1,Object.assign({},h));return p});return{nodes:Array.prototype.concat.apply(j,l.map(c.pluck("nodes"))),edges:Array.prototype.concat.apply(k,l.map(c.pluck("edges")))}}return{nodes:a.map(function(a){return a=Object.assign({},a),d.level&&(a[d.level]=f+1),a}),edges:a.map(function(a){var b={};return b[d.edgeSource]=e,b[d.edgeTarget]=a[d.nodeKey],b})}};return J.convert_tree=function(a,b,c){return c=Object.assign({nodeKey:"key",edgeKey:"key",edgeSource:"sourcename",edgeTarget:"targetname",nestKey:"key"},c),Array.isArray(a)?R(a,b,c,c.root,0,c.inherit):(b=[""].concat(b),R([a],b,c,c.root,0,c.inherit))},J.convert_nest=function(a,b,c,d,e,f,g){return J.convert_tree(a,b,{nodeKey:c,edgeSource:d,edgeTarget:e,root:f,inherit:g,ancestorKeys:!0,label:"name",labelFun:function(a,b,c){return b+":"+a},level:"_level"})},J.convert_adjacency_list=function(a,b,c){var d=Array.prototype.concat.apply([],a.map(function(a){return a[b.adjacencies].map(function(d){var e={};return c.edgeKey&&(e[c.edgeKey]=g()),e[c.edgeSource]=a[b.nodeKey],e[c.edgeTarget]=b.targetKey?d[b.targetKey]:d,c.adjacency&&(e[c.adjacency]=d),e})}));return{nodes:a,edges:d}},J.path_reader=function(a){function b(a,b,c){h.elementList.eval(a).forEach(function(d){var e,f;switch(h.elementType.eval(d)){case"node":e=h.nodeKey.eval(d),f=b[e]=b[e]||[];break;case"edge":e=h.edgeSource.eval(d)+"-"+h.edgeTarget.eval(d),f=c[e]=c[e]||[]}f.push(a)})}var c,d,f,g=J.register_highlight_paths_group(a||"highlight-paths-group"),h={pathList:K(e,!1),timeRange:K(null,!1),elementList:K(e,!1),elementType:K(null,!1),nodeKey:K(null,!1),edgeSource:K(null,!1),edgeTarget:K(null,!1),clear:function(){g.paths_changed({},{},[])},data:function(a){var e,i={},j={},k=[];h.pathList.eval(a).forEach(function(a){if(a._range=h.timeRange.eval(a)){if(e===!1)throw new Error("can't have a mix of ranged and non-ranged paths");e=!0}else{if(e===!0)throw new Error("can't have a mix of ranged and non-ranged paths");e=!1,b(a,i,j)}k.push(a)}),e?(c=k.map(function(a){var b=[a._range[0].getTime(),a._range[1].getTime()];return b.path=a,b}),d=lysenkoIntervalTree(c),f&&this.setTime(f)):(c=null,d=null,g.paths_changed(i,j,k))},getIntervals:function(){return c},setTime:function(a){if(a&&d){var c=[],e={},h={};d.queryPoint(a.getTime(),function(a){c.push(a.path),b(a.path,e,h)}),g.paths_changed(e,h,c)}f=a}};return h},J.path_selector=function(b,d,e,f){function g(a){return function(b){return!!a&&a.indexOf(b)>=0}}function h(a){var b=g(a);return function(a){return!b(a)}}function i(a,b){return a?b?b.every(g(a))?a.filter(h(b)):a.concat(b.filter(h(a))):a:b}function j(a){var b=n.selectAll("span.path-selector").data(a);b.enter().append("span").attr("class","path-selector").style({"border-width":"1px","border-style":"solid","border-color":"grey","border-radius":"4px",display:"inline-block",padding:"4px",cursor:"pointer",margin:"5px"}),b.exit().transition(1e3).attr("opacity",0).remove(),b.text(function(a,b){return"path "+(b+1)+" ("+d.elementList.eval(a).length+")"}).on("mouseover",function(a){m.hover_changed([a])}).on("mouseout",function(a){m.hover_changed(null)}).on("click",function(a){
m.select_changed(i(q,[a]))});var c=n.selectAll("span.no-paths").data(0===a.length?[0]:[]);c.exit().remove(),c.enter().append("span").attr("class","no-paths"),c.classed("error",!!r.error_text()).text(r.error_text()||(r.queried()?r.zero_text():r.default_text()))}function k(){var a=g(p);n.selectAll("span.path-selector").style({"border-color":function(b,c){return a(b)?"#e41a1c":"grey"},"border-width":function(b,c){return(a(b)?2:1)+"px"},padding:function(b,c){return(a(b)?3:4)+"px"}})}function l(){var a=g(q);n.selectAll("span.path-selector").style({"background-color":function(b,c){return a(b)?"#1c1ae6":"white"},color:function(b,c){return a(b)?"white":"black"}})}var m=J.register_highlight_paths_group(e||"highlight-paths-group"),n=a.select(b),o=[],p=null,q=null;m.on("paths_changed.selector",function(a,b,c){p=q=null,o=c,r.redraw()}).on("hover_changed.selector",function(a){p=a,k()}).on("select_changed.selector",function(a){q=a,l()});var r={default_text:K("Nothing here"),zero_text:K("No paths"),error_text:K(null),queried:K(!1),redraw:function(){j(o),k(),l()},render:function(){return this.redraw(),this}};return c.registerChart(r,f),r},J.node_name=function(a){if(a<26)return String.fromCharCode(97+a);if(a<52)return String.fromCharCode(65+a-26);if(a<2704)return J.node_name(Math.floor(a/52))+J.node_name(a%52);throw new Error("no, that's too large")},J.node_object=function(a,b){return b=b||{},_.extend({id:a,name:J.node_name(a)},b)},J.edge_object=function(a,b,c,d){return d=d||{},_.extend({source:b,target:c,sourcename:a(b),targetname:a(c)},d)},J.generate=function(a,b,c,d){var e,f,g,h,i=c.nodePrefix||"",j=function(a){return e[a].name},k=b[0],l=c.linkLength||30;switch(a){case"clique":case"cliquestf":for(e=new Array(k),f=[],g=0;g<k;++g)for(e[g]=J.node_object(g,{circle:"A",name:i+J.node_name(g)}),h=0;h<g;++h)f.push(J.edge_object(j,g,h,{notLayout:!0,undirected:!0}));if("cliquestf"===a)for(g=0;g<k;++g)e[g+k]=J.node_object(g+k),e[g+2*k]=J.node_object(g+2*k),f.push(J.edge_object(j,g,g+k,{undirected:!0})),f.push(J.edge_object(j,g,g+2*k,{undirected:!0}));break;case"wheel":for(e=new Array(k),g=0;g<k;++g)e[g]=J.node_object(g,{name:i+J.node_name(g)});f=J.wheel_edges(j,_.range(k),k*l/2);var m=f[0].distance;for(g=0;g<b[1];++g)for(h=0;h<k;++h)f.push(J.edge_object(j,h,(h+1)%k,{distance:m,par:g+2}));break;default:throw new Error("unknown generation type "+a)}var n={nodes:e,links:f};d(null,n)},J.wheel_edges=function(a,b,c){for(var d=b.length,e=[],f=Math.floor(d/2),g=2*c*Math.sin(Math.PI/d),h=2*c*Math.sin(f*Math.PI/d),i=0;i<d;++i)e.push(J.edge_object(a,b[i],b[(i+1)%d],{distance:g}));for(i=0;i<d/2;++i)e.push(J.edge_object(a,b[i],b[(i+f)%d],{distance:h})),d%2&&i!=Math.floor(d/2)&&e.push(J.edge_object(a,b[i],b[(i+d-f)%d],{distance:h}));return e},J.random_graph=function(a){function b(){var b={};return b[a.nodeKey]=a.nodeKeyGen(d.length),b[a.colorTag]=Math.floor(Math.random()*a.ncolors),d.push(b),b}function c(){return d[Math.floor(Math.random()*d.length)]}a=Object.assign({ncolors:5,nodeKey:"key",edgeKey:"key",sourceKey:"sourcename",targetKey:"targetname",colorTag:"color",nodeKeyGen:function(a){return"n"+a},edgeKeyGen:function(a){return"e"+a},newComponentProb:.1,newNodeProb:.9},a),isNaN(a.newNodeProb)&&(a.newNodeProb=.9),a.newNodProb<=0&&(a.newNodeProb=.1);var d=[],e=[];return{nodes:function(){return d},edges:function(){return e},generate:function(f){for(;f-- >0;){var g,h,i=Math.random();if(g=!d.length||i<a.newComponentProb?b():c(),h=i<a.newNodeProb?b():c(),g&&h){var j={};j[a.edgeKey]=a.edgeKeyGen(e.length),j[a.sourceKey]=g[a.nodeKey],j[a.targetKey]=h[a.nodeKey],e.push(j)}}}}},J.line_breaks=function(a,b){var c=new RegExp(a,"g");return function(a){var d,e,f=a.key,g="",h=[],i=0;do d=c.exec(f),e=d?f.slice(i,c.lastIndex):f.slice(i),g.length+e.length>b&&g.length>0&&(h.push(g),g=""),g+=e,i=c.lastIndex;while(null!==d);return h.push(g),h}},J.build_type_graph=function(a,b,c,d,e,f){var g={},h={},i={};return a.forEach(function(a){g[c(a)]=a;var b=d(a);h[b]||(h[b]={type:b})}),b.forEach(function(a){var b,c,h=e(a),j=f(a);if(!(b=g[h]))throw new Error("source key "+h+" not found!");if(!(c=g[j]))throw new Error("target key "+j+" not found!");var k=d(b)+"/"+d(c);i[k]||(i[k]={type:k,source:d(b),target:d(c)})}),{nodes:Object.keys(h).map(function(a){return h[a]}),edges:Object.keys(i).map(function(a){return i[a]})}},J.d3=a,J.crossfilter=b,J.dc=c,J}if("function"==typeof define&&define.amd)define(["d3","crossfilter","dc"],a);else if("object"==typeof module&&module.exports){var b=require("d3"),c=require("crossfilter");"function"!=typeof c&&(c=c.crossfilter);var d=require("dc");module.exports=a(b,c,d)}else this.dc_graph=a(d3,crossfilter,dc)}();
//# sourceMappingURL=dc.graph.min.js.map